import{j as e,C as t,u as s,P as a,a as r,c as n}from"./three-vendor-DQOlwqN0.js";import{r as i,g as o,R as l,L as d,u as c,c as m,N as u,O as h,d as x,e as p,B as g,f,h as b,i as v}from"./react-vendor-seTEwhFu.js";import{c as w}from"./supabase-BmCbJEjA.js";import{D as j,S as y,C as N,U as k,G as _,B as C,a as S,b as z,A as U,T as P,d as A,X as D,e as L,L as M,f as E,g as T,R as I,H as O,h as R,i as F,E as $,j as q,k as B,Z as H,M as W,l as K,m as Y,n as G,o as V,p as Q,q as J,r as X,s as Z,t as ee,u as te,v as se,P as ae,I as re,V as ne,w as ie,x as oe,y as le,z as de,F as ce,J as me,K as ue,N as he,O as xe,Q as pe,W as ge,Y as fe,_ as be,$ as ve,a0 as we,a1 as je,a2 as ye,a3 as Ne,a4 as ke,a5 as _e,a6 as Ce,a7 as Se,a8 as ze,a9 as Ue,aa as Pe,ab as Ae,ac as De,ad as Le,ae as Me,af as Ee,ag as Te,ah as Ie,ai as Oe,aj as Re,ak as Fe,al as $e,am as qe,an as Be,ao as He,ap as We,aq as Ke,ar as Ye,as as Ge,at as Ve,au as Qe,av as Je,aw as Xe,ax as Ze,ay as et,az as tt,aA as st,aB as at,aC as rt,aD as nt,aE as it,aF as ot,aG as lt,aH as dt,aI as ct,aJ as mt,aK as ut,aL as ht,aM as xt,aN as pt,aO as gt}from"./ui-vendor-CvoKCbOo.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var ft=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},bt={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},vt=new class{#e=bt;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}};var wt="undefined"==typeof window||"Deno"in globalThis;function jt(){}function yt(e,t){return"function"==typeof e?e(t):e}function Nt(e,t){const{type:s="all",exact:a,fetchStatus:r,predicate:n,queryKey:i,stale:o}=e;if(i)if(a){if(t.queryHash!==_t(i,t.options))return!1}else if(!St(t.queryKey,i))return!1;if("all"!==s){const e=t.isActive();if("active"===s&&!e)return!1;if("inactive"===s&&e)return!1}return("boolean"!=typeof o||t.isStale()===o)&&((!r||r===t.state.fetchStatus)&&!(n&&!n(t)))}function kt(e,t){const{exact:s,status:a,predicate:r,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(s){if(Ct(t.options.mutationKey)!==Ct(n))return!1}else if(!St(t.options.mutationKey,n))return!1}return(!a||t.state.status===a)&&!(r&&!r(t))}function _t(e,t){return(t?.queryKeyHashFn||Ct)(e)}function Ct(e){return JSON.stringify(e,(e,t)=>At(t)?Object.keys(t).sort().reduce((e,s)=>(e[s]=t[s],e),{}):t)}function St(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&Object.keys(t).every(s=>St(e[s],t[s])))}var zt=Object.prototype.hasOwnProperty;function Ut(e,t){if(e===t)return e;const s=Pt(e)&&Pt(t);if(!(s||At(e)&&At(t)))return t;const a=(s?e:Object.keys(e)).length,r=s?t:Object.keys(t),n=r.length,i=s?new Array(n):{};let o=0;for(let l=0;l<n;l++){const n=s?l:r[l],d=e[n],c=t[n];if(d===c){i[n]=d,(s?l<a:zt.call(e,n))&&o++;continue}if(null===d||null===c||"object"!=typeof d||"object"!=typeof c){i[n]=c;continue}const m=Ut(d,c);i[n]=m,m===d&&o++}return a===n&&o===a?e:i}function Pt(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function At(e){if(!Dt(e))return!1;const t=e.constructor;if(void 0===t)return!0;const s=t.prototype;return!!Dt(s)&&(!!s.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype)}function Dt(e){return"[object Object]"===Object.prototype.toString.call(e)}function Lt(e,t,s){return"function"==typeof s.structuralSharing?s.structuralSharing(e,t):!1!==s.structuralSharing?Ut(e,t):t}function Mt(e,t,s=0){const a=[...e,t];return s&&a.length>s?a.slice(1):a}function Et(e,t,s=0){const a=[t,...e];return s&&a.length>s?a.slice(0,-1):a}var Tt=Symbol();function It(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==Tt?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`))}var Ot=new class extends ft{#s;#a;#r;constructor(){super(),this.#r=e=>{if(!wt&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#a||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#a?.(),this.#a=void 0)}setEventListener(e){this.#r=e,this.#a?.(),this.#a=e(e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()})}setFocused(e){this.#s!==e&&(this.#s=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return"boolean"==typeof this.#s?this.#s:"hidden"!==globalThis.document?.visibilityState}};var Rt=function(e){setTimeout(e,0)};var Ft=function(){let e=[],t=0,s=e=>{e()},a=e=>{e()},r=Rt;const n=a=>{t?e.push(a):r(()=>{s(a)})};return{batch:n=>{let i;t++;try{i=n()}finally{t--,t||(()=>{const t=e;e=[],t.length&&r(()=>{a(()=>{t.forEach(e=>{s(e)})})})})()}return i},batchCalls:e=>(...t)=>{n(()=>{e(...t)})},schedule:n,setNotifyFunction:e=>{s=e},setBatchNotifyFunction:e=>{a=e},setScheduler:e=>{r=e}}}(),$t=new class extends ft{#n=!0;#a;#r;constructor(){super(),this.#r=e=>{if(!wt&&window.addEventListener){const t=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",s)}}}}onSubscribe(){this.#a||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#a?.(),this.#a=void 0)}setEventListener(e){this.#r=e,this.#a?.(),this.#a=e(this.setOnline.bind(this))}setOnline(e){this.#n!==e&&(this.#n=e,this.listeners.forEach(t=>{t(e)}))}isOnline(){return this.#n}};function qt(e){return Math.min(1e3*2**e,3e4)}function Bt(e){return"online"!==(e??"online")||$t.isOnline()}var Ht=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Wt(e){let t,s=!1,a=0;const r=function(){let e,t;const s=new Promise((s,a)=>{e=s,t=a});function a(e){Object.assign(s,e),delete s.resolve,delete s.reject}return s.status="pending",s.catch(()=>{}),s.resolve=t=>{a({status:"fulfilled",value:t}),e(t)},s.reject=e=>{a({status:"rejected",reason:e}),t(e)},s}(),n=()=>"pending"!==r.status,i=()=>Ot.isFocused()&&("always"===e.networkMode||$t.isOnline())&&e.canRun(),o=()=>Bt(e.networkMode)&&e.canRun(),l=e=>{n()||(t?.(),r.resolve(e))},d=e=>{n()||(t?.(),r.reject(e))},c=()=>new Promise(s=>{t=e=>{(n()||i())&&s(e)},e.onPause?.()}).then(()=>{t=void 0,n()||e.onContinue?.()}),m=()=>{if(n())return;let t;const r=0===a?e.initialPromise:void 0;try{t=r??e.fn()}catch(o){t=Promise.reject(o)}Promise.resolve(t).then(l).catch(t=>{if(n())return;const r=e.retry??(wt?0:3),o=e.retryDelay??qt,l="function"==typeof o?o(a,t):o,u=!0===r||"number"==typeof r&&a<r||"function"==typeof r&&r(a,t);var h;!s&&u?(a++,e.onFail?.(a,t),(h=l,new Promise(e=>{vt.setTimeout(e,h)})).then(()=>i()?void 0:c()).then(()=>{s?d(t):m()})):d(t)})};return{promise:r,status:()=>r.status,cancel:t=>{if(!n()){const s=new Ht(t);d(s),e.onCancel?.(s)}},continue:()=>(t?.(),r),cancelRetry:()=>{s=!0},continueRetry:()=>{s=!1},canStart:o,start:()=>(o()?m():c().then(m),r)}}var Kt=class{#i;destroy(){this.clearGcTimeout()}scheduleGc(){var e;this.clearGcTimeout(),"number"==typeof(e=this.gcTime)&&e>=0&&e!==1/0&&(this.#i=vt.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(wt?1/0:3e5))}clearGcTimeout(){this.#i&&(vt.clearTimeout(this.#i),this.#i=void 0)}},Yt=class extends Kt{#o;#l;#d;#c;#m;#u;#h;constructor(e){super(),this.#h=!1,this.#u=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#c=e.client,this.#d=this.#c.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#o=Vt(this.options),this.state=e.state??this.#o,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#m?.promise}setOptions(e){if(this.options={...this.#u,...e},this.updateGcTime(this.options.gcTime),this.state&&void 0===this.state.data){const e=Vt(this.options);void 0!==e.data&&(this.setState(Gt(e.data,e.dataUpdatedAt)),this.#o=e)}}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#d.remove(this)}setData(e,t){const s=Lt(this.state.data,e,this.options);return this.#x({data:s,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),s}setState(e,t){this.#x({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#m?.promise;return this.#m?.cancel(e),t?t.then(jt).catch(jt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#o)}isActive(){return this.observers.some(e=>{return!1!==(t=e.options.enabled,s=this,"function"==typeof t?t(s):t);var t,s})}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Tt||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0&&this.observers.some(e=>"static"===yt(e.options.staleTime,this))}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):void 0===this.state.data||this.state.isInvalidated}isStaleByTime(e=0){return void 0===this.state.data||"static"!==e&&(!!this.state.isInvalidated||!function(e,t){return Math.max(e+(t||0)-Date.now(),0)}(this.state.dataUpdatedAt,e))}onFocus(){const e=this.observers.find(e=>e.shouldFetchOnWindowFocus());e?.refetch({cancelRefetch:!1}),this.#m?.continue()}onOnline(){const e=this.observers.find(e=>e.shouldFetchOnReconnect());e?.refetch({cancelRefetch:!1}),this.#m?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#d.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#m&&(this.#h?this.#m.cancel({revert:!0}):this.#m.cancelRetry()),this.scheduleGc()),this.#d.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#x({type:"invalidate"})}async fetch(e,t){if("idle"!==this.state.fetchStatus&&"rejected"!==this.#m?.status())if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#m)return this.#m.continueRetry(),this.#m.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find(e=>e.options.queryFn);e&&this.setOptions(e.options)}const s=new AbortController,a=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#h=!0,s.signal)})},r=()=>{const e=It(this.options,t),s=(()=>{const e={client:this.#c,queryKey:this.queryKey,meta:this.meta};return a(e),e})();return this.#h=!1,this.options.persister?this.options.persister(e,s,this):e(s)},n=(()=>{const e={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#c,state:this.state,fetchFn:r};return a(e),e})();this.options.behavior?.onFetch(n,this),this.#l=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===n.fetchOptions?.meta||this.#x({type:"fetch",meta:n.fetchOptions?.meta}),this.#m=Wt({initialPromise:t?.initialPromise,fn:n.fetchFn,onCancel:e=>{e instanceof Ht&&e.revert&&this.setState({...this.#l,fetchStatus:"idle"}),s.abort()},onFail:(e,t)=>{this.#x({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#x({type:"pause"})},onContinue:()=>{this.#x({type:"continue"})},retry:n.options.retry,retryDelay:n.options.retryDelay,networkMode:n.options.networkMode,canRun:()=>!0});try{const e=await this.#m.start();if(void 0===e)throw new Error(`${this.queryHash} data is undefined`);return this.setData(e),this.#d.config.onSuccess?.(e,this),this.#d.config.onSettled?.(e,this.state.error,this),e}catch(i){if(i instanceof Ht){if(i.silent)return this.#m.promise;if(i.revert){if(void 0===this.state.data)throw i;return this.state.data}}throw this.#x({type:"error",error:i}),this.#d.config.onError?.(i,this),this.#d.config.onSettled?.(this.state.data,i,this),i}finally{this.scheduleGc()}}#x(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...(s=t.data,a=this.options,{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Bt(a.networkMode)?"fetching":"paused",...void 0===s&&{error:null,status:"pending"}}),fetchMeta:e.meta??null};case"success":const r={...t,...Gt(e.data,e.dataUpdatedAt),dataUpdateCount:t.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#l=e.manual?r:void 0,r;case"error":const n=e.error;return{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}var s,a})(this.state),Ft.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#d.notify({query:this,type:"updated",action:e})})}};function Gt(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Vt(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,s=void 0!==t,a=s?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function Qt(e){return{onFetch:(t,s)=>{const a=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,n=t.state.data?.pages||[],i=t.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const d=async()=>{let s=!1;const d=e=>{!function(e,t,s){let a,r=!1;Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(a??=t(),r||(r=!0,a.aborted?s():a.addEventListener("abort",s,{once:!0})),a)})}(e,()=>t.signal,()=>s=!0)},c=It(t.options,t.fetchOptions),m=async(e,a,r)=>{if(s)return Promise.reject();if(null==a&&e.pages.length)return Promise.resolve(e);const n=(()=>{const e={client:t.client,queryKey:t.queryKey,pageParam:a,direction:r?"backward":"forward",meta:t.options.meta};return d(e),e})(),i=await c(n),{maxPages:o}=t.options,l=r?Et:Mt;return{pages:l(e.pages,i,o),pageParams:l(e.pageParams,a,o)}};if(r&&n.length){const e="backward"===r,t={pages:n,pageParams:i},s=(e?Xt:Jt)(a,t);o=await m(t,s,e)}else{const t=e??n.length;do{const e=0===l?i[0]??a.initialPageParam:Jt(a,o);if(l>0&&null==e)break;o=await m(o,e),l++}while(l<t)}return o};t.options.persister?t.fetchFn=()=>t.options.persister?.(d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=d}}}function Jt(e,{pages:t,pageParams:s}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,s[a],s):void 0}function Xt(e,{pages:t,pageParams:s}){return t.length>0?e.getPreviousPageParam?.(t[0],t,s[0],s):void 0}var Zt=class extends Kt{#c;#p;#g;#m;constructor(e){super(),this.#c=e.client,this.mutationId=e.mutationId,this.#g=e.mutationCache,this.#p=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#p.includes(e)||(this.#p.push(e),this.clearGcTimeout(),this.#g.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#p=this.#p.filter(t=>t!==e),this.scheduleGc(),this.#g.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#p.length||("pending"===this.state.status?this.scheduleGc():this.#g.remove(this))}continue(){return this.#m?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#x({type:"continue"})},s={client:this.#c,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#m=Wt({fn:()=>this.options.mutationFn?this.options.mutationFn(e,s):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#x({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#x({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#g.canRun(this)});const a="pending"===this.state.status,r=!this.#m.canStart();try{if(a)t();else{this.#x({type:"pending",variables:e,isPaused:r}),await(this.#g.config.onMutate?.(e,this,s));const t=await(this.options.onMutate?.(e,s));t!==this.state.context&&this.#x({type:"pending",context:t,variables:e,isPaused:r})}const n=await this.#m.start();return await(this.#g.config.onSuccess?.(n,e,this.state.context,this,s)),await(this.options.onSuccess?.(n,e,this.state.context,s)),await(this.#g.config.onSettled?.(n,null,this.state.variables,this.state.context,this,s)),await(this.options.onSettled?.(n,null,e,this.state.context,s)),this.#x({type:"success",data:n}),n}catch(n){try{await(this.#g.config.onError?.(n,e,this.state.context,this,s))}catch(i){Promise.reject(i)}try{await(this.options.onError?.(n,e,this.state.context,s))}catch(i){Promise.reject(i)}try{await(this.#g.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this,s))}catch(i){Promise.reject(i)}try{await(this.options.onSettled?.(void 0,n,e,this.state.context,s))}catch(i){Promise.reject(i)}throw this.#x({type:"error",error:n}),n}finally{this.#g.runNext(this)}}#x(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),Ft.batch(()=>{this.#p.forEach(t=>{t.onMutationUpdate(e)}),this.#g.notify({mutation:this,type:"updated",action:e})})}};var es=class extends ft{constructor(e={}){super(),this.config=e,this.#f=new Set,this.#b=new Map,this.#v=0}#f;#b;#v;build(e,t,s){const a=new Zt({client:e,mutationCache:this,mutationId:++this.#v,options:e.defaultMutationOptions(t),state:s});return this.add(a),a}add(e){this.#f.add(e);const t=ts(e);if("string"==typeof t){const s=this.#b.get(t);s?s.push(e):this.#b.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#f.delete(e)){const t=ts(e);if("string"==typeof t){const s=this.#b.get(t);if(s)if(s.length>1){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}else s[0]===e&&this.#b.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=ts(e);if("string"==typeof t){const s=this.#b.get(t),a=s?.find(e=>"pending"===e.state.status);return!a||a===e}return!0}runNext(e){const t=ts(e);if("string"==typeof t){const s=this.#b.get(t)?.find(t=>t!==e&&t.state.isPaused);return s?.continue()??Promise.resolve()}return Promise.resolve()}clear(){Ft.batch(()=>{this.#f.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#f.clear(),this.#b.clear()})}getAll(){return Array.from(this.#f)}find(e){const t={exact:!0,...e};return this.getAll().find(e=>kt(t,e))}findAll(e={}){return this.getAll().filter(t=>kt(e,t))}notify(e){Ft.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(e=>e.state.isPaused);return Ft.batch(()=>Promise.all(e.map(e=>e.continue().catch(jt))))}};function ts(e){return e.options.scope?.id}var ss=class extends ft{constructor(e={}){super(),this.config=e,this.#w=new Map}#w;build(e,t,s){const a=t.queryKey,r=t.queryHash??_t(a,t);let n=this.get(r);return n||(n=new Yt({client:e,queryKey:a,queryHash:r,options:e.defaultQueryOptions(t),state:s,defaultOptions:e.getQueryDefaults(a)}),this.add(n)),n}add(e){this.#w.has(e.queryHash)||(this.#w.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#w.get(e.queryHash);t&&(e.destroy(),t===e&&this.#w.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ft.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#w.get(e)}getAll(){return[...this.#w.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(e=>Nt(t,e))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(t=>Nt(e,t)):t}notify(e){Ft.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Ft.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ft.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},as=i.createContext(void 0),rs=({client:t,children:s})=>(i.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(as.Provider,{value:t,children:s}));const ns=w("https://rwtdjpwsxtwfeecseugg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ3dGRqcHdzeHR3ZmVlY3NldWdnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgxMzg2MjUsImV4cCI6MjA4MzcxNDYyNX0.s9fNTqVzjydNQIvSQvM6zHldnL5TU-zKg4KARE0F_b8",{auth:{flowType:"pkce",detectSessionInUrl:!0,storage:window.localStorage,autoRefreshToken:!0,persistSession:!0}}),is="/assets/students-collaboration-tUrmN5Tk.png",os="/assets/student-professional-C4p-HehX.png",ls="/assets/campus-networking-D_sOqIPL.png";var ds,cs;const ms=o(function(){if(cs)return ds;cs=1;var e="undefined"!=typeof Element,t="function"==typeof Map,s="function"==typeof Set,a="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function r(n,i){if(n===i)return!0;if(n&&i&&"object"==typeof n&&"object"==typeof i){if(n.constructor!==i.constructor)return!1;var o,l,d,c;if(Array.isArray(n)){if((o=n.length)!=i.length)return!1;for(l=o;0!==l--;)if(!r(n[l],i[l]))return!1;return!0}if(t&&n instanceof Map&&i instanceof Map){if(n.size!==i.size)return!1;for(c=n.entries();!(l=c.next()).done;)if(!i.has(l.value[0]))return!1;for(c=n.entries();!(l=c.next()).done;)if(!r(l.value[1],i.get(l.value[0])))return!1;return!0}if(s&&n instanceof Set&&i instanceof Set){if(n.size!==i.size)return!1;for(c=n.entries();!(l=c.next()).done;)if(!i.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(n)&&ArrayBuffer.isView(i)){if((o=n.length)!=i.length)return!1;for(l=o;0!==l--;)if(n[l]!==i[l])return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf&&"function"==typeof n.valueOf&&"function"==typeof i.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString&&"function"==typeof n.toString&&"function"==typeof i.toString)return n.toString()===i.toString();if((o=(d=Object.keys(n)).length)!==Object.keys(i).length)return!1;for(l=o;0!==l--;)if(!Object.prototype.hasOwnProperty.call(i,d[l]))return!1;if(e&&n instanceof Element)return!1;for(l=o;0!==l--;)if(("_owner"!==d[l]&&"__v"!==d[l]&&"__o"!==d[l]||!n.$$typeof)&&!r(n[d[l]],i[d[l]]))return!1;return!0}return n!=n&&i!=i}return ds=function(e,t){try{return r(e,t)}catch(s){if((s.message||"").match(/stack|recursion/i))return!1;throw s}}}());var us,hs;const xs=o(hs?us:(hs=1,us=function(e,t,s,a,r,n,i,o){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[s,a,r,n,i,o],c=0;(l=new Error(t.replace(/%s/g,function(){return d[c++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}));var ps,gs;const fs=o(gs?ps:(gs=1,ps=function(e,t,s,a){var r=s?s.call(a,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=Object.prototype.hasOwnProperty.bind(t),l=0;l<n.length;l++){var d=n[l];if(!o(d))return!1;var c=e[d],m=t[d];if(!1===(r=s?s.call(a,c,m,d):void 0)||void 0===r&&c!==m)return!1}return!0}));var bs=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(bs||{}),vs={rel:["amphtml","canonical","alternate"]},ws={type:["application/ld+json"]},js={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},ys=Object.values(bs),Ns={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ks=Object.entries(Ns).reduce((e,[t,s])=>(e[s]=t,e),{}),_s="data-rh",Cs="defaultTitle",Ss="defer",zs="encodeSpecialCharacters",Us="onChangeClientState",Ps="titleTemplate",As="prioritizeSeoTags",Ds=(e,t)=>{for(let s=e.length-1;s>=0;s-=1){const a=e[s];if(Object.prototype.hasOwnProperty.call(a,t))return a[t]}return null},Ls=e=>{let t=Ds(e,"title");const s=Ds(e,Ps);if(Array.isArray(t)&&(t=t.join("")),s&&t)return s.replace(/%s/g,()=>t);const a=Ds(e,Cs);return t||a||void 0},Ms=e=>Ds(e,Us)||(()=>{}),Es=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>({...e,...t}),{}),Ts=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,s)=>{if(!t.length){const a=Object.keys(s);for(let r=0;r<a.length;r+=1){const n=a[r].toLowerCase();if(-1!==e.indexOf(n)&&s[n])return t.concat(s)}}return t},[]),Is=(e,t,s)=>{const a={};return s.filter(t=>!!Array.isArray(t[e])||(void 0!==t[e]&&(t[e],console&&console.warn),!1)).map(t=>t[e]).reverse().reduce((e,s)=>{const r={};s.filter(e=>{let s;const n=Object.keys(e);for(let a=0;a<n.length;a+=1){const r=n[a],i=r.toLowerCase();-1===t.indexOf(i)||"rel"===s&&"canonical"===e[s].toLowerCase()||"rel"===i&&"stylesheet"===e[i].toLowerCase()||(s=i),-1===t.indexOf(r)||"innerHTML"!==r&&"cssText"!==r&&"itemprop"!==r||(s=r)}if(!s||!e[s])return!1;const i=e[s].toLowerCase();return a[s]||(a[s]={}),r[s]||(r[s]={}),!a[s][i]&&(r[s][i]=!0,!0)}).reverse().forEach(t=>e.push(t));const n=Object.keys(r);for(let t=0;t<n.length;t+=1){const e=n[t],s={...a[e],...r[e]};a[e]=s}return e},[]).reverse()},Os=(e,t)=>{if(Array.isArray(e)&&e.length)for(let s=0;s<e.length;s+=1){if(e[s][t])return!0}return!1},Rs=e=>Array.isArray(e)?e.join(""):e,Fs=(e,t)=>Array.isArray(e)?e.reduce((e,s)=>(((e,t)=>{const s=Object.keys(e);for(let a=0;a<s.length;a+=1)if(t[s[a]]&&t[s[a]].includes(e[s[a]]))return!0;return!1})(s,t)?e.priority.push(s):e.default.push(s),e),{priority:[],default:[]}):{default:e,priority:[]},$s=(e,t)=>({...e,[t]:void 0}),qs=["noscript","script","style"],Bs=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),Hs=e=>Object.keys(e).reduce((t,s)=>{const a=void 0!==e[s]?`${s}="${e[s]}"`:`${s}`;return t?`${t} ${a}`:a},""),Ws=(e,t={})=>Object.keys(e).reduce((t,s)=>(t[Ns[s]||s]=e[s],t),t),Ks=(e,t)=>t.map((t,s)=>{const a={key:s,[_s]:!0};return Object.keys(t).forEach(e=>{const s=Ns[e]||e;if("innerHTML"===s||"cssText"===s){const e=t.innerHTML||t.cssText;a.dangerouslySetInnerHTML={__html:e}}else a[s]=t[e]}),l.createElement(e,a)}),Ys=(e,t,s=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,s)=>{const a=Ws(s,{key:t,[_s]:!0});return[l.createElement("title",a,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,s,a)=>{const r=Hs(s),n=Rs(t);return r?`<${e} ${_s}="true" ${r}>${Bs(n,a)}</${e}>`:`<${e} ${_s}="true">${Bs(n,a)}</${e}>`})(e,t.title,t.titleAttributes,s)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>Ws(t),toString:()=>Hs(t)};default:return{toComponent:()=>Ks(e,t),toString:()=>((e,t,s=!0)=>t.reduce((t,a)=>{const r=a,n=Object.keys(r).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const a=void 0===r[t]?t:`${t}="${Bs(r[t],s)}"`;return e?`${e} ${a}`:a},""),i=r.innerHTML||r.cssText||"",o=-1===qs.indexOf(e);return`${t}<${e} ${_s}="true" ${n}${o?"/>":`>${i}</${e}>`}`},""))(e,t,s)}}},Gs=e=>{const{baseTag:t,bodyAttributes:s,encode:a=!0,htmlAttributes:r,noscriptTags:n,styleTags:i,title:o="",titleAttributes:l,prioritizeSeoTags:d}=e;let{linkTags:c,metaTags:m,scriptTags:u}=e,h={toComponent:()=>{},toString:()=>""};return d&&({priorityMethods:h,linkTags:c,metaTags:m,scriptTags:u}=(({metaTags:e,linkTags:t,scriptTags:s,encode:a})=>{const r=Fs(e,js),n=Fs(t,vs),i=Fs(s,ws);return{priorityMethods:{toComponent:()=>[...Ks("meta",r.priority),...Ks("link",n.priority),...Ks("script",i.priority)],toString:()=>`${Ys("meta",r.priority,a)} ${Ys("link",n.priority,a)} ${Ys("script",i.priority,a)}`},metaTags:r.default,linkTags:n.default,scriptTags:i.default}})(e)),{priority:h,base:Ys("base",t,a),bodyAttributes:Ys("bodyAttributes",s,a),htmlAttributes:Ys("htmlAttributes",r,a),link:Ys("link",c,a),meta:Ys("meta",m,a),noscript:Ys("noscript",n,a),script:Ys("script",u,a),style:Ys("style",i,a),title:Ys("title",{title:o,titleAttributes:l},a)}},Vs=[],Qs=!("undefined"==typeof window||!window.document||!window.document.createElement),Js=class{instances=[];canUseDOM=Qs;context;value={setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?Vs:this.instances,add:e=>{(this.canUseDOM?Vs:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?Vs:this.instances).indexOf(e);(this.canUseDOM?Vs:this.instances).splice(t,1)}}};constructor(e,t){this.context=e,this.canUseDOM=t||!1,t||(e.helmet=Gs({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Xs=l.createContext({}),Zs=class e extends i.Component{static canUseDOM=Qs;helmetData;constructor(t){super(t),this.helmetData=new Js(this.props.context||{},e.canUseDOM)}render(){return l.createElement(Xs.Provider,{value:this.helmetData.value},this.props.children)}},ea=(e,t)=>{const s=document.head||document.querySelector("head"),a=s.querySelectorAll(`${e}[${_s}]`),r=[].slice.call(a),n=[];let i;return t&&t.length&&t.forEach(t=>{const s=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)s.innerHTML=t.innerHTML;else if("cssText"===e)s.styleSheet?s.styleSheet.cssText=t.cssText:s.appendChild(document.createTextNode(t.cssText));else{const a=e,r=void 0===t[a]?"":t[a];s.setAttribute(e,r)}s.setAttribute(_s,"true"),r.some((e,t)=>(i=t,s.isEqualNode(e)))?r.splice(i,1):n.push(s)}),r.forEach(e=>e.parentNode?.removeChild(e)),n.forEach(e=>s.appendChild(e)),{oldTags:r,newTags:n}},ta=(e,t)=>{const s=document.getElementsByTagName(e)[0];if(!s)return;const a=s.getAttribute(_s),r=a?a.split(","):[],n=[...r],i=Object.keys(t);for(const o of i){const e=t[o]||"";s.getAttribute(o)!==e&&s.setAttribute(o,e),-1===r.indexOf(o)&&r.push(o);const a=n.indexOf(o);-1!==a&&n.splice(a,1)}for(let o=n.length-1;o>=0;o-=1)s.removeAttribute(n[o]);r.length===n.length?s.removeAttribute(_s):s.getAttribute(_s)!==i.join(",")&&s.setAttribute(_s,i.join(","))},sa=(e,t)=>{const{baseTag:s,bodyAttributes:a,htmlAttributes:r,linkTags:n,metaTags:i,noscriptTags:o,onChangeClientState:l,scriptTags:d,styleTags:c,title:m,titleAttributes:u}=e;ta("body",a),ta("html",r),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=Rs(e)),ta("title",t)})(m,u);const h={baseTag:ea("base",s),linkTags:ea("link",n),metaTags:ea("meta",i),noscriptTags:ea("noscript",o),scriptTags:ea("script",d),styleTags:ea("style",c)},x={},p={};Object.keys(h).forEach(e=>{const{newTags:t,oldTags:s}=h[e];t.length&&(x[e]=t),s.length&&(p[e]=h[e].oldTags)}),t&&t(),l(e,x,p)},aa=null,ra=e=>{aa&&cancelAnimationFrame(aa),e.defer?aa=requestAnimationFrame(()=>{sa(e,()=>{aa=null})}):(sa(e),aa=null)},na=class extends i.Component{rendered=!1;shouldComponentUpdate(e){return!fs(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let s=null;const a=(r=e.get().map(e=>{const t={...e.props};return delete t.context,t}),{baseTag:Ts(["href"],r),bodyAttributes:Es("bodyAttributes",r),defer:Ds(r,Ss),encode:Ds(r,zs),htmlAttributes:Es("htmlAttributes",r),linkTags:Is("link",["rel","href"],r),metaTags:Is("meta",["name","charset","http-equiv","property","itemprop"],r),noscriptTags:Is("noscript",["innerHTML"],r),onChangeClientState:Ms(r),scriptTags:Is("script",["src","innerHTML"],r),styleTags:Is("style",["cssText"],r),title:Ls(r),titleAttributes:Es("titleAttributes",r),prioritizeSeoTags:Os(r,As)});var r;Zs.canUseDOM?ra(a):Gs&&(s=Gs(a)),t(s)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},ia=class extends i.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(e){return!ms($s(this.props,"helmetData"),$s(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,s,a){return{...t,[e.type]:[...t[e.type]||[],{...s,...this.mapNestedChildrenToProps(e,a)}]}}mapObjectTypeChildren(e,t,s,a){switch(e.type){case"title":return{...t,[e.type]:a,titleAttributes:{...s}};case"body":return{...t,bodyAttributes:{...s}};case"html":return{...t,htmlAttributes:{...s}};default:return{...t,[e.type]:{...s}}}}mapArrayTypeChildrenToProps(e,t){let s={...t};return Object.keys(e).forEach(t=>{s={...s,[t]:e[t]}}),s}warnOnInvalidChildren(e,t){return xs(ys.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${ys.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),xs(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let s={};return l.Children.forEach(e,e=>{if(!e||!e.props)return;const{children:a,...r}=e.props,n=Object.keys(r).reduce((e,t)=>(e[ks[t]||t]=r[t],e),{});let{type:i}=e;switch("symbol"==typeof i?i=i.toString():this.warnOnInvalidChildren(e,a),i){case"Symbol(react.fragment)":t=this.mapChildrenToProps(a,t);break;case"link":case"meta":case"noscript":case"script":case"style":s=this.flattenArrayTypeChildren(e,s,n,a);break;default:t=this.mapObjectTypeChildren(e,t,n,a)}}),this.mapArrayTypeChildrenToProps(s,t)}render(){const{children:e,...t}=this.props;let s={...t},{helmetData:a}=t;if(e&&(s=this.mapChildrenToProps(e,s)),a&&!(a instanceof Js)){a=new Js(a.context,!0),delete s.helmetData}return a?l.createElement(na,{...s,context:a.value}):l.createElement(Xs.Consumer,null,e=>l.createElement(na,{...s,context:e}))}};const oa=({title:t,description:s,keywords:a=["University Nigeria","Student Resources Nigeria","Study Groups","Exam Past Questions","UniLink","Nigerian Universities Collaboration","student group","university of lagos","university of ibadan","university of abuja","university of port harcourt","university of calabar","university of benin","university of jos","university of maiduguri","university of sokoto","university of yola","university of zaria","university of ilorin","university of lagos","university of ibadan","university of abuja","university of port harcourt","university of calabar","university of benin","university of jos","university of maiduguri","university of sokoto","university of yola","university of zaria","university of ilorin"],ogImage:r="https://unilink.ng/og-image.jpg",ogType:n="website",canonicalUrl:i=("undefined"!=typeof window?window.location.href:"")})=>{const o=`${t} | UniLink`;return e.jsxs(ia,{children:[e.jsx("title",{children:o}),e.jsx("meta",{name:"description",content:s}),e.jsx("meta",{name:"keywords",content:a.join(", ")}),e.jsx("link",{rel:"canonical",href:i}),e.jsx("meta",{property:"og:type",content:n}),e.jsx("meta",{property:"og:title",content:o}),e.jsx("meta",{property:"og:description",content:s}),e.jsx("meta",{property:"og:image",content:r}),e.jsx("meta",{property:"og:url",content:i}),e.jsx("meta",{property:"og:site_name",content:"UniLink Nigeria"}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:o}),e.jsx("meta",{name:"twitter:description",content:s}),e.jsx("meta",{name:"twitter:image",content:r}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=5"}),e.jsx("meta",{name:"theme-color",content:"#10b981"})," ",e.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"SoftwareApplication",name:"UniLink Nigeria",applicationCategory:"EducationalApplication",operatingSystem:"Web, Android, iOS",description:"Connecting Nigerian university students for collaboration, resources, and growth.",offers:{"@type":"Offer",price:"0",priceCurrency:"NGN"},aggregateRating:{"@type":"AggregateRating",ratingValue:"4.8",ratingCount:"1250"}})})]})};function la(){const[t,s]=i.useState(!1),[a,r]=i.useState(!1);i.useEffect(()=>{const e=()=>r(window.scrollY>20);return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);return e.jsxs(e.Fragment,{children:[e.jsx(oa,{title:"Connect & Learn with Nigerian Students",description:"UniLink Nigeria is the #1 platform for university students to share resources, join study groups, and find career opportunities.",keywords:["Nigerian Universities","Study Groups","Past Questions","Student Jobs","UniLink","Campus Network","Internships Nigeria"]}),e.jsxs("div",{className:"min-h-screen bg-white text-slate-900 font-sans selection:bg-emerald-100 selection:text-emerald-900 overflow-x-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0 pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white/60 via-white/80 to-white z-10"}),e.jsx("img",{src:"/assets/campus-hero-BRESTx_c.png",alt:"Campus",className:"w-full h-full object-cover opacity-30"})]}),e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-500 border-b border-transparent "+(a?"bg-white/80 backdrop-blur-xl border-slate-200/50 py-3 shadow-sm":"bg-transparent py-6"),children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 md:px-8 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-emerald-600 to-teal-600 rounded-lg blur opacity-25 group-hover:opacity-50 transition duration-200"}),e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"relative w-10 h-10 rounded-lg shadow-sm"})]}),e.jsx("span",{className:"font-display font-bold text-2xl tracking-tight text-slate-900",children:"UniLink"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(d,{to:"/about",className:"hidden md:block text-sm font-medium text-slate-600 hover:text-emerald-700 transition-colors",children:"About Us"}),e.jsxs("a",{href:"#download",className:"hidden md:flex items-center gap-1.5 text-sm font-semibold px-4 py-2 rounded-full bg-emerald-600 text-white hover:bg-emerald-500 transition-colors",children:[e.jsx(j,{className:"w-3.5 h-3.5"}),"Download App"]})]})]})}),e.jsx("main",{className:"relative z-10 pt-32 pb-16 lg:pt-48 lg:pb-32 overflow-hidden",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 md:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-16 items-center",children:[e.jsxs("div",{className:"lg:col-span-6 relative z-10 text-center lg:text-left",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white border border-slate-200 shadow-sm text-slate-600 text-sm font-semibold mb-8 animate-in fade-in slide-in-from-bottom-4 duration-700 hover:scale-105 transition-transform cursor-default",children:[e.jsx(y,{className:"w-4 h-4 text-emerald-500"}),e.jsx("span",{children:"The #1 Network for Nigerian Students"})]}),e.jsxs("h1",{className:"text-5xl md:text-7xl font-display font-bold tracking-tight mb-8 leading-[1.1] animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-100 text-slate-900",children:["Your Campus. ",e.jsx("br",{}),"Your ",e.jsx("span",{className:"text-emerald-600",children:"Future."})]}),e.jsx("p",{className:"text-xl text-slate-600 mb-10 leading-relaxed max-w-xl mx-auto lg:mx-0 animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-200",children:"Join the professional community built for Nigerian universities. Connect with peers, find internships, and launch your career—all in one place."}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 justify-center lg:justify-start animate-in fade-in slide-in-from-bottom-8 duration-1000 delay-300",children:[e.jsxs("button",{onClick:async()=>{s(!0);try{await ns.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/app`}})}catch(e){alert("Failed to sign in with Google"),s(!1)}},disabled:t,className:"h-14 px-8 rounded-full bg-slate-900 text-white font-bold text-lg hover:bg-slate-800 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 shadow-xl shadow-slate-200 w-full sm:w-auto group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/10 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),e.jsxs("svg",{className:"w-6 h-6 bg-white rounded-full p-1 relative z-10",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.11c-.22-.66-.35-1.36-.35-2.11s.13-1.45.35-2.11V7.05H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.95l3.66-2.84z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.05l3.66 2.84c.87-2.6 3.3-4.51 6.16-4.51z",fill:"#EA4335"})]}),e.jsx("span",{className:"relative z-10",children:"Continue with Google"})]}),e.jsxs("a",{href:"/UniLink.apk",download:"UniLink.apk",className:"h-14 px-6 rounded-full bg-emerald-600 text-white font-bold text-base hover:bg-emerald-500 hover:scale-[1.02] active:scale-[0.98] transition-all flex items-center justify-center gap-3 shadow-lg shadow-emerald-200 w-full sm:w-auto group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-white/10 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),e.jsxs("svg",{className:"w-6 h-6 relative z-10",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M17.523 15.3414C17.2597 15.3414 17.0459 15.1276 17.0459 14.8643V9.2571C17.0459 8.99378 17.2597 8.78 17.523 8.78C17.7863 8.78 18.0001 8.99378 18.0001 9.2571V14.8643C18.0001 15.1276 17.7863 15.3414 17.523 15.3414Z"}),e.jsx("path",{d:"M6.47741 15.3414C6.21409 15.3414 6.00031 15.1276 6.00031 14.8643V9.2571C6.00031 8.99378 6.21409 8.78 6.47741 8.78C6.74072 8.78 6.9545 8.99378 6.9545 9.2571V14.8643C6.9545 15.1276 6.74072 15.3414 6.47741 15.3414Z"}),e.jsx("path",{d:"M9.64471 18.9716C9.38139 18.9716 9.16761 18.7579 9.16761 18.4945V13.4133C9.16761 13.15 9.38139 12.9362 9.64471 12.9362C9.90802 12.9362 10.1218 13.15 10.1218 13.4133V18.4945C10.1218 18.7579 9.90802 18.9716 9.64471 18.9716Z"}),e.jsx("path",{d:"M14.3553 18.9716C14.092 18.9716 13.8782 18.7579 13.8782 18.4945V13.4133C13.8782 13.15 14.092 12.9362 14.3553 12.9362C14.6186 12.9362 14.8324 13.15 14.8324 13.4133V18.4945C14.8324 18.7579 14.6186 18.9716 14.3553 18.9716Z"}),e.jsx("path",{d:"M15.5834 8.78005H8.41659C8.28605 8.78005 8.18042 8.67442 8.18042 8.54388V8.01636C8.18042 5.80796 9.97065 4.0177 12.1791 4.0177C14.3875 4.0177 16.1777 5.80796 16.1777 8.01636V8.54388C16.1777 8.67442 16.072 8.78005 15.9415 8.78005H15.5834Z"}),e.jsx("path",{d:"M8.41659 8.78H15.5834C16.1053 8.78 16.5265 9.20117 16.5265 9.72311V15.5636C16.5265 16.8607 15.4728 17.9144 14.1757 17.9144H9.82428C8.52718 17.9144 7.47351 16.8607 7.47351 15.5636V9.72311C7.47351 9.20117 7.89468 8.78 8.41659 8.78Z"}),e.jsx("path",{d:"M10.2899 6.39993L9.50462 5.05423C9.43787 4.93804 9.47704 4.79001 9.59323 4.72326C9.70942 4.65651 9.85745 4.69568 9.9242 4.81187L10.7225 6.17729C11.1374 6.03855 11.5804 5.96309 12.0408 5.96309C12.4821 5.96309 12.9071 6.03344 13.3082 6.16321L14.1005 4.81187C14.1673 4.69568 14.3153 4.65651 14.4315 4.72326C14.5477 4.79001 14.5869 4.93804 14.5201 5.05423L13.7469 6.38405C14.8268 6.87636 15.5834 7.96777 15.5834 9.23558H8.41659C8.41659 7.97956 9.1561 6.89743 10.2899 6.39993Z"}),e.jsx("circle",{cx:"10.2",cy:"7.8",r:"0.6",fill:"white"}),e.jsx("circle",{cx:"13.8",cy:"7.8",r:"0.6",fill:"white"})]}),e.jsxs("div",{className:"relative z-10 text-left",children:[e.jsx("div",{className:"text-[10px] leading-none opacity-80 font-normal",children:"Download for"}),e.jsx("div",{className:"text-sm font-bold leading-tight",children:"Android APK"})]})]})]}),e.jsx("p",{className:"mt-3 text-xs text-slate-400 text-center lg:text-left animate-in fade-in duration-1000 delay-500",children:'Free · No Play Store needed · Enable "Install unknown apps" to install'})]}),e.jsx("div",{className:"lg:col-span-6 relative animate-in fade-in slide-in-from-bottom-12 duration-1000 delay-500 perspective-1000",children:e.jsxs("div",{className:"relative transform transition-transform hover:scale-[1.02] duration-500 group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-slate-900/10 to-transparent rounded-2xl transform translate-x-4 translate-y-4 -z-10 blur-sm"}),e.jsx("img",{src:"/assets/app-mockup-z5JVf6Bi.png",alt:"App Dashboard",className:"w-full rounded-2xl shadow-2xl border border-slate-200/50 bg-white"}),e.jsxs("div",{className:"absolute -left-6 top-1/3 bg-white p-4 rounded-xl shadow-xl border border-slate-100 animate-bounce delay-100 hidden md:flex items-center gap-3",children:[e.jsx("div",{className:"bg-emerald-100 p-2 rounded-lg text-emerald-600",children:e.jsx(N,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 text-sm",children:"Opportunities"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Verified Internships"})]})]}),e.jsxs("div",{className:"absolute -right-6 bottom-1/4 bg-white p-4 rounded-xl shadow-xl border border-slate-100 animate-bounce delay-700 hidden md:flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg text-blue-600",children:e.jsx(k,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900 text-sm",children:"Community"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Connect with Peers"})]})]})]})})]})})}),e.jsxs("section",{className:"py-24 bg-slate-50 relative",children:[e.jsx("div",{className:"absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-slate-200 to-transparent"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 md:px-8",children:[e.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-20",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-display font-bold text-slate-900 mb-6",children:"Everything you need to succeed on campus"}),e.jsx("p",{className:"text-lg text-slate-600 leading-relaxed",children:"UniLink bridges the gap between your academic life and your professional future. We provide the tools you need to stand out."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{icon:_,color:"text-emerald-600",bg:"bg-emerald-50",title:"Campus Network",desc:"Connect with students from universities across Nigeria. Share ideas, collaborate on projects, and build a network that lasts a lifetime.",image:ls},{icon:C,color:"text-emerald-600",bg:"bg-emerald-50",title:"Jobs & Internships",desc:"Stop searching aimlessly. Get access to verified job openings and internships tailored specifically for Nigerian students.",image:os},{icon:S,color:"text-emerald-600",bg:"bg-emerald-50",title:"Verified Profiles",desc:"Authenticity matters. Our verification system ensures you're connecting with real students and genuine organizations.",image:is}].map((t,s)=>e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-slate-200 hover:border-emerald-200 hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 group overflow-hidden",children:[e.jsx("div",{className:"mb-6 rounded-2xl overflow-hidden h-48 bg-slate-100",children:e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"})}),e.jsx("div",{className:`w-12 h-12 ${t.bg} ${t.color} rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:e.jsx(t.icon,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3",children:t.title}),e.jsx("p",{className:"text-slate-600 leading-relaxed text-sm",children:t.desc})]},s))})]})]}),e.jsxs("section",{id:"download",className:"py-24 bg-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[e.jsx("div",{className:"absolute -top-32 -right-32 w-96 h-96 bg-emerald-50 rounded-full blur-3xl opacity-60"}),e.jsx("div",{className:"absolute -bottom-16 -left-16 w-64 h-64 bg-teal-50 rounded-full blur-3xl opacity-60"})]}),e.jsxs("div",{className:"max-w-5xl mx-auto px-6 md:px-8 relative",children:[e.jsxs("div",{className:"text-center mb-14",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-50 border border-emerald-200 text-emerald-700 text-sm font-semibold mb-6",children:[e.jsx(j,{className:"w-4 h-4"}),"Get the App"]}),e.jsx("h2",{className:"text-3xl md:text-5xl font-display font-bold text-slate-900 mb-4",children:"UniLink in your pocket"}),e.jsx("p",{className:"text-lg text-slate-500 max-w-xl mx-auto",children:"Download the Android app and stay connected with your campus community anywhere, anytime."})]}),e.jsx("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded-3xl overflow-hidden shadow-2xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-0",children:[e.jsxs("div",{className:"p-10 flex flex-col justify-center",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-14 h-14 rounded-2xl shadow-lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-bold text-xl",children:"UniLink"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Campus Network · Nigeria"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(t=>e.jsx(z,{className:"w-4 h-4 text-amber-400 fill-amber-400"},t))}),e.jsx("span",{className:"text-slate-400 text-sm",children:"Free to download"})]}),e.jsxs("a",{href:"/UniLink.apk",download:"UniLink.apk",className:"inline-flex items-center gap-3 bg-emerald-500 hover:bg-emerald-400 text-white font-bold px-7 py-4 rounded-2xl transition-all hover:scale-[1.03] active:scale-[0.97] shadow-lg shadow-emerald-900/30 group w-full sm:w-auto justify-center sm:justify-start",children:[e.jsx(j,{className:"w-5 h-5 group-hover:animate-bounce"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-[10px] opacity-75 font-normal leading-none",children:"TAP TO DOWNLOAD"}),e.jsx("div",{className:"text-base leading-tight",children:"UniLink.apk · 10.3MB"})]})]}),e.jsx("p",{className:"text-slate-500 text-xs mt-4",children:"Android 7.0+ required"})]}),e.jsxs("div",{className:"bg-slate-800/50 p-10 border-t md:border-t-0 md:border-l border-slate-700/50",children:[e.jsx("h4",{className:"text-white font-bold mb-6 text-sm uppercase tracking-widest",children:"How to install"}),e.jsx("div",{className:"space-y-5",children:[{step:"1",title:"Download the APK",desc:"Tap the download button and save UniLink.apk to your phone."},{step:"2",title:"Allow unknown sources",desc:'Go to Settings → Security → "Install unknown apps" and enable it for your browser or file manager.'},{step:"3",title:"Open the APK",desc:"Find UniLink.apk in your Downloads folder and tap it to install."},{step:"4",title:"Sign in & connect",desc:"Open the app, sign in with Google, and join your campus network!"}].map(({step:t,title:s,desc:a})=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-emerald-500/20 border border-emerald-500/40 text-emerald-400 font-bold text-sm flex items-center justify-center flex-shrink-0",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-semibold text-sm",children:s}),e.jsx("p",{className:"text-slate-400 text-xs leading-relaxed mt-0.5",children:a})]})]},t))})]})]})}),e.jsx("p",{className:"text-center text-slate-400 text-sm mt-8",children:"📲 No Play Store needed — just download & install. Share with your classmates!"})]})]}),e.jsx("footer",{className:"bg-slate-900 text-slate-400 py-16 border-t border-slate-800",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 md:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12 mb-12",children:[e.jsxs("div",{className:"col-span-1 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 text-white",children:[e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"font-display font-bold text-xl tracking-tight",children:"UniLink"})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",children:"The professional network built for the ambitions of Nigerian students."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-800 rounded-full hover:bg-emerald-600 transition-colors cursor-pointer"}),e.jsx("div",{className:"w-8 h-8 bg-slate-800 rounded-full hover:bg-emerald-600 transition-colors cursor-pointer"}),e.jsx("div",{className:"w-8 h-8 bg-slate-800 rounded-full hover:bg-emerald-600 transition-colors cursor-pointer"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Platform"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx(d,{to:"/about",className:"hover:text-emerald-400 transition-colors",children:"About Us"})}),e.jsx("li",{children:e.jsxs("a",{href:"#download",className:"hover:text-emerald-400 transition-colors flex items-center gap-1.5",children:[e.jsx(j,{className:"w-3 h-3"})," Download App"]})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Careers"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Press"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Resources"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Blog"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Community Guidelines"})}),e.jsx("li",{children:e.jsx("a",{href:"mailto:unilinkrep@gmail.com",className:"hover:text-emerald-400 transition-colors",children:"Support"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Legal"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx(d,{to:"/legal/privacy",className:"hover:text-emerald-400 transition-colors",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx(d,{to:"/legal/terms",className:"hover:text-emerald-400 transition-colors",children:"Terms of Service"})}),e.jsx("li",{children:e.jsx(d,{to:"/legal/cookie",className:"hover:text-emerald-400 transition-colors",children:"Cookie Policy"})})]})]})]}),e.jsxs("div",{className:"pt-8 border-t border-slate-800 flex flex-col md:flex-row items-center justify-between gap-4 text-sm",children:[e.jsxs("p",{children:["© ",(new Date).getFullYear()," UniLink Nigeria. All rights reserved."]}),e.jsxs("p",{className:"flex items-center gap-1",children:["Made with ",e.jsx(z,{className:"w-4 h-4 text-amber-400 fill-amber-400"})," in Nigeria"]})]})]})})]})]})}function da(){return e.jsxs(e.Fragment,{children:[e.jsx(oa,{title:"About Us - Empowering Nigerian Students",description:"Learn about UniLink's mission to bridge the gap between campus learning and career success for every Nigerian university student.",keywords:["About UniLink","Nigerian Student Community","University of Ibadan","Student Startups Nigeria","Career Development"]}),e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans selection:bg-emerald-100 selection:text-emerald-900",children:[e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-200/50 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 flex items-center justify-between",children:[e.jsxs(d,{to:"/",className:"flex items-center gap-3 group",children:[e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-8 h-8 rounded-lg shadow-sm group-hover:scale-105 transition-transform"}),e.jsx("span",{className:"font-display font-bold text-xl tracking-tight text-slate-900",children:"UniLink"})]}),e.jsxs(d,{to:"/",className:"text-sm font-semibold text-slate-600 hover:text-emerald-600 transition-colors flex items-center gap-2",children:["Back to Home ",e.jsx(U,{className:"w-4 h-4"})]})]})}),e.jsxs("main",{className:"pt-32 pb-20",children:[e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center mb-24 relative",children:[e.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-emerald-50 border border-emerald-100/50 text-emerald-700 text-xs font-bold uppercase tracking-wider mb-8",children:e.jsx("span",{children:"Our Mission"})}),e.jsxs("h1",{className:"text-5xl md:text-6xl font-display font-bold text-slate-900 mb-8 leading-tight tracking-tight",children:["Empowering the next generation of ",e.jsx("br",{}),e.jsx("span",{className:"text-emerald-600",children:"Nigerian Leaders"})]}),e.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-2xl mx-auto font-light",children:"UniLink is more than just a social network. It's a professional ecosystem designed to bridge the gap between campus learning and career success for every Nigerian student."})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 mb-32",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 text-blue-600 rounded-xl flex items-center justify-center mb-6",children:e.jsx(k,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3 font-display",children:"Community First"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We believe in the power of connection. Every student deserves access to a supportive network of peers, mentors, and alumni, regardless of their university."})]}),e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-50 text-emerald-600 rounded-xl flex items-center justify-center mb-6",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3 font-display",children:"Career Focused"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'Our platform is built to launch careers. We replace the "who you know" barrier with "what you can do", providing tools to showcase your skills to the world.'})]}),e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300",children:[e.jsx("div",{className:"w-12 h-12 bg-amber-50 text-amber-600 rounded-xl flex items-center justify-center mb-6",children:e.jsx(S,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3 font-display",children:"Safe & Verified"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Trust is paramount. We heavily vet our community to ensure a safe, professional, and authentic environment for collaboration and growth."})]})]})}),e.jsx("div",{className:"max-w-5xl mx-auto px-6 mb-24",children:e.jsx("div",{className:"bg-slate-900 text-slate-300 rounded-3xl overflow-hidden shadow-2xl relative",children:e.jsxs("div",{className:"p-10 md:p-16 relative z-10",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-8 font-display",children:"Our Story"}),e.jsxs("div",{className:"space-y-6 text-lg font-light leading-relaxed",children:[e.jsxs("p",{children:["Founded in 2026 by ",e.jsx("span",{className:"text-white font-semibold",children:"Daniel Oyasor"})," and ",e.jsx("span",{className:"text-white font-semibold",children:"Akele Divine"}),", two Economics students from the University of Ibadan, UniLink was born out of a simple observation: Nigerian universities are full of incredible talent, but opportunities are often hidden or disconnected from students."]}),e.jsx("p",{children:"As students ourselves, we experienced firsthand the challenges of finding internships, connecting with like-minded peers, and accessing career opportunities. We saw brilliant students building amazing things in isolation, struggling to showcase their skills, and missing out on mentorship that could change their lives."}),e.jsx("p",{className:"text-white font-medium",children:"We set out to build a platform that unifies the student experience—bringing together social connection, academic collaboration, and professional development. Today, we are growing rapidly across campuses, helping students build portfolios that get them hired and connections that last a lifetime."})]})]})})}),e.jsx("div",{className:"text-center py-10",children:e.jsxs(d,{to:"/",className:"group inline-flex items-center gap-3 text-emerald-600 font-bold text-lg hover:text-emerald-700 transition-all bg-emerald-50 px-8 py-4 rounded-full border border-emerald-100 hover:border-emerald-200",children:["Join the movement ",e.jsx(U,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})]}),e.jsx("footer",{className:"bg-slate-900 text-slate-400 py-16 border-t border-slate-800",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 md:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12 mb-12",children:[e.jsxs("div",{className:"col-span-1 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6 text-white",children:[e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-8 h-8 rounded-lg"}),e.jsx("span",{className:"font-display font-bold text-xl tracking-tight",children:"UniLink"})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-6",children:"The professional network built for the ambitions of Nigerian students."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-800 rounded-full hover:bg-emerald-600 transition-colors cursor-pointer"}),e.jsx("div",{className:"w-8 h-8 bg-slate-800 rounded-full hover:bg-emerald-600 transition-colors cursor-pointer"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Platform"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx(d,{to:"/about",className:"hover:text-emerald-400 transition-colors",children:"About Us"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Careers"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Press"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Resources"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Blog"})}),e.jsx("li",{children:e.jsx("a",{href:"#",className:"hover:text-emerald-400 transition-colors",children:"Community Guidelines"})}),e.jsx("li",{children:e.jsx("a",{href:"mailto:unilinkrep@gmail.com",className:"hover:text-emerald-400 transition-colors",children:"Support"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold mb-6",children:"Legal"}),e.jsxs("ul",{className:"space-y-4 text-sm",children:[e.jsx("li",{children:e.jsx(d,{to:"/legal/privacy",className:"hover:text-emerald-400 transition-colors",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx(d,{to:"/legal/terms",className:"hover:text-emerald-400 transition-colors",children:"Terms of Service"})})]})]})]}),e.jsxs("div",{className:"pt-8 border-t border-slate-800 flex flex-col md:flex-row items-center justify-between gap-4 text-sm",children:[e.jsxs("p",{children:["© ",(new Date).getFullYear()," UniLink Nigeria. All rights reserved."]}),e.jsxs("p",{className:"flex items-center gap-1",children:["Made with ",e.jsx(z,{className:"w-4 h-4 text-amber-400 fill-amber-400"})," in Nigeria"]})]})]})})]})]})}function ca({title:t,message:s,isVisible:a,onClose:r,onClick:n}){return i.useEffect(()=>{if(a){const e=setTimeout(()=>{r()},5e3);return()=>clearTimeout(e)}},[a,r]),a?e.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[100] w-full max-w-sm px-4 pointer-events-none md:justify-end md:left-auto md:right-4 md:translate-x-0",children:e.jsxs("div",{onClick:()=>{n&&(n(),r())},className:"bg-white/90 backdrop-blur-xl border border-white/20 shadow-2xl rounded-2xl p-4 pointer-events-auto animate-in slide-in-from-top-4 fade-in duration-300 ring-1 ring-black/5 flex items-start gap-4 "+(n?"cursor-pointer hover:bg-white transition-colors":""),children:[e.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-full shrink-0",children:e.jsx(A,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{className:"flex-1 min-w-0 pt-0.5",children:[e.jsx("h4",{className:"font-bold text-slate-900 text-sm",children:t}),e.jsx("p",{className:"text-sm text-slate-500 mt-0.5 max-h-10 overflow-hidden text-ellipsis",children:s})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),r()},className:"p-1 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(D,{className:"w-4 h-4"})})]})}):null}function ma({user:t,onComplete:s}){const[a,r]=i.useState(""),[n,o]=i.useState(!1),[l,d]=i.useState(null);return e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-stone-900/30 backdrop-blur-sm animate-in fade-in duration-300"}),e.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-3xl shadow-2xl p-8 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(L,{className:"w-8 h-8"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Choose your Username"}),e.jsx("p",{className:"text-slate-500",children:"UniLink has been updated! Set a unique username to personalize your profile link and mentions."})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),o(!0),d(null);const r=a.trim().toLowerCase();if(r.length<3)return d("Minimum 3 characters required"),void o(!1);if(!/^[a-z0-9_]+$/.test(r))return d("Only letters, numbers, and underscores"),void o(!1);try{const{error:e}=await ns.from("profiles").update({username:r}).eq("id",t.id);if(e){if("23505"===e.code)throw new Error("Username taken. Try another.");throw e}s(r)}catch(n){d(n.message)}finally{o(!1)}},className:"space-y-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"absolute left-4 top-3.5 text-slate-400 font-medium",children:"@"}),e.jsx("input",{type:"text",value:a,onChange:e=>r(e.target.value.toLowerCase().replace(/\s/g,"")),placeholder:"username",className:"w-full pl-8 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 transition-all font-medium text-lg lowercase",autoFocus:!0})]}),l&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 p-3 rounded-lg animate-in slide-in-from-top-1",children:[e.jsx(D,{className:"w-4 h-4"}),l]}),e.jsx("button",{type:"submit",disabled:n||!a,className:"w-full bg-slate-900 text-white font-bold py-4 rounded-xl hover:bg-emerald-600 disabled:opacity-50 disabled:hover:bg-slate-900 transition-all shadow-lg hover:shadow-emerald-500/20 flex items-center justify-center gap-2",children:n?e.jsx(M,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Claim Username ",e.jsx(E,{className:"w-5 h-5"})]})}),e.jsx("p",{className:"text-xs text-center text-slate-400 mt-4",children:"This cannot be easily changed later."})]})]})]})}class ua extends i.Component{state={hasError:!1,error:null};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-stone-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-3xl p-8 border border-stone-100 shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mx-auto mb-6 text-red-500",children:e.jsx(T,{className:"w-8 h-8"})}),e.jsx("h1",{className:"text-2xl font-bold text-stone-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-stone-500 mb-6 text-sm",children:"We encountered an unexpected error. Try refreshing the page or return to the dashboard."}),this.state.error&&e.jsx("div",{className:"bg-stone-50 p-4 rounded-xl border border-stone-200 text-left mb-6 overflow-hidden",children:e.jsx("p",{className:"text-xs font-mono text-red-600 break-words",children:this.state.error.toString()})}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs("button",{onClick:()=>window.location.reload(),className:"px-6 py-2.5 rounded-xl border border-stone-200 text-stone-600 font-medium hover:bg-stone-50 transition-colors flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"Reload"]}),e.jsxs("button",{onClick:()=>window.location.href="/app",className:"px-6 py-2.5 rounded-xl bg-stone-900 text-white font-medium hover:bg-stone-800 transition-colors flex items-center gap-2 shadow-lg shadow-stone-200",children:[e.jsx(O,{className:"w-4 h-4"}),"Dashboard"]})]})]})}):this.props.children}}function ha({isOpen:t,onClose:s,isIOS:a}){return t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-in fade-in duration-200",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"bg-slate-50 border-b border-slate-100 p-4 flex justify-between items-center",children:[e.jsx("h3",{className:"font-display font-bold text-lg text-slate-900",children:"Install UniLink"}),e.jsx("button",{onClick:s,className:"p-1 hover:bg-slate-200 rounded-full transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-slate-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:"/icon-512.png",alt:"Icon",className:"w-20 h-20 rounded-2xl shadow-lg"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-center text-slate-600 font-medium",children:"Add UniLink to your home screen for the best experience."}),e.jsx("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-100 space-y-3",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-700",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-600 rounded-full font-bold text-xs shrink-0",children:"1"}),e.jsxs("span",{children:["Tap the ",e.jsx(R,{className:"w-4 h-4 inline mx-1"})," Share button"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-700",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-blue-100 text-blue-600 rounded-full font-bold text-xs shrink-0",children:"2"}),e.jsxs("span",{children:["Select ",e.jsx(F,{className:"w-4 h-4 inline mx-1"})," Add to Home Screen"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-700",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full font-bold text-xs shrink-0",children:"1"}),e.jsxs("span",{children:["Tap the ",e.jsx($,{className:"w-4 h-4 inline mx-1"})," Menu button"]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-700",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full font-bold text-xs shrink-0",children:"2"}),e.jsx("span",{children:'Select "Install App" or "Add to Home Screen"'})]})]})})]}),e.jsx("button",{onClick:s,className:"w-full py-3 bg-slate-900 text-white rounded-xl font-bold hover:bg-slate-800 transition-colors",children:"Got it"})]})]})]}):null}const xa=q((e,t)=>({requests:[],generalNotifications:[],lastFetched:0,setRequests:t=>e({requests:t}),setGeneralNotifications:t=>e({generalNotifications:t,lastFetched:Date.now()}),addGeneralNotification:t=>e(e=>e.generalNotifications.some(e=>e.id===t.id)?e:{generalNotifications:[t,...e.generalNotifications]}),removeRequest:t=>e(e=>({requests:e.requests.filter(e=>e.id!==t)})),removeGeneralNotifications:t=>e(e=>({generalNotifications:e.generalNotifications.filter(e=>!t.includes(e.id))})),clearGeneralNotifications:()=>e({generalNotifications:[]}),needsRefresh:()=>Date.now()-t().lastFetched>3e5}));function pa(){const{requests:e,generalNotifications:t,setRequests:s,setGeneralNotifications:a,addGeneralNotification:r,removeRequest:n,removeGeneralNotifications:o,clearGeneralNotifications:l,needsRefresh:d}=xa(),[c,m]=i.useState(!0),[u,h]=i.useState(null),x=i.useCallback(async()=>{try{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;m(!0);const{data:t}=await ns.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(50);t&&a(t);const{data:r}=await ns.from("connections").select("\n                    id,\n                    created_at,\n                    requester:profiles!requester_id (\n                        id,\n                        name,\n                        role,\n                        university,\n                        avatar_url\n                    )\n                ").eq("recipient_id",e.id).eq("status","pending").order("created_at",{ascending:!1});if(r){const e=r.map(e=>({id:e.id,created_at:e.created_at,requester:e.requester}));s(e)}}catch(e){}finally{m(!1)}},[a,s]);i.useEffect(()=>{(async()=>{d()||0===e.length&&0===t.length?await x():m(!1)})();const a=ns.channel("connection-requests").on("postgres_changes",{event:"INSERT",schema:"public",table:"connections"},t=>{ns.auth.getUser().then(({data:{user:a}})=>{a&&t.new.recipient_id===a.id&&(async t=>{const{data:a}=await ns.from("connections").select("\n                id,\n                created_at,\n                requester:profiles!requester_id (*)\n            ").eq("id",t).single();if(a){s([{id:a.id,created_at:a.created_at,requester:a.requester},...e]);const t={id:a.id,created_at:a.created_at,requester:a.requester};e.some(e=>e.id===t.id)||s([t,...e])}})(t.new.id)})}).subscribe(),n=ns.channel("general-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications"},e=>{ns.auth.getUser().then(({data:{user:t}})=>{t&&e.new.user_id===t.id&&r(e.new)})}).subscribe();return()=>{ns.removeChannel(a),ns.removeChannel(n)}},[]);return{requests:e,generalNotifications:t,loading:c,processing:u,handleAction:async(e,t)=>{h(e);try{"accept"===t?await ns.from("connections").update({status:"accepted"}).eq("id",e):await ns.from("connections").update({status:"rejected"}).eq("id",e),n(e)}catch(s){}finally{h(null)}},clearAll:async()=>{try{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{error:t}=await ns.from("notifications").delete().eq("user_id",e.id);if(t)throw t;l()}catch(e){alert("Failed to clear notifications")}},deleteNotifications:async e=>{try{const{error:t}=await ns.from("notifications").delete().in("id",e);if(t)throw t;o(e)}catch(t){alert("Failed to delete notifications")}}}}function ga(e){const[t,s]=i.useState(!1),[a,r]=i.useState(!1),[n,o]=i.useState(!1),[l,d]=i.useState(!1);i.useEffect(()=>{const t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;s(t);r(window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone),window.deferredPrompt&&o(!0);const a=t=>{t.preventDefault(),window.deferredPrompt=t,o(!0),e?.onInstallAvailable&&e.onInstallAvailable()};window.addEventListener("beforeinstallprompt",a);const n=()=>{o(!1),r(!0),window.deferredPrompt=null};return window.addEventListener("appinstalled",n),()=>{window.removeEventListener("beforeinstallprompt",a),window.removeEventListener("appinstalled",n)}},[e]);return{isInstallable:!a&&n,install:async()=>{const e=window.deferredPrompt;if(e)try{e.prompt();const{outcome:t}=await e.userChoice;window.deferredPrompt=null,o(!1)}catch(t){}},showInstallModal:l,setShowInstallModal:d,isIOs:t,canPrompt:n}}"undefined"!=typeof window&&window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),window.deferredPrompt=e});const fa=()=>{const e=localStorage.getItem("darkMode");return null!==e?"true"===e:window.matchMedia("(prefers-color-scheme: dark)").matches},ba=q(e=>({isImmersive:!1,setImmersive:t=>e({isImmersive:t}),toggleImmersive:()=>e(e=>({isImmersive:!e.isImmersive})),isDarkMode:fa(),toggleDarkMode:()=>e(e=>{const t=!e.isDarkMode;return localStorage.setItem("darkMode",String(t)),document.documentElement.classList.toggle("dark",t),{isDarkMode:t}}),setDarkMode:t=>{localStorage.setItem("darkMode",String(t)),document.documentElement.classList.toggle("dark",t),e({isDarkMode:t})},showSplash:"true"!==sessionStorage.getItem("hasSeenSplash"),setShowSplash:t=>{t||sessionStorage.setItem("hasSeenSplash","true"),e({showSplash:t})}}));var va,wa;(wa=va||(va={})).Unimplemented="UNIMPLEMENTED",wa.Unavailable="UNAVAILABLE";class ja extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const ya=e=>{const t=e.CapacitorCustomPlatform||null,s=e.Capacitor||{},a=s.Plugins=s.Plugins||{},r=()=>null!==t?t.name:(e=>{var t,s;return(null==e?void 0:e.androidBridge)?"android":(null===(s=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===s?void 0:s.bridge)?"ios":"web"})(e),n=e=>{var t;return null===(t=s.PluginHeaders)||void 0===t?void 0:t.find(t=>t.name===e)},i=new Map;return s.convertFileSrc||(s.convertFileSrc=e=>e),s.getPlatform=r,s.handleError=t=>e.console.error(t),s.isNativePlatform=()=>"web"!==r(),s.isPluginAvailable=e=>{const t=i.get(e);return!!(null==t?void 0:t.platforms.has(r()))||!!n(e)},s.registerPlugin=(e,o={})=>{const l=i.get(e);if(l)return l.proxy;const d=r(),c=n(e);let m;const u=a=>{let r;const n=(...n)=>{const i=(async()=>(!m&&d in o?m=m="function"==typeof o[d]?await o[d]():o[d]:null!==t&&!m&&"web"in o&&(m=m="function"==typeof o.web?await o.web():o.web),m))().then(t=>{const i=((t,a)=>{var r,n;if(!c){if(t)return null===(n=t[a])||void 0===n?void 0:n.bind(t);throw new ja(`"${e}" plugin is not implemented on ${d}`,va.Unimplemented)}{const n=null==c?void 0:c.methods.find(e=>a===e.name);if(n)return"promise"===n.rtype?t=>s.nativePromise(e,a.toString(),t):(t,r)=>s.nativeCallback(e,a.toString(),t,r);if(t)return null===(r=t[a])||void 0===r?void 0:r.bind(t)}})(t,a);if(i){const e=i(...n);return r=null==e?void 0:e.remove,e}throw new ja(`"${e}.${a}()" is not implemented on ${d}`,va.Unimplemented)});return"addListener"===a&&(i.remove=async()=>r()),i};return n.toString=()=>`${a.toString()}() { [capacitor code] }`,Object.defineProperty(n,"name",{value:a,writable:!1,configurable:!1}),n},h=u("addListener"),x=u("removeListener"),p=(e,t)=>{const s=h({eventName:e},t),a=async()=>{const a=await s;x({eventName:e,callbackId:a},t)},r=new Promise(e=>s.then(()=>e({remove:a})));return r.remove=async()=>{await a()},r},g=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return c?p:h;case"removeListener":return x;default:return u(t)}}});return a[e]=g,i.set(e,{name:e,proxy:g,platforms:new Set([...Object.keys(o),...c?[d]:[]])}),g},s.Exception=ja,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},Na=(e=>e.Capacitor=ya(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),ka=Na.registerPlugin;class _a{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),s&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const a=this.listeners[e];if(a)a.forEach(e=>e(t));else if(s){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}}hasListeners(e){var t;return!!(null===(t=this.listeners[e])||void 0===t?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new Na.Exception(e,va.Unimplemented)}unavailable(e="not available"){return new Na.Exception(e,va.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const a=s.indexOf(t);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}const Ca=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Sa=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class za extends _a{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[s,a]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Sa(s).trim(),a=Sa(a).trim(),t[s]=a}),t}async setCookie(e){try{const t=Ca(e.key),s=Ca(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),n=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${a}; path=${r}; ${n};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ka("CapacitorCookies",{web:()=>new za});const Ua=(e,t={})=>{const s=Object.assign({method:e.method||"GET",headers:e.headers},t),a=((e={})=>{const t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((s,a,r)=>(s[a]=e[t[r]],s),{})})(e.headers)["content-type"]||"";if("string"==typeof e.data)s.body=e.data;else if(a.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[s,a]of Object.entries(e.data||{}))t.set(s,a);s.body=t.toString()}else if(a.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,s)=>{t.append(s,e)});else for(const s of Object.keys(e.data))t.append(s,e.data[s]);s.body=t;const a=new Headers(s.headers);a.delete("content-type"),s.headers=a}else(a.includes("application/json")||"object"==typeof e.data)&&(s.body=JSON.stringify(e.data));return s};class Pa extends _a{async request(e){const t=Ua(e,e.webFetchExtra),s=((e,t=!0)=>e?Object.entries(e).reduce((e,s)=>{const[a,r]=s;let n,i;return Array.isArray(r)?(i="",r.forEach(e=>{n=t?encodeURIComponent(e):e,i+=`${a}=${n}&`}),i.slice(0,-1)):(n=t?encodeURIComponent(r):r,i=`${a}=${n}`),`${e}&${i}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),a=s?`${e.url}?${s}`:e.url,r=await fetch(a,t),n=r.headers.get("content-type")||"";let i,o,{responseType:l="text"}=r.ok?e:{};switch(n.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await r.blob(),i=await(async e=>new Promise((t,s)=>{const a=new FileReader;a.onload=()=>{const e=a.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},a.onerror=e=>s(e),a.readAsDataURL(e)}))(o);break;case"json":i=await r.json();break;default:i=await r.text()}const d={};return r.headers.forEach((e,t)=>{d[t]=e}),{data:i,headers:d,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}var Aa,Da,La,Ma;ka("CapacitorHttp",{web:()=>new Pa}),(Da=Aa||(Aa={})).Dark="DARK",Da.Light="LIGHT",Da.Default="DEFAULT",(Ma=La||(La={})).StatusBar="StatusBar",Ma.NavigationBar="NavigationBar";class Ea extends _a{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}ka("SystemBars",{web:()=>new Ea});const Ta=ka("PushNotifications",{});function Ia(){const e=c(),t=i.useRef(!1);i.useEffect(()=>{if(!Na.isNativePlatform())return;if(t.current)return;t.current=!0;return(async()=>{"granted"===(await Ta.requestPermissions()).receive&&(await Ta.register(),Ta.addListener("registration",async e=>{await async function(e){try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const s=Na.getPlatform();await ns.from("push_tokens").upsert({user_id:t.id,token:e,platform:s,updated_at:(new Date).toISOString()},{onConflict:"user_id,platform"})}catch(t){}}(e.value)}),Ta.addListener("registrationError",e=>{}),Ta.addListener("pushNotificationReceived",e=>{}),Ta.addListener("pushNotificationActionPerformed",t=>{const s=t.notification.data;e("message"===s?.type?"/app/messages"+(s.chat_id?`?chat=${s.chat_id}`:""):"connection_request"===s?.type?"/app/notifications":"post"===s?.type?s.post_id?`/app/post/${s.post_id}`:"/app":"/app/notifications")}))})(),()=>{Ta.removeAllListeners()}},[e])}function Oa(){const t=c(),s=m(),{isImmersive:a}=ba(),[r,n]=i.useState(!1),[o,l]=i.useState(0);Ia();const{requests:d,generalNotifications:x}=pa(),p=d.length+x.filter(e=>!e.read).length,[g,f]=i.useState(null),[b,v]=i.useState(()=>"Notification"in window?Notification.permission:"denied"),[w,y]=i.useState({title:"",message:"",isVisible:!1}),{isInstallable:N,install:z,showInstallModal:U,setShowInstallModal:P,isIOs:L}=ga({onInstallAvailable:()=>{y({title:"📱 Install UniLink",message:"You can now install UniLink as an app. Click here or use the Install button in settings.",isVisible:!0,onClick:z})}}),M=(e,t,s)=>{if("Notification"in window&&"hidden"===document.visibilityState&&"granted"===Notification.permission)if("serviceWorker"in navigator&&navigator.serviceWorker.ready)navigator.serviceWorker.ready.then(a=>{a.showNotification(e,{body:t,icon:"/icon-512.png",vibrate:[200,100,200],tag:"ulink-notification",renotify:!0,data:{url:window.location.origin+(s?"":"/app/notifications")}})}).catch(e=>{});else try{new Notification(e,{body:t,icon:"/icon-512.png"})}catch(a){}y({title:e,message:t,isVisible:!0,onClick:s}),"hidden"===document.visibilityState&&T()},E=i.useRef(null),T=()=>{try{E.current||(E.current=new(window.AudioContext||window.webkitAudioContext));const e=E.current;"suspended"===e.state&&e.resume();const t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.type="sine",t.frequency.setValueAtTime(880,e.currentTime),s.gain.setValueAtTime(.1,e.currentTime),s.gain.exponentialRampToValueAtTime(1e-5,e.currentTime+.4),t.start(),t.stop(e.currentTime+.4)}catch(e){}},I=i.useRef(s.pathname);i.useEffect(()=>{I.current=s.pathname},[s.pathname]),i.useEffect(()=>{const e=()=>{const t=window.AudioContext||window.webkitAudioContext;if(t){const e=new t;"suspended"===e.state&&e.resume()}window.removeEventListener("click",e)};return window.addEventListener("click",e),()=>window.removeEventListener("click",e)},[]),i.useEffect(()=>{let e;return(async()=>{const{data:{user:s}}=await ns.auth.getUser();if(!s)return await ns.auth.signOut(),void t("/");const{data:a}=await ns.from("profiles").select("*").eq("id",s.id).single();a?(f(a),a.role||t("/onboarding")):t("/onboarding");const r=async()=>{if(!s?.id)return;const{count:e}=await ns.from("messages").select("id",{count:"exact",head:!0}).eq("recipient_id",s.id).is("read_at",null);null!==e&&l(e)};r(),e=ns.channel("dashboard-alerts").on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`recipient_id=eq.${s.id}`},async e=>{if(r(),"INSERT"===e.eventType&&e.new){const s=new URLSearchParams(window.location.search).get("chat");if(window.location.pathname.startsWith("/app/messages")&&s===e.new.sender_id)return;let a="Someone";if(e.new.sender_id){const{data:t}=await ns.from("profiles").select("name").eq("id",e.new.sender_id).single();t&&(a=t.name)}M(`New message from ${a}`,e.new.content||"Sent an attachment",()=>t(`/app/messages?chat=${e.new.sender_id}`))}}).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${s.id}`},e=>{I.current.startsWith("/app/notifications")||M("New Notification","You have a new notification",()=>t("/app/notifications"))}).subscribe()})(),()=>{e&&ns.removeChannel(e)}},[]),i.useEffect(()=>{const e=()=>{ns.rpc("update_last_seen").then(({error:e})=>{})};e();const t=setInterval(e,3e5);return()=>clearInterval(t)},[]);const O=async()=>{await ns.auth.signOut(),t("/")},R=[{icon:B,label:"Home",path:"/app"},{icon:k,label:"Network",path:"/app/network"},{icon:_,label:"Communities",path:"/app/communities"},{icon:H,label:"Challenge",path:"/app/challenge"},{icon:W,label:"Messages",path:"/app/messages"},{icon:A,label:"Notifications",path:"/app/notifications"},{icon:K,label:"Profile",path:g?`/app/profile/${g.username||g.id}`:"/app/profile"}],F=[{icon:C,label:"Career",path:"/app/jobs"},{icon:Y,label:"Leaderboard",path:"/app/leaderboard"},{icon:G,label:"Courses",path:"/app/learn"},{icon:V,label:"Settings",path:"/app/settings"},..."org"===g?.role?[{icon:Q,label:"Talent",path:"/app/talent"}]:[],...g?.is_admin?[{icon:S,label:"Admin",path:"/app/admin"}]:[]],$=[...R,...F],q=e=>"Messages"===e?o:"Notifications"===e?p:0,Z=$.filter(e=>["Home","Network","Challenge","Messages","Profile"].includes(e.label));return e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA] text-slate-900 font-sans selection:bg-indigo-500/10 selection:text-indigo-600 overflow-hidden relative transition-colors duration-300",children:[e.jsx("div",{className:"fixed inset-0 bg-grid-slate-200/50 bg-[length:30px_30px] opacity-40 pointer-events-none z-0"}),"/app/learn"!==s.pathname&&e.jsxs("header",{className:"md:hidden fixed top-0 left-0 right-0 h-16 bg-white/80 backdrop-blur-xl border-b border-slate-200 flex items-center justify-between px-4 z-40",children:[e.jsxs("button",{onClick:()=>n(!0),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors relative",children:[e.jsx(J,{className:"w-6 h-6"}),p>0&&e.jsx("span",{className:"absolute top-2 right-2 flex h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-white"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-display font-bold text-lg text-slate-900",children:"UniLink"}),e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-8 h-8 rounded-lg"})]})]}),r&&e.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:()=>n(!1)}),e.jsxs("div",{className:"absolute top-0 left-0 bottom-0 w-[280px] bg-white shadow-2xl p-6 flex flex-col animate-in slide-in-from-left duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("span",{className:"font-display font-bold text-xl text-slate-900",children:"Menu"}),e.jsx("button",{onClick:()=>n(!1),className:"p-2 text-slate-400 hover:bg-slate-100 rounded-lg",children:e.jsx(D,{className:"w-6 h-6"})})]}),e.jsxs("nav",{className:"flex-1 overflow-y-auto space-y-1",children:[R.map(t=>t.comingSoon?e.jsxs("div",{className:"relative flex items-center gap-3 px-4 py-3 rounded-xl transition-all text-slate-400 cursor-not-allowed bg-slate-50/50",children:[e.jsx(t.icon,{className:"w-5 h-5 opacity-70"}),e.jsx("span",{className:"font-medium",children:t.label}),e.jsx("span",{className:"ml-auto text-[10px] font-bold px-2 py-0.5 bg-slate-200 text-slate-500 rounded-full",children:"Soon"})]},t.label):e.jsxs(u,{to:t.path,onClick:()=>n(!1),end:"/app"===t.path,className:({isActive:e})=>"relative flex items-center gap-3 px-4 py-3 rounded-xl transition-all "+(e?"bg-stone-900 text-white shadow-md":"text-stone-600 hover:bg-stone-50"),children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.icon,{className:"w-5 h-5"}),q(t.label)>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white ring-2 ring-white",children:q(t.label)})]}),e.jsx("span",{className:"font-medium",children:t.label})]},t.path)),e.jsx("div",{className:"px-4 pt-4 pb-1",children:e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"More"})}),F.map(t=>t.comingSoon?e.jsxs("div",{className:"relative flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all text-slate-300 cursor-not-allowed",children:[e.jsx(t.icon,{className:"w-4 h-4 opacity-70"}),e.jsx("span",{className:"text-sm font-medium",children:t.label}),e.jsx("span",{className:"ml-auto text-[10px] font-bold px-2 py-0.5 bg-slate-100 text-slate-400 rounded-full",children:"Soon"})]},t.label):e.jsxs(u,{to:t.path,onClick:()=>n(!1),end:"/app"===t.path,className:({isActive:e})=>"relative flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all "+(e?"bg-stone-100 text-stone-900":"text-stone-400 hover:text-stone-700 hover:bg-stone-50"),children:[e.jsx(t.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.path))]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-white shadow-sm flex-shrink-0",children:e.jsx("img",{src:g?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(g?.name||"User")}&background=random`,alt:g?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-sm font-bold text-slate-800 truncate",children:g?.name||"User"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate uppercase tracking-tight opacity-70",children:"org"===g?.role?"Organization":g?.university||g?.role})]})]}),N&&e.jsxs("button",{onClick:z,className:"flex items-center gap-3 px-4 py-3 w-full text-emerald-600 hover:bg-emerald-50 rounded-xl transition-all mb-2",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Install App"})]}),e.jsxs("button",{onClick:O,className:"flex items-center gap-3 px-4 py-3 w-full text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-xl transition-all",children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Log Out"})]})]})]})]}),e.jsxs("aside",{className:"w-[280px] fixed h-full hidden md:flex flex-col z-40 border-r border-slate-200 bg-white/80 backdrop-blur-xl",children:[e.jsx("div",{className:"p-8 border-b border-slate-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/icon-512.png",alt:"UniLink",className:"w-10 h-10 shadow-sm rounded-xl"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-display font-bold tracking-tight text-slate-900",children:"UniLink"}),e.jsx("div",{className:"text-xs font-medium text-slate-500 tracking-wide",children:"Student Network"})]})]})}),e.jsxs("nav",{className:"flex-1 px-4 py-6 overflow-y-auto space-y-1",children:[e.jsx("div",{className:"px-4 mb-3",children:e.jsx("span",{className:"text-xs font-semibold text-slate-400 tracking-wider",children:"MAIN"})}),R.map(t=>e.jsxs(u,{to:t.path,end:"/app"===t.path,className:({isActive:e})=>"relative group flex items-center gap-3 px-4 py-2.5 rounded-xl transition-all duration-300 "+(e?"bg-stone-900 text-white shadow-xl shadow-stone-200 ring-1 ring-stone-900":"text-stone-500 hover:text-stone-900 hover:bg-stone-50"),children:[e.jsxs("div",{className:"relative",children:[e.jsx(t.icon,{className:"w-5 h-5",strokeWidth:1.5}),q(t.label)>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white ring-2 ring-white",children:q(t.label)})]}),e.jsx("span",{className:"font-sans text-sm font-medium",children:t.label})]},t.path)),e.jsx("div",{className:"px-4 pt-4 pb-2",children:e.jsx("span",{className:"text-xs font-semibold text-slate-400 tracking-wider",children:"MORE"})}),F.map(t=>e.jsxs(u,{to:t.path,end:"/app"===t.path,className:({isActive:e})=>"relative group flex items-center gap-3 px-4 py-2 rounded-xl transition-all duration-300 "+(e?"bg-stone-100 text-stone-900 font-semibold":"text-stone-400 hover:text-stone-700 hover:bg-stone-50"),children:[e.jsx(t.icon,{className:"w-4 h-4",strokeWidth:1.5}),e.jsx("span",{className:"font-sans text-xs font-medium",children:t.label})]},t.path))]}),e.jsxs("div",{className:"p-4 border-t border-slate-100 bg-slate-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 px-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 overflow-hidden ring-2 ring-white shadow-sm flex-shrink-0",children:e.jsx("img",{src:g?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(g?.name||"User")}&background=random`,alt:g?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"text-sm font-bold text-slate-800 truncate",children:g?.name||"User"}),e.jsx("p",{className:"text-[10px] text-slate-500 font-medium truncate uppercase tracking-tight opacity-70",children:"org"===g?.role?"Organization":g?.university||g?.role})]})]}),"default"===b&&e.jsxs("button",{onClick:async()=>{if(!("Notification"in window))return void alert("Notifications are not supported on this device.");const e=await Notification.requestPermission();v(e)},className:"w-full mb-3 px-3 py-2 bg-emerald-50 text-emerald-600 rounded-lg text-xs font-semibold hover:bg-emerald-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(A,{className:"w-3 h-3"})," Enable Notifications"]}),N&&e.jsxs("button",{onClick:z,className:"flex items-center gap-3 px-4 py-2.5 w-full text-emerald-600 hover:bg-emerald-50 border border-transparent rounded-xl transition-all duration-300 group mb-2",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{className:"font-sans text-xs font-semibold",children:"Install App"})]}),e.jsxs("button",{onClick:O,className:"flex items-center gap-3 px-4 py-2.5 w-full text-slate-500 hover:text-red-600 hover:bg-red-50 border border-transparent rounded-xl transition-all duration-300 group",children:[e.jsx(X,{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform",strokeWidth:1.5}),e.jsx("span",{className:"font-sans text-xs font-semibold",children:"Log Out"})]}),e.jsx("div",{className:"mt-6 px-2 text-[10px] text-slate-400 font-medium space-y-2 border-t border-slate-100 pt-4",children:e.jsxs("p",{className:"opacity-70",children:["© ",(new Date).getFullYear()," UniLink Nigeria. All rights reserved."]})})]})]}),e.jsx("main",{className:"flex-1 md:ml-[280px] min-h-screen relative z-10 transition-colors duration-300 md:pt-0 "+("/app/learn"===s.pathname?"pt-0":"pt-16"),children:e.jsx("div",{className:"/app/learn"===s.pathname?"w-full h-full p-0":"max-w-7xl mx-auto p-6 md:p-10 pb-32",children:e.jsx(ua,{children:e.jsx(h,{})})})}),e.jsx("nav",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-xl border-t border-stone-200 flex justify-around p-3 pb-safe z-40 shadow-[0_-4px_20px_rgba(0,0,0,0.05)] transition-transform duration-300 "+(a?"translate-y-full":"translate-y-0"),children:Z.map(t=>e.jsx(u,{to:t.path,end:"/app"===t.path,className:({isActive:e})=>"relative flex flex-col items-center gap-1 p-2 rounded-lg transition-all "+(e?"text-emerald-600":"text-stone-400 hover:text-stone-600"),children:e.jsxs("div",{className:"relative",children:[e.jsx(t.icon,{className:"w-6 h-6",strokeWidth:1.5}),q(t.label)>0&&e.jsx("span",{className:"absolute -top-1.5 -right-1.5 flex h-3.5 w-3.5 items-center justify-center rounded-full bg-red-500 text-[9px] font-bold text-white ring-2 ring-white",children:q(t.label)})]})},t.path))}),g&&!g.username&&e.jsx(ma,{user:g,onComplete:e=>f({...g,username:e})}),e.jsx(ca,{title:w.title,message:w.message,isVisible:w.isVisible,onClose:()=>y(e=>({...e,isVisible:!1})),onClick:w.onClick}),e.jsx(ha,{isOpen:U,onClose:()=>P(!1),isIOS:L})]})}const Ra=new Set(["chidi_okonkwo","amara_writes","tunde_codes","ngozi_builders","emekatech","fatima_finance","davidosei_art","blessings_med","ibrahim_econ","adaeze_fashion","seun_sports","chisom_biz"]),Fa=new Set(["chidiokonkwo@gmail.com","amaraeze@gmail.com","tundeadeyemi@gmail.com","ngoziobi@gmail.com","emekanwosu@gmail.com","fatimabello@gmail.com","davidosei@gmail.com","blessingpeter@gmail.com","ibrahimmusa@gmail.com","adaezenwofor@gmail.com","seunadesanya@gmail.com","chisomokeke@gmail.com"]),$a=e=>e.filter(e=>!Ra.has(e.username||"")&&!Fa.has(e.email||""));function qa(){const{suggestions:t,myNetwork:s,loading:a,connections:r,sentRequests:n,connecting:o,connect:l,searchUsers:c,searchResults:m,searching:u,userProfile:h}=function(){const[e,t]=i.useState([]),[s,a]=i.useState([]),[r,n]=i.useState(!0),[o,l]=i.useState(new Set),[d,c]=i.useState(new Set),[m,u]=i.useState(null),[h,x]=i.useState([]),[p,g]=i.useState(!1),[f,b]=i.useState(null),v=i.useCallback(async()=>{n(!0);const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{data:s}=await ns.from("profiles").select("*").eq("id",e.id).single();s&&b(s);const{data:r}=await ns.from("connections").select("*").or(`requester_id.eq.${e.id},recipient_id.eq.${e.id}`),i=new Set,o=new Set,d=[];if(r&&r.forEach(t=>{const s=t.requester_id===e.id?t.recipient_id:t.requester_id;"accepted"===t.status?(i.add(s),d.push(s)):t.requester_id===e.id&&o.add(s)}),l(i),c(o),d.length>0){const{data:e}=await ns.from("profiles").select("*").in("id",d);e&&a(e)}else a([]);const m=new Set([e.id,...Array.from(i),...Array.from(o)]),{data:u}=await ns.from("profiles").select("*").order("created_at",{ascending:!1}).limit(500);if(u){const e=s?.university?.toLowerCase().trim(),a=$a(u.filter(e=>!m.has(e.id)));a.sort((t,s)=>{const a=t.university?.toLowerCase().trim(),r=s.university?.toLowerCase().trim(),n=e&&a===e?0:1,i=e&&r===e?0:1;return n!==i?n-i:(s.gold_verified?1:0)!=(t.gold_verified?1:0)?(s.gold_verified?1:0)-(t.gold_verified?1:0):(s.is_verified?1:0)!=(t.is_verified?1:0)?(s.is_verified?1:0)-(t.is_verified?1:0):0}),t(a)}n(!1)},[]);return i.useEffect(()=>{v()},[v]),{suggestions:e,myNetwork:s,loading:r,connections:o,sentRequests:d,connecting:m,connect:async e=>{u(e);const{data:{user:t}}=await ns.auth.getUser();if(t){c(t=>{const s=new Set(t);return s.add(e),s});const{error:s}=await ns.from("connections").insert({requester_id:t.id,recipient_id:e,status:"pending"});s&&(alert("Failed to send connection request. Please try again."),c(t=>{const s=new Set(t);return s.delete(e),s}))}u(null)},searchUsers:async t=>{if(!t.trim())return x([]),void g(!1);g(!0);const{data:{user:a}}=await ns.auth.getUser();if(a)try{const{data:r,error:n}=await ns.rpc("search_all_users",{current_user_id:a.id,search_query:t.trim()});if(n){const a=[...e,...s].filter(e=>(e.name||"").toLowerCase().includes(t.toLowerCase())||e.university&&e.university.toLowerCase().includes(t.toLowerCase())||e.headline&&e.headline.toLowerCase().includes(t.toLowerCase()));x(a)}else r&&x($a(r))}catch(r){x([])}finally{g(!1)}},searchResults:h,searching:p,userProfile:f}}(),[x,p]=i.useState("grow"),[g,f]=i.useState(""),[b,v]=i.useState("all");i.useEffect(()=>{const e=setTimeout(()=>{g.trim()&&c(g)},300);return()=>clearTimeout(e)},[g]);const w=(g.trim()?m:"grow"===x?t:s).filter(e=>"university"===b?!(!h?.university||!e.university)&&e.university.toLowerCase().trim()===h.university.toLowerCase().trim():"verified"!==b||(e.is_verified||e.gold_verified));return a?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-500"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"sticky top-0 bg-[#FAFAFA]/95 backdrop-blur-md z-30 pt-4 pb-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 font-display",children:"Your Network"}),e.jsx("p",{className:"text-slate-500",children:"Connect with students, alumni, and communities."})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:u?e.jsx(M,{className:"h-5 w-5 text-emerald-500 animate-spin"}):e.jsx(Q,{className:"h-5 w-5 text-stone-400 group-focus-within:text-emerald-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-11 pr-4 py-3 bg-white border border-stone-200/50 rounded-2xl text-stone-900 placeholder:text-stone-400 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500/50 shadow-sm transition-all",placeholder:"Search people...",value:g,onChange:e=>f(e.target.value)})]}),e.jsxs("div",{className:"flex p-1 bg-white border border-stone-200 rounded-xl w-full sm:w-fit overflow-x-auto",children:[e.jsxs("button",{onClick:()=>p("grow"),className:"flex-1 sm:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap flex items-center justify-center gap-2 "+("grow"===x?"bg-stone-900 text-white shadow-md":"text-stone-500 hover:text-stone-900 hover:bg-stone-50"),children:["Grow",t.length>0&&e.jsx("span",{className:"px-1.5 py-0.5 rounded-md text-[10px] "+("grow"===x?"bg-white/20 text-white":"bg-stone-100 text-stone-600"),children:t.length})]}),e.jsxs("button",{onClick:()=>p("network"),className:"flex-1 sm:flex-none px-6 py-2 rounded-lg text-sm font-bold transition-all flex items-center justify-center gap-2 whitespace-nowrap "+("network"===x?"bg-stone-900 text-white shadow-md":"text-stone-500 hover:text-stone-900 hover:bg-stone-50"),children:["My Network",e.jsx("span",{className:"px-1.5 py-0.5 rounded-md text-[10px] "+("network"===x?"bg-white/20 text-white":"bg-stone-100 text-stone-600"),children:s.length})]})]}),e.jsxs("div",{className:"flex overflow-x-auto pb-2 gap-2 scrollbar-hide snap-x -mx-4 px-4 sm:mx-0 sm:px-0",children:[e.jsx("button",{onClick:()=>v("all"),className:"px-4 py-1.5 rounded-full text-xs font-semibold border transition-all whitespace-nowrap flex-shrink-0 snap-start "+("all"===b?"bg-stone-900 text-white border-stone-900":"bg-white text-stone-600 border-stone-200 hover:bg-stone-50"),children:"All"}),h?.university&&e.jsxs("button",{onClick:()=>v("university"),className:"px-4 py-1.5 rounded-full text-xs font-semibold border transition-all flex items-center gap-1.5 whitespace-nowrap flex-shrink-0 snap-start "+("university"===b?"bg-stone-900 text-white border-stone-900":"bg-white text-stone-600 border-stone-200 hover:bg-stone-50"),children:[e.jsx(Z,{className:"w-3 h-3"})," ",h.university]}),e.jsxs("button",{onClick:()=>v("verified"),className:"px-4 py-1.5 rounded-full text-xs font-semibold border transition-all flex items-center gap-1.5 whitespace-nowrap flex-shrink-0 snap-start "+("verified"===b?"bg-stone-900 text-white border-stone-900":"bg-white text-stone-600 border-stone-200 hover:bg-stone-50"),children:[e.jsx(ee,{className:"w-3 h-3"})," Verified"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[w.map(t=>e.jsxs("div",{className:"bg-white p-5 rounded-3xl border border-stone-100 shadow-[0_2px_12px_rgba(0,0,0,0.03)] hover:shadow-[0_8px_24px_rgba(0,0,0,0.06)] transition-all flex items-center gap-4 group",children:[e.jsxs(d,{to:`/app/profile/${t.username||t.id}`,className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden bg-stone-100 ring-2 ring-white shadow-sm shrink-0",children:e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name||t.email?.split("@")[0]||"U")}&background=10b981&color=fff`,alt:t.name||"User",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"font-bold text-stone-900 truncate flex items-center gap-1",children:[t.name||t.email?.split("@")[0]||"New User",t.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50 shrink-0"}):t.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50 shrink-0"}):null]}),e.jsx("p",{className:"text-sm text-stone-500 truncate",children:"org"===t.role?"Organization":t.university||"Setting up profile…"}),e.jsx("p",{className:"text-xs text-stone-400 mt-0.5 capitalize",children:t.role||"student"})]})]}),"grow"===x?e.jsx("button",{onClick:()=>l(t.id),disabled:r.has(t.id)||n.has(t.id)||o===t.id,className:"p-2.5 rounded-xl transition-all shrink-0 "+(r.has(t.id)?"bg-emerald-50 text-emerald-600":n.has(t.id)?"bg-stone-100 text-stone-500 cursor-default":"bg-stone-900 text-white hover:bg-emerald-600 hover:shadow-lg hover:shadow-emerald-200"),children:r.has(t.id)?e.jsx(E,{className:"w-5 h-5"}):n.has(t.id)?e.jsx("span",{className:"text-xs font-semibold px-1",children:"Sent"}):o===t.id?e.jsx(M,{className:"w-5 h-5 animate-spin"}):e.jsx(te,{className:"w-5 h-5"})}):e.jsx(d,{to:`/app/messages?chat=${t.id}`,className:"p-2.5 rounded-xl bg-stone-50 text-stone-600 hover:bg-emerald-50 hover:text-emerald-600 transition-all shrink-0",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-message-circle",children:e.jsx("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})})})]},t.id)),0===w.length&&e.jsx("div",{className:"col-span-full text-center py-12",children:e.jsx("p",{className:"text-stone-400",children:g.trim()?"No users found for your search.":"grow"===x?"You’ve connected with everyone — impressive!":"You haven’t connected with anyone yet."})})]})]})}async function Ba(e,t){const s=e.map(e=>async function(e,t=1920,s=1080,a=.8){return new Promise((r,n)=>{const i=new FileReader;i.onload=e=>{const i=new Image;i.onload=()=>{let e=i.width,o=i.height;e>t&&(o=o*t/e,e=t),o>s&&(e=e*s/o,o=s);const l=document.createElement("canvas");l.width=e,l.height=o;const d=l.getContext("2d");d?(d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(i,0,0,e,o),l.toBlob(e=>{e?r(e):n(new Error("Failed to compress image"))},"image/jpeg",a)):n(new Error("Failed to get canvas context"))},i.onerror=()=>n(new Error("Failed to load image")),i.src=e.target?.result},i.onerror=()=>n(new Error("Failed to read file")),i.readAsDataURL(e)})}(e,t?.maxWidth,t?.maxHeight,t?.quality));return Promise.all(s)}function Ha({onCreate:t,communityId:s,user:a}){const[r,n]=i.useState(""),[o,l]=i.useState([]),[d,c]=i.useState(null),[m,u]=i.useState([]),[h,x]=i.useState(null),[p,g]=i.useState(!1),[f,b]=i.useState(!1),[v,w]=i.useState(["",""]),[j,y]=i.useState(!1),N=i.useRef(null),k=i.useRef(null),_=()=>{c(null),x(null),k.current&&(k.current.value="")};return e.jsx("div",{className:"bg-white/70 backdrop-blur-md rounded-[2rem] p-6 shadow-[0_8px_30px_rgb(0,0,0,0.04)] border border-white/50 transition-all hover:shadow-[0_8px_30px_rgb(0,0,0,0.08)]",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!r.trim()&&0===o.length&&!d&&!f)return;let a;if(f&&(a=v.filter(e=>e.trim()),a.length<2))alert("Poll must have at least 2 options.");else{g(!0);try{await t(r,o,d,s,a),n(""),l([]),u([]),N.current&&(N.current.value=""),_(),b(!1),w(["",""])}catch(i){alert("Failed to create post")}finally{g(!1)}}},className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-start",children:[a&&e.jsx("div",{className:"w-12 h-12 flex-shrink-0 bg-stone-100 overflow-hidden border-2 border-white shadow-sm "+("org"===a.role?"rounded-xl":"rounded-full"),children:e.jsx("img",{src:a.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.name)}&background=random`,alt:a.name,className:"w-full h-full "+("org"===a.role?"object-contain p-1":"object-cover")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("textarea",{className:"w-full bg-stone-50/50 rounded-2xl p-4 text-stone-700 placeholder:text-stone-400 focus:outline-none focus:ring-2 focus:ring-emerald-100 focus:bg-white transition-all resize-none text-lg font-medium",placeholder:"org"===a?.role?"Share an update with your contacts...":"What's on your mind? #Hashtags",rows:4,value:r,onChange:e=>{e.target.value.length<=1e3&&n(e.target.value)}}),e.jsxs("div",{className:"text-right text-xs text-stone-400 mt-1 mr-2 font-medium",children:[r.length,"/",1e3]})]})]}),!r&&e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-0.5 -mx-1 px-1",children:("org"===a?.role?[{label:"📣 Share an announcement",text:"Exciting news from us! "},{label:"💼 Post a job opening",text:"We're hiring! 🚀\n\nRole: \nLocation: \nHow to apply: "},{label:"🤝 Partnership update",text:"We're thrilled to partner with "},{label:"📊 Share a milestone",text:"We just hit "}]:[{label:"😂 Campus story",text:"This just happened on campus and I can't stop laughing 😂\n\n"},{label:"📚 Need study help",text:"Does anyone have good resources for "},{label:"🔥 Hot take",text:"Unpopular opinion: "},{label:"💼 Share an opportunity",text:"PSA: "},{label:"🎓 Advice for freshers",text:"Things I wish I knew before coming to uni:\n\n1. "},{label:"😤 Campus rant",text:"Can someone explain why "}]).map(t=>e.jsx("button",{type:"button",onClick:()=>n(t.text),className:"flex-shrink-0 text-xs px-3 py-1.5 rounded-full bg-stone-100 hover:bg-emerald-50 hover:text-emerald-700 text-stone-500 font-medium transition-all border border-transparent hover:border-emerald-200 whitespace-nowrap",children:t.label},t.label))}),m.length>0&&e.jsx("div",{className:"grid gap-2 "+(1===m.length?"grid-cols-1":"grid-cols-2"),children:m.map((t,s)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:t,alt:`Preview ${s}`,className:"w-full object-cover rounded-xl border border-stone-200 "+(1===m.length?"max-h-80":"h-40")}),e.jsx("button",{type:"button",onClick:()=>(e=>{l(t=>t.filter((t,s)=>s!==e)),u(t=>t.filter((t,s)=>s!==e))})(s),className:"absolute top-2 right-2 bg-black/50 text-white rounded-full p-1 hover:bg-black/70 transition-colors backdrop-blur-sm opacity-0 group-hover:opacity-100",children:e.jsx(D,{className:"w-3 h-3"})})]},s))}),h&&e.jsxs("div",{className:"relative group rounded-xl overflow-hidden bg-black/5",children:[e.jsx("video",{src:h,className:"w-full max-h-80 rounded-xl",controls:!0}),e.jsx("button",{type:"button",onClick:_,className:"absolute top-2 right-2 bg-black/50 text-white rounded-full p-1 hover:bg-black/70 transition-colors backdrop-blur-sm opacity-0 group-hover:opacity-100",children:e.jsx(D,{className:"w-3 h-3"})})]}),f&&e.jsxs("div",{className:"space-y-2 p-3 bg-stone-50 rounded-xl border border-stone-200",children:[v.map((t,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:e=>((e,t)=>{const s=[...v];s[e]=t,w(s)})(s,e.target.value),placeholder:`Option ${s+1}`,className:"flex-1 px-3 py-2 rounded-lg border border-stone-200 focus:outline-none focus:ring-1 focus:ring-emerald-500 text-sm"}),v.length>2&&e.jsx("button",{type:"button",onClick:()=>(e=>{v.length>2&&w(v.filter((t,s)=>s!==e))})(s),className:"p-2 text-red-400 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(se,{className:"w-4 h-4"})})]},s)),v.length<5&&e.jsxs("button",{type:"button",onClick:()=>{v.length<5&&w([...v,""])},className:"text-sm text-emerald-600 font-medium hover:underline flex items-center gap-1 pl-1",children:[e.jsx(ae,{className:"w-3 h-3"})," Add Option"]})]}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:N,className:"hidden",accept:"image/*",multiple:!0,onChange:async e=>{const t=e.target.files;if(t&&t.length>0){if(d)return alert("You cannot attach images and video to the same post."),void(N.current&&(N.current.value=""));const e=Array.from(t);if(o.length+e.length>4)return alert("You can only select up to 4 images."),void(N.current&&(N.current.value=""));const a=[],r=[];for(const t of e)t.size>10485760?alert(`Skipped ${t.name}: Image size must be less than 10MB.`):t.type.startsWith("image/")?a.push(t):alert(`Skipped ${t.name}: Not an image.`);if(0===a.length)return void(N.current&&(N.current.value=""));try{y(!0);const e=await Ba(a,{maxWidth:1920,maxHeight:1080,quality:.85}),t=[];for(let s=0;s<e.length;s++){const n=e[s],i=a[s],o=new File([n],i.name,{type:"image/jpeg"});t.push(o),r.push(URL.createObjectURL(n));Math.round((i.size-n.size)/i.size*100)}l(e=>[...e,...t]),u(e=>[...e,...r])}catch(s){alert("Failed to compress images. Please try again.")}finally{y(!1)}}N.current&&(N.current.value="")}}),e.jsx("input",{type:"file",ref:k,className:"hidden",accept:"video/*",onChange:e=>{const t=e.target.files?.[0];if(t){if(o.length>0)return alert("You cannot attach video and images to the same post."),void(k.current&&(k.current.value=""));if(t.size>52428800)return void alert("Video size must be less than 50MB.");if(!t.type.startsWith("video/"))return void alert("Invalid file type. Please select a video.");c(t),x(URL.createObjectURL(t))}k.current&&(k.current.value="")}}),e.jsx("button",{type:"button",onClick:()=>N.current?.click(),disabled:!!d||j,className:"p-2 rounded-xl transition-all "+(o.length>0?"text-emerald-600 bg-emerald-50":"text-stone-400 hover:text-emerald-500 hover:bg-emerald-50 disabled:opacity-30"),title:"Add Images",children:e.jsx(re,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:()=>k.current?.click(),disabled:o.length>0||j,className:"p-2 rounded-xl transition-all "+(d?"text-emerald-600 bg-emerald-50":"text-stone-400 hover:text-emerald-500 hover:bg-emerald-50 disabled:opacity-30"),title:"Add Video",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:()=>b(!f),disabled:j,className:"p-2 rounded-xl transition-all "+(f?"text-emerald-600 bg-emerald-50":"text-stone-400 hover:text-emerald-500 hover:bg-emerald-50"),title:"Create Poll",children:e.jsx(ie,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",className:"p-2 text-stone-400 hover:text-emerald-500 hover:bg-emerald-50 rounded-xl transition-all",children:e.jsx(oe,{className:"w-5 h-5"})}),j&&e.jsx("span",{className:"text-xs text-emerald-600 font-medium animate-pulse",children:"Compressing..."})]}),e.jsxs("button",{type:"submit",disabled:!r.trim()&&0===o.length&&!d&&!f||p,className:"bg-stone-900 text-white px-6 py-2.5 rounded-xl font-semibold text-sm hover:bg-emerald-600 hover:shadow-lg hover:shadow-emerald-200 transition-all disabled:opacity-50 disabled:hover:shadow-none flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),p?"Posting...":"Post"]})]}),p&&e.jsx("div",{className:"h-1 w-full bg-stone-100 mt-2 overflow-hidden rounded-full",children:e.jsx("div",{className:"h-full bg-emerald-500 animate-[progress_1s_ease-in-out_infinite]",style:{width:"100%"}})})]})})}function Wa(e){const t=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([a-zA-Z0-9_-]{11})/,/^([a-zA-Z0-9_-]{11})$/];for(const s of t){const t=e.match(s);if(t&&t[1])return t[1]}return null}function Ka(e,t="hq"){return`https://img.youtube.com/vi/${e}/${{default:"default",mq:"mqdefault",hq:"hqdefault",sd:"sddefault",maxres:"maxresdefault"}[t]}.jpg`}function Ya(e,t=!1){return`https://www.youtube.com/embed/${e}?${new URLSearchParams({rel:"0",modestbranding:"1",...t&&{autoplay:"1"}}).toString()}`}function Ga({id:t,embed:s,className:a=""}){return"youtube"===s.type?e.jsx("div",{id:t,className:`relative w-full pb-[56.25%] bg-slate-900 rounded-lg overflow-hidden ${a}`,children:e.jsx("iframe",{src:Ya(s.id,!1),className:"absolute top-0 left-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"YouTube video"})}):null}function Va(e){if(!e)return null;const t=Wa(e);return t?{type:"youtube",id:t,url:`https://www.youtube.com/watch?v=${t}`}:null}function Qa(e,t){return e&&t?e.replace(/https?:\/\/(www\.)?(youtube\.com\/watch\?v=|youtu\.be\/)[a-zA-Z0-9_-]{11}[^\s]*/g,"").trim():e}function Ja({post:t,isOpen:s,onClose:a,onRepost:r}){const[n,o]=i.useState(""),[l,d]=i.useState(!1);if(!s)return null;return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:a,children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full shadow-2xl animate-in fade-in zoom-in duration-200",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-stone-100",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-900",children:"Repost"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-stone-100 rounded-xl transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-stone-400"})})]}),e.jsx("div",{className:"p-6 space-y-4",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 mb-2",children:"Add your comment"}),e.jsx("textarea",{value:n,onChange:e=>o(e.target.value),placeholder:"What do you think about this?",className:"w-full px-4 py-3 border border-stone-200 rounded-xl focus:ring-2 focus:ring-green-500/20 focus:border-green-500 outline-none transition-all resize-none",rows:3,autoFocus:!0})]}),e.jsxs("div",{className:"border border-stone-200 rounded-xl p-4 bg-stone-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("img",{src:t.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.profiles?.name||"User")}`,alt:t.profiles?.name,className:"w-8 h-8 rounded-full"}),e.jsx("span",{className:"font-semibold text-sm text-stone-900",children:t.profiles?.name})]}),e.jsx("p",{className:"text-sm text-stone-600 line-clamp-3",children:t.content||""}),t.image_url&&e.jsx("img",{src:t.image_url,alt:"Post",className:"mt-2 rounded-lg w-full max-h-40 object-cover"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{d(!1),o("")},className:"flex-1 px-4 py-2.5 border border-stone-200 text-stone-600 font-semibold rounded-xl hover:bg-stone-50 transition-colors",children:"Back"}),e.jsx("button",{onClick:()=>{r(t,n),o(""),d(!1),a()},disabled:!n.trim(),className:"flex-1 px-4 py-2.5 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Repost"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{r(t),a()},className:"w-full p-4 flex items-center gap-3 hover:bg-green-50 rounded-xl transition-colors border border-stone-200 hover:border-green-200",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-xl",children:e.jsx(de,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"font-semibold text-stone-900",children:"Repost"}),e.jsx("p",{className:"text-sm text-stone-500",children:"Share instantly to your feed"})]})]}),e.jsxs("button",{onClick:()=>d(!0),className:"w-full p-4 flex items-center gap-3 hover:bg-blue-50 rounded-xl transition-colors border border-stone-200 hover:border-blue-200",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx(de,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"font-semibold text-stone-900",children:"Quote Repost"}),e.jsx("p",{className:"text-sm text-stone-500",children:"Add your thoughts before sharing"})]})]})]})})]})})}const Xa=q(e=>({playingId:null,setPlayingId:t=>e({playingId:t})}));function Za({src:t,id:s}){const a=i.useRef(null),{playingId:r,setPlayingId:n}=Xa();return i.useEffect(()=>{r&&r!==s&&a.current&&!a.current.paused&&a.current.pause()},[r,s]),i.useEffect(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.intersectionRatio>=.5?a.current&&a.current.paused&&a.current.play().then(()=>{n(s)}).catch(()=>{}):a.current&&!a.current.paused&&a.current.pause()})},{threshold:[0,.5,1]});return a.current&&e.observe(a.current),()=>{a.current&&e.unobserve(a.current)}},[s,n]),e.jsx("video",{ref:a,src:t,controls:!0,className:"w-full max-h-[500px]",preload:"metadata",playsInline:!0,onPlay:()=>n(s)})}function er(e){const t=new Date(e),s=new Date,a=Math.floor((s.getTime()-t.getTime())/1e3);if(a<60)return"Just now";const r=Math.floor(a/60);if(r<60)return`${r}m ago`;const n=Math.floor(r/60);if(n<24)return`${n}h ago`;const i=Math.floor(n/24);return i<7?`${i}d ago`:t.toLocaleDateString()}function tr({post:t,currentUserId:s,isActiveCommentSection:a,isActiveMenu:r,comments:n,loadingComments:o,onDelete:l,onLike:c,onRepost:m,onToggleComments:u,onToggleMenu:h,onPostComment:x,onSearchTag:p,onReport:g,onDeleteComment:f,onVotePoll:b,isInCommunityFeed:v=!1}){const[w,j]=i.useState(""),[y,N]=i.useState(!1),[k,C]=i.useState(null),[S,z]=i.useState(t.shared_to_feed||!1),[U,P]=i.useState(!1),[A,L]=i.useState(!1),[E,T]=i.useState([]),I=i.useRef(0),[O,R]=i.useState(!1);i.useEffect(()=>{const e=setTimeout(()=>R(!0),50);return()=>clearTimeout(e)},[]);const[F,$]=i.useState(0),[q,B]=i.useState(!1),{joinCommunity:H,joiningCommunity:K}=function(){const[e,t]=i.useState(null);return{joinCommunity:async e=>{t(e);try{const{data:{user:t}}=await ns.auth.getUser();if(!t)throw new Error("Not authenticated");const{error:s}=await ns.from("community_members").insert({community_id:e,user_id:t.id,role:"member"});if(s)throw s;return!0}catch(s){return!1}finally{t(null)}},leaveCommunity:async e=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)throw new Error("Not authenticated");const{error:s}=await ns.from("community_members").delete().match({community_id:e,user_id:t.id});if(s)throw s;return!0}catch(t){return!1}},checkMembership:async e=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return!1;const{data:s}=await ns.from("community_members").select("id").match({community_id:e,user_id:t.id}).single();return!!s}catch(t){return!1}},joiningCommunity:e}}(),Y=i.useMemo(()=>Va(t.content||""),[t.content]),G=i.useMemo(()=>Y?Qa(t.content||"",Y):t.content||"",[t.content,Y]),V=i.useMemo(()=>t.original_post?Va(t.original_post.content||""):null,[t.original_post]),Q=i.useMemo(()=>{if(!t.original_post)return"";const e=t.original_post.content||"";return V?Qa(e,V):e},[t.original_post,V]),J=async()=>{if(w.trim())try{await x(t.id,w),j("")}catch(e){alert("Failed to post comment")}},X=()=>{navigator.clipboard.writeText(`${window.location.origin}/app/post/${t.id}`),alert("Link copied to clipboard!")},[Z,se]=i.useState(!1),ae=G.length>280,re=Z||!ae?G:G.slice(0,280)+"...",ne=(t.likes_count||0)>=10,ie=(t.likes_count||0)>=25;return e.jsxs("article",{className:`bg-white dark:bg-zinc-900 border transition-all duration-300 rounded-2xl overflow-hidden ${ie?"border-orange-300/60 dark:border-orange-500/30 shadow-md shadow-orange-100/50 dark:shadow-orange-500/5":ne?"border-emerald-200/60 dark:border-emerald-700/30":"border-stone-200/80 dark:border-zinc-800 hover:border-stone-300 dark:hover:border-zinc-700"} ${O?"opacity-100 translate-y-0":"opacity-0 translate-y-2"}`,style:{transition:"opacity 0.35s ease, transform 0.35s ease, border-color 0.2s"},children:[(ne||ie)&&e.jsxs("div",{className:"flex items-center gap-1.5 px-4 py-1.5 text-xs font-bold "+(ie?"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-950/20 dark:to-red-950/20 text-orange-600 dark:text-orange-400":"bg-emerald-50/60 dark:bg-emerald-950/20 text-emerald-700 dark:text-emerald-400"),children:[e.jsx("span",{children:ie?"🔥":"⚡"}),e.jsx("span",{children:ie?"Trending on campus":"Popular post"})]}),t.is_repost&&t.profiles&&e.jsxs("div",{className:"flex items-center gap-2 px-4 pt-4 pb-2 text-sm text-stone-500 dark:text-zinc-500",children:[e.jsx(de,{className:"w-3.5 h-3.5 text-emerald-600 dark:text-emerald-500"}),e.jsx(d,{to:`/app/profile/${t.profiles?.username||t.author_id}`,className:"font-semibold text-stone-700 dark:text-zinc-300 hover:text-emerald-600 dark:hover:text-emerald-500 transition-colors",children:t.profiles.name}),e.jsx("span",{children:"reposted"})]}),t.community&&!v&&e.jsxs("div",{className:"flex items-center justify-between px-4 pt-3 pb-2 border-b border-stone-100 dark:border-zinc-800",children:[e.jsxs(d,{to:`/app/communities/${t.community.slug}`,className:"flex items-center gap-2 group",children:[t.community.icon_url?e.jsx("img",{src:t.community.icon_url,alt:t.community.name,className:"w-6 h-6 rounded-md object-cover"}):e.jsx("div",{className:"w-6 h-6 rounded-md bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:e.jsx(_,{className:"w-3.5 h-3.5 text-emerald-600 dark:text-emerald-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-stone-400 dark:text-zinc-500 leading-none",children:S||t.shared_to_feed?"Shared from":"Posted in"}),e.jsx("p",{className:"text-sm font-semibold text-stone-900 dark:text-zinc-100 group-hover:text-emerald-600 dark:group-hover:text-emerald-500 transition-colors",children:t.community.name})]})]}),!q&&s&&!S&&!t.shared_to_feed&&e.jsxs("button",{onClick:async e=>{if(e.preventDefault(),e.stopPropagation(),!t.community?.id)return;await H(t.community.id)&&B(!0)},disabled:K===t.community.id,className:"flex items-center gap-1.5 px-3 py-1.5 bg-emerald-600 hover:bg-emerald-700 disabled:bg-emerald-400 text-white text-sm font-semibold rounded-lg transition-colors",children:[K===t.community.id?e.jsx(M,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(te,{className:"w-3.5 h-3.5"}),"Join"]})]}),e.jsxs("div",{className:"flex justify-between items-start px-4 pt-3 pb-2",children:[e.jsxs(d,{to:`/app/profile/${t.profiles?.username||t.author_id}`,className:"flex items-center gap-3 group",children:[e.jsx("div",{className:`w-10 h-10 ${"org"===t.profiles?.role?"rounded-lg":"rounded-full"} overflow-hidden bg-gradient-to-br from-stone-100 to-stone-200 dark:from-zinc-800 dark:to-zinc-700`,children:e.jsx("img",{loading:"lazy",src:t.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.profiles?.name||"User")}&background=${"org"===t.profiles?.role?"f97316":"random"}`,alt:t.profiles?.name,className:`w-full h-full ${"org"===t.profiles?.role?"object-contain p-1.5":"object-cover"} transition-transform duration-300 group-hover:scale-105`})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-[15px] text-stone-900 dark:text-zinc-100 leading-tight flex items-center gap-1.5 group-hover:text-emerald-600 dark:group-hover:text-emerald-500 transition-colors",children:[t.profiles?.name,t.profiles?.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50"}),t.profiles?.is_verified&&!t.profiles?.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50 dark:fill-blue-950"})]}),e.jsxs("p",{className:"text-xs text-stone-500 dark:text-zinc-500 leading-tight mt-0.5",children:[t.profiles?.headline||("org"===t.profiles?.role?"Organization":t.profiles?.university)," • ",e.jsx("span",{className:"text-stone-400 dark:text-zinc-600",children:er(t.created_at)})]})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),h(t.id)},className:"text-stone-400 dark:text-zinc-600 hover:text-stone-600 dark:hover:text-zinc-400 transition-colors p-1.5 rounded-full hover:bg-stone-100 dark:hover:bg-zinc-800",children:e.jsx(ce,{className:"w-5 h-5"})}),r&&e.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 bg-white dark:bg-zinc-900 rounded-lg shadow-lg border border-stone-200 dark:border-zinc-800 py-1 z-50 animate-in fade-in zoom-in-95 duration-100",children:s===t.author_id?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:e=>{e.stopPropagation(),confirm("Are you sure you want to delete this post?")&&l(t.id)},className:"w-full text-left px-4 py-2.5 text-sm text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-950/30 font-medium transition-colors flex items-center gap-2.5",children:[e.jsx(me,{className:"w-4 h-4"}),"Delete Post"]}),t.community&&(S||t.shared_to_feed)&&e.jsxs("button",{onClick:e=>{h(t.id),(async e=>{if(e.stopPropagation(),!confirm("Remove this post from the main feed?"))return;const{error:s}=await ns.from("posts").update({shared_to_feed:!1}).eq("id",t.id);s||z(!1)})(e)},className:"w-full text-left px-4 py-2.5 text-sm text-orange-600 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-950/30 font-medium transition-colors flex items-center gap-2.5",children:[e.jsx(ue,{className:"w-4 h-4"}),"Unshare from feed"]}),e.jsxs("button",{onClick:e=>{e.stopPropagation(),X(),h(t.id)},className:"w-full text-left px-4 py-2.5 text-sm text-stone-700 dark:text-zinc-300 hover:bg-stone-50 dark:hover:bg-zinc-800 font-medium transition-colors flex items-center gap-2.5",children:[e.jsx(he,{className:"w-4 h-4"}),"Copy Link"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:e=>{e.stopPropagation(),X(),h(t.id)},className:"w-full text-left px-4 py-2.5 text-sm text-stone-700 dark:text-zinc-300 hover:bg-stone-50 dark:hover:bg-zinc-800 font-medium transition-colors flex items-center gap-2.5",children:[e.jsx(he,{className:"w-4 h-4"}),"Copy Link"]}),e.jsxs("button",{onClick:e=>{e.stopPropagation(),confirm("Report this post for inappropriate content?")&&g(t.id),h(t.id)},className:"w-full text-left px-4 py-2.5 text-sm text-orange-600 dark:text-orange-500 hover:bg-orange-50 dark:hover:bg-orange-950/30 font-medium transition-colors flex items-center gap-2.5",children:[e.jsx(xe,{className:"w-4 h-4"}),"Report Post"]})]})})]})]}),e.jsxs("div",{className:"px-4 py-2 text-stone-900 dark:text-zinc-100 leading-[1.5] text-[15px] whitespace-pre-wrap break-words",children:[(t=>{const s=/(https?:\/\/[^\s]+)/gi,a=/([#@][a-z0-9_]+)/gi;return t.split(s).map((t,r)=>t.match(s)?e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-emerald-600 dark:text-emerald-500 font-medium hover:underline break-all",onClick:e=>e.stopPropagation(),children:t},r):t.split(a).map((t,s)=>{if(t.match(/^#[a-z0-9_]+$/i))return e.jsx("span",{className:"text-emerald-600 dark:text-emerald-500 font-bold cursor-pointer hover:underline",onClick:e=>{e.stopPropagation(),p(t),window.scrollTo({top:0,behavior:"smooth"})},children:t},`${r}-${s}`);if(t.match(/^@[a-z0-9_]+$/i)){const a=t.substring(1);return e.jsx(d,{to:`/app/profile/${a}`,className:"text-blue-600 dark:text-blue-500 font-bold hover:underline",onClick:e=>e.stopPropagation(),children:t},`${r}-${s}`)}return e.jsx("span",{children:t},`${r}-${s}`)}))})(re),ae&&e.jsx("button",{onClick:()=>se(!Z),className:"text-stone-500 dark:text-zinc-500 text-sm font-medium hover:text-stone-700 dark:hover:text-zinc-300 ml-1",children:Z?"less":"more"})]}),t.is_repost&&t.original_post&&e.jsxs("div",{className:"mb-4 border-2 border-stone-200 rounded-2xl p-4 bg-stone-50/50",children:[e.jsxs(d,{to:`/app/profile/${t.original_post.profiles?.username||t.original_post.author_id}`,className:"flex items-center gap-3 mb-3",children:[e.jsx("img",{loading:"lazy",src:t.original_post.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.original_post.profiles?.name||"User")}`,alt:t.original_post.profiles?.name,className:"w-10 h-10 rounded-xl object-cover"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-stone-900",children:t.original_post.profiles?.name}),t.original_post.profiles?.is_verified&&e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-current"})]}),e.jsx("span",{className:"text-xs text-stone-500",children:er(t.original_post.created_at)})]})]}),e.jsx("p",{className:"text-stone-700 text-sm leading-relaxed mb-3",children:Q}),V&&e.jsx("div",{className:"mb-3",children:e.jsx(Ga,{id:`${t.original_post.id}-original-embed`,embed:V,originalUrl:(t.original_post.content||"").match(/https?:\/\/[^\s]+/)?.[0],defaultMuted:!0})}),t.original_post.video_url&&e.jsx("div",{className:"mb-3 rounded-xl overflow-hidden bg-black",children:e.jsx(Za,{src:t.original_post.video_url,id:`${t.original_post.id}-original-video`})}),t.original_post.image_url&&e.jsx("img",{loading:"lazy",src:t.original_post.image_url,alt:"Original post",className:"rounded-xl w-full object-cover max-h-80"})]}),Y&&e.jsx("div",{className:"-mx-0 my-3",children:e.jsx(Ga,{id:`${t.id}-embed`,embed:Y,originalUrl:(t.content||"").match(/https?:\/\/[^\s]+/)?.[0],defaultMuted:!1})}),t.poll_options&&t.poll_options.length>0&&e.jsxs("div",{className:"px-4 pb-3 space-y-2",children:[t.poll_options.map((s,a)=>{const r=t.poll_counts||[],n=r[a]||0,i=r.reduce((e,t)=>e+t,0),o=i>0?Math.round(n/i*100):0,l=t.user_vote===a;return e.jsxs("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),b&&b(t.id,a)},className:"w-full relative overflow-hidden rounded-xl border transition-all "+(l?"border-emerald-500 bg-emerald-50/30":"border-stone-200 bg-white hover:bg-stone-50"),children:[e.jsx("div",{className:"absolute inset-y-0 left-0 transition-all duration-500 "+(l?"bg-emerald-100":"bg-stone-100"),style:{width:`${o}%`,opacity:.5}}),e.jsxs("div",{className:"relative px-4 py-3 flex justify-between items-center z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx(ee,{className:"w-4 h-4 text-emerald-600 fill-emerald-100"}),e.jsx("span",{className:"font-medium "+(l?"text-emerald-900":"text-stone-700"),children:s})]}),e.jsxs("span",{className:"text-sm font-bold "+(l?"text-emerald-700":"text-stone-500"),children:[o,"%"]})]})]},a)}),e.jsxs("p",{className:"text-xs text-stone-400 pl-1",children:[(t.poll_counts||[]).reduce((e,t)=>e+t,0)," votes"]})]}),(()=>{const s=t.image_urls?.length?t.image_urls:t.image_url?[t.image_url]:[];return 0===s.length?null:e.jsx("div",{className:"border-y border-stone-200/80 dark:border-zinc-800 my-3 bg-black grid gap-px "+(s.length>1?"grid-cols-2":"grid-cols-1"),children:s.map((t,a)=>e.jsx("div",{className:"relative overflow-hidden cursor-pointer active:opacity-90 transition-opacity "+(3===s.length&&0===a?"col-span-2":""),onClick:()=>{C(t),$(a)},children:e.jsx("img",{loading:"lazy",src:t,alt:"Post content",className:"w-full object-cover bg-stone-900 "+(s.length>1?"h-64 md:h-80":"max-h-[600px]")})},a))})})(),t.video_url&&e.jsx("div",{className:"border-y border-stone-200/80 dark:border-zinc-800 my-3 bg-black",children:e.jsx(Za,{src:t.video_url,id:`${t.id}-video`})}),e.jsxs("div",{className:"flex items-center gap-1 px-4 py-2",children:[e.jsxs("button",{onClick:e=>{if(e.preventDefault(),e.stopPropagation(),L(!1),requestAnimationFrame(()=>requestAnimationFrame(()=>L(!0))),!t.user_has_liked){const e=Array.from({length:6},(e,t)=>({id:10*++I.current+t,x:40*Math.random()-20,y:-40*Math.random()-10}));T(e),setTimeout(()=>T([]),700)}c(t)},className:"flex items-center gap-1.5 group transition-colors p-2 -ml-2 relative",children:[E.map(t=>e.jsx("span",{className:"absolute w-1.5 h-1.5 rounded-full bg-red-400 pointer-events-none",style:{left:"50%",top:"50%",animation:"particleBurst 0.6s ease-out forwards","--tx":`${t.x}px`,"--ty":`${t.y}px`}},t.id)),e.jsx(pe,{className:`w-6 h-6 transition-all ${A?"scale-125":"scale-100"} ${t.user_has_liked?"fill-red-500 text-red-500":"text-stone-900 dark:text-zinc-100 hover:text-red-400"}`,style:{transition:A?"transform 0.15s cubic-bezier(0.34,1.56,0.64,1)":"transform 0.2s ease"}}),(t.likes_count||0)>0&&e.jsx("span",{className:"text-sm font-medium tabular-nums "+(t.user_has_liked?"text-red-500":"text-stone-600 dark:text-zinc-400"),children:t.likes_count})]}),e.jsxs("button",{onClick:()=>u(t.id),className:"flex items-center gap-1.5 group transition-colors p-2 text-stone-500 dark:text-zinc-400 hover:text-stone-900 dark:hover:text-zinc-100",children:[e.jsx(W,{className:"w-6 h-6 transition-all group-hover:scale-110"}),(t.comments_count||0)>0?e.jsx("span",{className:"text-sm font-medium text-stone-600 dark:text-zinc-400",children:t.comments_count}):e.jsx("span",{className:"text-xs text-stone-400 dark:text-zinc-600 hidden group-hover:inline transition-all",children:"Reply"})]}),e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-1.5 group transition-colors p-2",children:[e.jsx(de,{className:"w-6 h-6 transition-all active:scale-90 "+(t.user_has_reposted?"text-emerald-600 dark:text-emerald-500":"text-stone-900 dark:text-zinc-100 hover:text-stone-600 dark:hover:text-zinc-400")}),(t.reposts_count||0)>0&&e.jsx("span",{className:"text-sm font-medium "+(t.user_has_reposted?"text-emerald-600 dark:text-emerald-500":"text-stone-600 dark:text-zinc-400"),children:t.reposts_count})]}),e.jsx("button",{onClick:X,className:"flex items-center group transition-colors p-2 ml-auto text-stone-900 dark:text-zinc-100 hover:text-stone-600 dark:hover:text-zinc-400",children:e.jsx(he,{className:"w-[22px] h-[22px] transition-all active:scale-90"})}),t.community&&t.author_id===s&&e.jsxs("button",{onClick:async e=>{if(e.stopPropagation(),U||S)return;P(!0);const{error:s}=await ns.from("posts").update({shared_to_feed:!0}).eq("id",t.id);s||z(!0),P(!1)},disabled:U||S,title:S?"Already shared to main feed":"Share this post to the main feed",className:"flex items-center gap-1 px-2.5 py-1 rounded-lg text-xs font-semibold transition-all "+(S?"text-emerald-600 dark:text-emerald-500 bg-emerald-50 dark:bg-emerald-950/30 cursor-default":"text-stone-500 dark:text-zinc-400 hover:text-stone-900 dark:hover:text-zinc-100 hover:bg-stone-100 dark:hover:bg-zinc-800"),children:[U?e.jsx(M,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ue,{className:"w-3.5 h-3.5"}),S?"Shared to feed":"Share to feed"]})]}),a&&e.jsxs("div",{className:"hidden md:block mt-4 pt-4 border-t border-dashed border-stone-100 dark:border-zinc-800 px-4 pb-4 animate-in slide-in-from-top-2",children:[e.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto pr-1 custom-scrollbar",children:o?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(M,{className:"w-5 h-5 animate-spin text-stone-300"})}):0===n.length?e.jsx("p",{className:"text-center text-xs text-stone-400 py-2",children:"No comments yet. Be the first!"}):n.map(a=>e.jsxs("div",{className:"flex gap-3 text-sm group",children:[e.jsx("img",{src:a.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.profiles?.name||"User")}&background=random`,className:"w-8 h-8 rounded-full bg-stone-100 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"bg-stone-50 dark:bg-zinc-800 rounded-2xl rounded-tl-sm p-3 px-4 flex-1 relative group-hover:bg-stone-100 dark:group-hover:bg-zinc-700 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(d,{to:`/app/profile/${a.profiles?.username||a.author_id}`,className:"font-bold text-stone-900 dark:text-zinc-100 text-xs mb-1 hover:underline",children:a.profiles?.name}),s===a.author_id&&e.jsx("button",{onClick:()=>{confirm("Delete this comment?")&&f(t.id,a.id)},className:"text-stone-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity p-1",children:e.jsx(me,{className:"w-3.5 h-3.5"})})]}),e.jsx("p",{className:"text-stone-600 dark:text-zinc-400 leading-relaxed text-sm",children:a.content})]})]},a.id))}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("input",{type:"text",placeholder:"Write a comment...",className:"flex-1 bg-white dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-xl px-4 py-2.5 text-sm focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-100 dark:focus:ring-emerald-900 transition-all",value:w,onChange:e=>j(e.target.value),onKeyDown:e=>"Enter"===e.key&&J()}),e.jsx("button",{onClick:J,disabled:!w.trim(),className:"p-2.5 bg-stone-900 dark:bg-zinc-100 text-white dark:text-zinc-900 rounded-xl hover:bg-emerald-600 disabled:opacity-50 transition-colors",children:e.jsx(le,{className:"w-4 h-4"})})]})]}),a&&e.jsxs("div",{className:"md:hidden fixed inset-0 z-50 flex flex-col justify-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>u(t.id)}),e.jsxs("div",{className:"relative bg-white dark:bg-zinc-900 rounded-t-3xl flex flex-col max-h-[80vh] animate-in slide-in-from-bottom duration-300 shadow-2xl",children:[e.jsxs("div",{className:"flex flex-col items-center pt-3 pb-2 flex-shrink-0",children:[e.jsx("div",{className:"w-10 h-1 bg-stone-200 dark:bg-zinc-700 rounded-full mb-3"}),e.jsxs("div",{className:"flex items-center justify-between w-full px-5 pb-2 border-b border-stone-100 dark:border-zinc-800",children:[e.jsx("h3",{className:"font-bold text-base text-stone-900 dark:text-zinc-100",children:"Comments"}),e.jsx("button",{onClick:()=>u(t.id),className:"p-1.5 rounded-full hover:bg-stone-100 dark:hover:bg-zinc-800 transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-stone-500"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-3",children:o?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(M,{className:"w-6 h-6 animate-spin text-stone-300"})}):0===n.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-stone-400",children:[e.jsx(W,{className:"w-10 h-10 mb-3 opacity-30"}),e.jsx("p",{className:"text-sm",children:"No comments yet. Be the first!"})]}):n.map(a=>e.jsxs("div",{className:"flex gap-3 text-sm group",children:[e.jsx("img",{src:a.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.profiles?.name||"User")}&background=random`,className:"w-9 h-9 rounded-full bg-stone-100 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"bg-stone-50 dark:bg-zinc-800 rounded-2xl rounded-tl-sm p-3 px-4 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(d,{to:`/app/profile/${a.profiles?.username||a.author_id}`,className:"font-bold text-stone-900 dark:text-zinc-100 text-xs mb-1 hover:underline",children:a.profiles?.name}),s===a.author_id&&e.jsx("button",{onClick:()=>{confirm("Delete this comment?")&&f(t.id,a.id)},className:"text-stone-400 hover:text-red-500 p-1",children:e.jsx(me,{className:"w-3.5 h-3.5"})})]}),e.jsx("p",{className:"text-stone-600 dark:text-zinc-400 leading-relaxed",children:a.content})]})]},a.id))}),e.jsxs("div",{className:"flex gap-3 items-center px-4 py-3 border-t border-stone-100 dark:border-zinc-800 flex-shrink-0 pb-safe",children:[e.jsx("input",{type:"text",placeholder:"Write a comment...",className:"flex-1 bg-stone-100 dark:bg-zinc-800 border-0 rounded-2xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 transition-all",value:w,onChange:e=>j(e.target.value),onKeyDown:e=>"Enter"===e.key&&J(),autoFocus:!0}),e.jsx("button",{onClick:J,disabled:!w.trim(),className:"p-3 bg-emerald-600 text-white rounded-full hover:bg-emerald-700 disabled:opacity-40 transition-colors flex-shrink-0",children:e.jsx(le,{className:"w-4 h-4"})})]})]})]}),e.jsx(Ja,{post:t,isOpen:y,onClose:()=>N(!1),onRepost:(e,t)=>{m(e,t)}}),k&&(()=>{const s=t.image_urls?.length?t.image_urls:t.image_url?[t.image_url]:[];return e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/95 flex items-center justify-center",onClick:()=>C(null),children:[e.jsx("button",{onClick:()=>C(null),className:"absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors z-10",children:e.jsx(D,{className:"w-6 h-6 text-white"})}),s.length>1&&e.jsx("button",{onClick:e=>{e.stopPropagation(),$(e=>e>0?e-1:s.length-1),C(s[F>0?F-1:s.length-1])},className:"absolute left-4 p-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors z-10",children:e.jsx(ge,{className:"w-8 h-8 text-white"})}),e.jsx("img",{src:k,alt:"Fullscreen view",className:"max-w-[90vw] max-h-[90vh] object-contain",onClick:e=>e.stopPropagation()}),s.length>1&&e.jsx("button",{onClick:e=>{e.stopPropagation(),$(e=>e<s.length-1?e+1:0),C(s[F<s.length-1?F+1:0])},className:"absolute right-4 p-3 bg-white/10 hover:bg-white/20 rounded-full transition-colors z-10",children:e.jsx(fe,{className:"w-8 h-8 text-white"})}),s.length>1&&e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:[F+1," / ",s.length]})]})})()]})}function sr(){const[t,s]=i.useState([]),[a,r]=i.useState(!0),[n,o]=i.useState(0),[l,c]=i.useState(!1);i.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{data:t}=await ns.from("profiles").select("university").eq("id",e.id).single(),{data:a}=await ns.from("connections").select("requester_id, recipient_id").or(`requester_id.eq.${e.id},recipient_id.eq.${e.id}`).in("status",["accepted","pending"]),r=new Set(a?.flatMap(e=>[e.requester_id,e.recipient_id])||[]);r.add(e.id);const{data:n}=await ns.from("profiles").select("id, name, username, avatar_url, university, headline, is_verified").eq("university",t?.university).not("id","in",`(${Array.from(r).join(",")})`).limit(10);if(n){const e=n.sort(()=>Math.random()-.5);s(e.slice(0,5))}}catch(e){}finally{r(!1)}};if(a||0===t.length||l)return null;const u=t[n];return e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 rounded-2xl p-6 border border-emerald-100 shadow-sm relative overflow-hidden",children:[e.jsx("button",{onClick:()=>c(!0),className:"absolute top-3 right-3 p-1.5 text-slate-400 hover:text-slate-600 hover:bg-white/50 rounded-full transition-colors z-10",children:e.jsx(D,{className:"w-4 h-4"})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"font-bold text-slate-900 text-lg flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-emerald-600"}),"People You May Know"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"From your university"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-100",children:[e.jsx(d,{to:`/app/profile/${u.username||u.id}`,className:"block",children:e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("img",{src:u.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(u.name)}&background=10b981&color=fff`,alt:u.name,className:"w-12 h-12 rounded-full object-cover border-2 border-emerald-100"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"font-bold text-slate-900 truncate flex items-center gap-1",children:[u.name,u.is_verified&&e.jsx("svg",{className:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:u.headline||u.university})]})]})}),e.jsxs("button",{onClick:()=>(async e=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;await ns.from("connections").insert({requester_id:t.id,recipient_id:e,status:"pending"}),s(t=>t.filter(t=>t.id!==e))}catch(t){}})(u.id),className:"w-full py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-semibold text-sm transition-colors flex items-center justify-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Connect"]})]}),t.length>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("button",{onClick:()=>{o(e=>(e-1+t.length)%t.length)},className:"p-2 hover:bg-white/50 rounded-full transition-colors",disabled:1===t.length,children:e.jsx(ge,{className:"w-5 h-5 text-slate-600"})}),e.jsx("div",{className:"flex gap-1.5",children:t.map((t,s)=>e.jsx("button",{onClick:()=>o(s),className:"h-1.5 rounded-full transition-all "+(s===n?"w-6 bg-emerald-600":"w-1.5 bg-slate-300 hover:bg-slate-400")},s))}),e.jsx("button",{onClick:()=>{o(e=>(e+1)%t.length)},className:"p-2 hover:bg-white/50 rounded-full transition-colors",disabled:1===t.length,children:e.jsx(fe,{className:"w-5 h-5 text-slate-600"})})]})]})]})}const ar={morning:{emoji:"☀️",msg:"Start your day strong — see what's happening on campus!"},afternoon:{emoji:"🚀",msg:"Midday check-in! Catch up on what you've missed."},evening:{emoji:"🌆",msg:"Wind down, connect, and share your day."},night:{emoji:"🌙",msg:"Night owl mode. The campus never sleeps!"}};function rr({userName:t}){const[s,a]=i.useState(!1),[r,n]=i.useState(!1),[o,l]=i.useState(1),[d,c]=i.useState(!1);i.useEffect(()=>{const e=localStorage.getItem("welcomeMessageDismissed2"),t=(new Date).toDateString(),s=function(){const e=localStorage.getItem("ulink_streak");if(!e)return 1;const{streak:t,lastDate:s}=JSON.parse(e),a=(new Date).toDateString(),r=new Date(Date.now()-864e5).toDateString();return s===a?t:s===r?t+1:1}();l(s),function(e){localStorage.setItem("ulink_streak",JSON.stringify({streak:e,lastDate:(new Date).toDateString()}))}(s),e!==t?setTimeout(()=>{a(!0),setTimeout(()=>c(!0),700)},400):n(!0)},[]);if(r)return null;const m=function(){const e=(new Date).getHours();return e>=5&&e<12?"morning":e>=12&&e<17?"afternoon":e>=17&&e<21?"evening":"night"}(),{emoji:u,msg:h}=ar[m],x=Math.min(100,o%7*14+14),p=7-o%7;return e.jsxs("div",{className:`relative overflow-hidden rounded-2xl border transition-all duration-500 ${s?"opacity-100 translate-y-0":"opacity-0 -translate-y-3"} bg-gradient-to-br from-emerald-600 via-emerald-700 to-teal-800 border-emerald-500/30 shadow-lg shadow-emerald-500/10`,children:[e.jsx("div",{className:"absolute -top-6 -right-6 w-32 h-32 bg-white/5 rounded-full blur-2xl pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-8 -left-4 w-24 h-24 bg-teal-400/10 rounded-full blur-2xl pointer-events-none"}),e.jsxs("div",{className:"relative p-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-emerald-200 text-xs font-semibold uppercase tracking-widest mb-1",children:[u," ",m.charAt(0).toUpperCase()+m.slice(1)]}),e.jsxs("h2",{className:"text-white text-lg font-bold leading-tight",children:["Hey, ",t,"! 👋"]}),e.jsx("p",{className:"text-emerald-100/80 text-sm mt-0.5 leading-relaxed",children:h})]}),e.jsx("button",{onClick:()=>{a(!1),setTimeout(()=>{n(!0),localStorage.setItem("welcomeMessageDismissed2",(new Date).toDateString())},300)},className:"p-1.5 hover:bg-white/10 rounded-lg transition-colors flex-shrink-0 mt-0.5","aria-label":"Dismiss",children:e.jsx(D,{className:"w-4 h-4 text-emerald-200/60"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-xl px-3 py-2 border border-white/10 transition-all duration-500 "+(d?"scale-100":"scale-90 opacity-0"),children:[e.jsx(be,{className:"w-4 h-4 text-orange-400 "+(o>=3?"animate-pulse":"")}),e.jsx("span",{className:"text-white font-bold text-sm",children:o}),e.jsx("span",{className:"text-emerald-200/70 text-xs",children:"day streak"})]}),e.jsxs("div",{className:"flex-1 transition-all duration-700 "+(d?"opacity-100":"opacity-0"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3 text-yellow-400"}),e.jsx("span",{className:"text-emerald-200/80 text-xs font-medium",children:"Weekly XP"})]}),e.jsxs("span",{className:"text-white text-xs font-bold",children:[p,"d to milestone"]})]}),e.jsx("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-orange-400 rounded-full transition-all duration-1000 ease-out",style:{width:d?`${x}%`:"0%"}})})]}),e.jsxs("div",{className:"flex items-center gap-1.5 bg-white/10 backdrop-blur-sm rounded-xl px-2.5 py-2 border border-white/10 transition-all duration-500 delay-200 "+(d?"scale-100 opacity-100":"scale-90 opacity-0"),children:[e.jsx(P,{className:"w-4 h-4 text-emerald-300"}),e.jsx("span",{className:"text-white text-xs font-semibold",children:"Active"})]})]})]})]})}function nr({onCreatePost:t}){return e.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-white rounded-3xl p-8 md:p-12 border border-emerald-100 shadow-sm",children:e.jsxs("div",{className:"max-w-2xl mx-auto text-center space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"text-6xl",children:"👋"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-slate-900 mb-3",children:"Welcome to Your Feed!"}),e.jsx("p",{className:"text-lg text-slate-600 leading-relaxed",children:"Your feed is looking a bit quiet. Let's get you started on your UniLink journey."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:[e.jsxs("button",{onClick:t,className:"bg-white p-6 rounded-2xl border border-slate-200 hover:border-emerald-300 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:"text-3xl mb-3",children:"✍️"}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:"Share Your First Post"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Tell the community what you're up to"})]}),e.jsxs(d,{to:"/app/network",className:"bg-white p-6 rounded-2xl border border-slate-200 hover:border-emerald-300 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:"text-3xl mb-3",children:"🤝"}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:"Connect with Students"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Build your professional network"})]}),e.jsxs(d,{to:"/app/jobs",className:"bg-white p-6 rounded-2xl border border-slate-200 hover:border-emerald-300 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:"text-3xl mb-3",children:"💼"}),e.jsx("h3",{className:"font-bold text-slate-900 mb-1",children:"Explore Opportunities"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Find internships and jobs"})]})]}),e.jsxs("div",{className:"bg-white/60 backdrop-blur-sm rounded-2xl p-6 border border-emerald-100/50",children:[e.jsxs("h4",{className:"font-bold text-slate-900 mb-3 flex items-center justify-center gap-2",children:[e.jsx("span",{children:"💡"}),"Quick Tips to Get Started"]}),e.jsxs("ul",{className:"text-sm text-slate-600 space-y-2 text-left max-w-md mx-auto",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-600 font-bold mt-0.5",children:"•"}),e.jsx("span",{children:"Complete your profile to help others find and connect with you"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-600 font-bold mt-0.5",children:"•"}),e.jsx("span",{children:"Share your thoughts, projects, or questions to engage the community"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-600 font-bold mt-0.5",children:"•"}),e.jsx("span",{children:"Use hashtags like #TechNigeria or #StudentLife to reach more people"})]})]})]})]})})}function ir(){return e.jsxs("div",{className:"bg-white rounded-[2rem] p-6 shadow-[0_2px_20px_rgb(0,0,0,0.04)] border border-stone-100 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-stone-200 rounded-2xl"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-stone-200 rounded-lg w-32 mb-2"}),e.jsx("div",{className:"h-3 bg-stone-100 rounded-lg w-24"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"h-3 bg-stone-200 rounded-lg w-full"}),e.jsx("div",{className:"h-3 bg-stone-200 rounded-lg w-5/6"}),e.jsx("div",{className:"h-3 bg-stone-200 rounded-lg w-4/6"})]}),e.jsx("div",{className:"h-64 bg-stone-100 rounded-2xl mb-4"}),e.jsxs("div",{className:"flex items-center gap-6 pt-4 border-t border-stone-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-stone-200 rounded-xl"}),e.jsx("div",{className:"h-3 bg-stone-100 rounded w-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-stone-200 rounded-xl"}),e.jsx("div",{className:"h-3 bg-stone-100 rounded w-8"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-stone-200 rounded-xl"}),e.jsx("div",{className:"h-3 bg-stone-100 rounded w-8"})]})]})]})}function or(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ir,{}),e.jsx(ir,{}),e.jsx(ir,{})]})}const lr=q((e,t)=>({posts:[],lastFetched:0,setPosts:t=>e({posts:t,lastFetched:Date.now()}),addPost:t=>e(e=>({posts:[t,...e.posts]})),updatePost:t=>e(e=>({posts:e.posts.map(e=>e.id===t.id?t:e)})),removePost:t=>e(e=>({posts:e.posts.filter(e=>e.id!==t)})),needsRefresh:()=>Date.now()-t().lastFetched>3e5}));async function dr(e,t,s,a){const r=function(e){const t=/@(\w+)/g,s=[];let a;for(;null!==(a=t.exec(e));)s.push(a[1]);return s}(e);if(0!==r.length)try{const{data:e}=await ns.from("profiles").select("id").in("username",r).neq("id",s);if(!e||0===e.length)return;const n=e.map(e=>({user_id:e.id,type:"mention",sender_id:s,post_id:"post"===a?t:null,comment_id:"comment"===a?t:null,created_at:(new Date).toISOString()}));await ns.from("notifications").insert(n)}catch(n){}}const cr=new Set(["chidi_okonkwo","amara_writes","tunde_codes","ngozi_builders","emekatech","fatima_finance","davidosei_art","blessings_med","ibrahim_econ","adaeze_fashion","seun_sports","chisom_biz"]),mr=new Set(["chidiokonkwo@gmail.com","amaraeze@gmail.com","tundeadeyemi@gmail.com","ngoziobi@gmail.com","emekanwosu@gmail.com","fatimabello@gmail.com","davidosei@gmail.com","blessingpeter@gmail.com","ibrahimmusa@gmail.com","adaezenwofor@gmail.com","seunadesanya@gmail.com","chisomokeke@gmail.com"]),ur=e=>cr.has(e.profiles?.username)||mr.has(e.profiles?.email);function hr(e){const{posts:t,setPosts:s,addPost:a,updatePost:r,removePost:n}=lr(),[o,l]=i.useState(!0),[d,c]=i.useState(null),[m,u]=i.useState(null),[h,x]=i.useState(null),[p,g]=i.useState({}),[f,b]=i.useState(!1);i.useEffect(()=>{(async()=>{const{data:{user:e}}=await ns.auth.getUser();e&&(u(e.id),ns.from("profiles").select("*").eq("id",e.id).single().then(({data:e})=>{e&&c(e)})),await v(e?.id)})();const t=ns.channel("public:posts").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},t=>{const s=t.new;if(e){if(s.community_id!==e)return}else if(s.community_id&&!s.shared_to_feed)return;w(s.id)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"posts"},e=>{n(e.old.id)}).on("postgres_changes",{event:"*",schema:"public",table:"likes"},e=>{const t=e.new?.post_id||e.old?.post_id;t&&w(t)}).on("postgres_changes",{event:"*",schema:"public",table:"comments"},e=>{const t=e.new?.post_id||e.old?.post_id;t&&w(t)}).subscribe();return()=>{ns.removeChannel(t)}},[e]);const v=async t=>{l(!0);let a=ns.from("posts").select("\n                *,\n                profiles:author_id (\n                    id,\n                    name,\n                    username,\n                    avatar_url,\n                    is_verified,\n                    gold_verified,\n                    headline,\n                    role,\n                    email\n                ),\n                community:community_id (\n                    id,\n                    name,\n                    slug,\n                    icon_url\n                )\n            ").order("created_at",{ascending:!1}).limit(60);a=e?a.eq("community_id",e):a.or("community_id.is.null,shared_to_feed.eq.true");let{data:r,error:n}=await a;if(n){const t=e?await ns.from("posts").select("*, profiles:author_id (id, name, username, avatar_url, is_verified, headline, role, email), community:community_id (id, name, slug, icon_url)").eq("community_id",e).order("created_at",{ascending:!1}).limit(20):await ns.from("posts").select("*, profiles:author_id (id, name, username, avatar_url, is_verified, headline, role, email), community:community_id (id, name, slug, icon_url)").or("community_id.is.null,shared_to_feed.eq.true").order("created_at",{ascending:!1}).limit(20);if(t.error)return void l(!1);r=t.data,n=null}if(!n&&r){const e=["oyasordaniel@gmail.com","akeledivine1@gmail.com"],a=r.map(e=>e.id),n=ns.from("likes").select("post_id, user_id").in("post_id",a),i=ns.from("comments").select("post_id").in("post_id",a),o=ns.from("posts").select("original_post_id").in("original_post_id",a).eq("is_repost",!0);let l=Promise.resolve({data:null});t&&(l=ns.from("poll_votes").select("post_id, option_index").eq("user_id",t).in("post_id",a));const[d,c,m,u]=await Promise.all([n,i,o,l]),h={},x={},p={},g={};d.data&&d.data.forEach(e=>{h[e.post_id]||(h[e.post_id]={count:0,userLiked:!1}),h[e.post_id].count++,t&&e.user_id===t&&(h[e.post_id].userLiked=!0)}),c.data&&c.data.forEach(e=>{x[e.post_id]=(x[e.post_id]||0)+1}),m.data&&m.data.forEach(e=>{p[e.original_post_id]||(p[e.original_post_id]={count:0,userReposted:!1}),p[e.original_post_id].count++,t&&e.author_id===t&&(p[e.original_post_id].userReposted=!0)}),u.data&&u.data.forEach(e=>{g[e.post_id]=e.option_index});let f=r.map(t=>({...t,likes_count:h[t.id]?.count||0,comments_count:x[t.id]||0,reposts_count:p[t.id]?.count||0,user_has_liked:h[t.id]?.userLiked||!1,user_has_reposted:p[t.id]?.userReposted||!1,user_vote:g[t.id]??null,is_vip:e.includes(t.profiles?.email)}));f=f.filter(e=>!ur(e));const b=864e5;f.sort((e,t)=>{const s=Date.now(),a=new Date(e.created_at).getTime(),r=new Date(t.created_at).getTime(),n=s-a<b,i=s-r<b;return!e.is_vip||!n||t.is_vip&&i?!t.is_vip||!i||e.is_vip&&n?r-a:1:-1}),s(f)}l(!1)},w=async s=>{const{data:{user:n}}=await ns.auth.getUser(),{data:i}=await ns.from("posts").select("\n                *, \n                profiles:author_id (id, name, username, avatar_url, is_verified, gold_verified, headline, role, email), \n                likes (user_id), \n                comments (id)\n            ").eq("id",s).single();if(i){if(e&&i.community_id!==e)return;const s={...i,likes_count:i.likes?i.likes.length:0,comments_count:i.comments?i.comments.length:0,user_has_liked:!!n&&i.likes.some(e=>e.user_id===n.id)};t.some(e=>e.id===s.id)?r(s):a(s)}};return{posts:t,loading:o,currentUserId:m,createPost:async(t,s,r,n,i)=>{if(!t.trim()&&0===s.length&&!r)return;const{data:{user:o}}=await ns.auth.getUser();if(!o)return;const l=[];let c=null;const m=n||e;try{for(const t of s){const e=t.name.split(".").pop(),s=`posts/${`${Date.now()}_${Math.random()}.${e}`}`,{error:a}=await ns.storage.from("post-images").upload(s,t);if(a)continue;const{data:{publicUrl:r}}=ns.storage.from("post-images").getPublicUrl(s);l.push(r)}if(r){const e=r.name.split(".").pop(),t=`posts/${`video_${Date.now()}_${Math.random()}.${e}`}`,{error:s}=await ns.storage.from("post-images").upload(t,r);if(s)throw alert("Failed to upload video"),s;const{data:{publicUrl:a}}=ns.storage.from("post-images").getPublicUrl(t);c=a}const e=l.length>0?l[0]:null,{data:n,error:u}=await ns.from("posts").insert({author_id:o.id,content:t,image_url:e,image_urls:l,video_url:c,community_id:m,poll_options:i&&i.length>1?i:null,poll_counts:i&&i.length>1?new Array(i.length).fill(0):null}).select("*, profiles:author_id (*), likes (user_id), comments (id)").single();if(u)throw u;if(n){const e={...n,likes_count:0,comments_count:0,user_has_liked:!1,profiles:d||{id:o.id,name:"You"}};a(e),dr(t,n.id,o.id,"post")}}catch(u){throw alert("Failed to create post: "+(u.message||"Unknown error")),u}},deletePost:async e=>{n(e);const{error:t}=await ns.from("posts").delete().eq("id",e)},toggleLike:async e=>{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const s=e.user_has_liked,a=s?(e.likes_count||0)-1:(e.likes_count||0)+1;r({...e,user_has_liked:!s,likes_count:a}),s?await ns.from("likes").delete().match({post_id:e.id,user_id:t.id}):await ns.from("likes").insert({post_id:e.id,user_id:t.id})},toggleRepost:async(t,s)=>{const{data:{user:n}}=await ns.auth.getUser();if(!n)return;const i=t.is_repost&&t.original_post?t.original_post:t,o=i.id,{data:l}=await ns.from("posts").select("id").eq("author_id",n.id).eq("original_post_id",o).eq("is_repost",!0).maybeSingle();if(!!l){const e=Math.max((i.reposts_count||0)-1,0);r({...i,user_has_reposted:!1,reposts_count:e}),t.id!==i.id&&r({...t,user_has_reposted:!1,reposts_count:e}),await ns.from("posts").delete().eq("author_id",n.id).eq("original_post_id",o).eq("is_repost",!0)}else{const l=(i.reposts_count||0)+1;r({...i,user_has_reposted:!0,reposts_count:l}),t.id!==i.id&&r({...t,user_has_reposted:!0,reposts_count:l});const{data:c,error:m}=await ns.from("posts").insert({author_id:n.id,content:s||null,image_url:null,image_urls:null,video_url:null,is_repost:!0,original_post_id:o,repost_comment:s||null,community_id:e||null}).select("\n                    *,\n                    profiles:author_id (*)\n                ").single();if(m)r({...i,user_has_reposted:!1,reposts_count:i.reposts_count||0}),t.id!==i.id&&r({...t,user_has_reposted:!1,reposts_count:i.reposts_count||0}),alert("Failed to repost: "+(m.message||"Unknown error"));else if(c){const e={...c,likes_count:0,comments_count:0,user_has_liked:!1,original_post:i,profiles:d||c.profiles};a(e)}}},toggleComments:async e=>{if(h===e)x(null);else if(x(e),!p[e]){b(!0);const{data:t}=await ns.from("comments").select("*, profiles:author_id (*)").eq("post_id",e).order("created_at",{ascending:!0});t&&g(s=>({...s,[e]:t})),b(!1)}},activeCommentPostId:h,comments:p,loadingComments:f,postComment:async(e,s)=>{if(!s.trim())return;const{data:{user:a}}=await ns.auth.getUser();if(!a)return;const n=`temp-${Date.now()}`,i={id:n,post_id:e,author_id:a.id,content:s,created_at:(new Date).toISOString(),profiles:d||{id:a.id,name:"You"}};g(t=>({...t,[e]:[...t[e]||[],i]}));const o=t.find(t=>t.id===e);o&&r({...o,comments_count:(o.comments_count||0)+1});const{data:l,error:c}=await ns.from("comments").insert({post_id:e,author_id:a.id,content:s}).select("*, profiles:author_id (*)").single();if(c)throw g(t=>({...t,[e]:t[e].filter(e=>e.id!==n)})),o&&r({...o,comments_count:(o.comments_count||0)-1}),c;l&&(g(t=>({...t,[e]:t[e].map(e=>e.id===n?l:e)})),dr(s,e,a.id,"comment"))},deleteComment:async(e,s)=>{g(t=>({...t,[e]:t[e].filter(e=>e.id!==s)}));const a=t.find(t=>t.id===e);a&&r({...a,comments_count:Math.max((a.comments_count||0)-1,0)});const{error:n}=await ns.from("comments").delete().eq("id",s);n&&alert("Failed to delete comment")},reportPost:async e=>{const{data:{user:t}}=await ns.auth.getUser();if(t)try{const{error:s}=await ns.from("reports").insert({reporter_id:t.id,target_id:e,type:"post",reason:"Inappropriate Content",status:"pending"});if(s)throw s;alert("Post reported. Thank you for helping keep UniLink safe.")}catch(s){alert("Failed to report post. Please try again.")}},votePoll:async(e,s)=>{const a=t.find(t=>t.id===e);if(!(a&&a.poll_options&&a.poll_counts&&m))return;const n=[...a.poll_counts],i=a.user_vote;null!=i&&(n[i]=Math.max(0,n[i]-1)),n[s]=(n[s]||0)+1,r({...a,poll_counts:n,user_vote:s});const{error:o}=await ns.from("poll_votes").upsert({post_id:e,user_id:m,option_index:s},{onConflict:"post_id, user_id"});o&&(w(e),alert("Failed to register vote"))},searchPosts:async t=>{if(!t.trim())return void v();l(!0);const{data:{user:a}}=await ns.auth.getUser();let r=ns.from("posts").select("\n                *,\n                profiles:author_id (\n                    id,\n                    name,\n                    username,\n                    avatar_url,\n                    is_verified,\n                    gold_verified,\n                    headline,\n                    role,\n                    email\n                ),\n                original_post:original_post_id (\n                    id,\n                    content,\n                    image_url,\n                    image_urls,\n                    video_url,\n                    created_at,\n                    author_id,\n                    profiles:author_id (\n                        id,\n                        name,\n                        avatar_url,\n                        is_verified\n                    )\n                )\n            ").ilike("content",`%${t}%`).order("created_at",{ascending:!1}).limit(50);e&&(r=r.eq("community_id",e));const{data:n,error:i}=await r;if(i)l(!1);else{if(n){const e=n.map(e=>e.id),t=ns.from("likes").select("post_id, user_id").in("post_id",e),r=ns.from("comments").select("post_id").in("post_id",e),i=ns.from("posts").select("original_post_id, author_id").in("original_post_id",e).eq("is_repost",!0),[o,l,d]=await Promise.all([t,r,i]),c={},m={},u={};o.data?.forEach(e=>{c[e.post_id]||(c[e.post_id]={count:0,userLiked:!1}),c[e.post_id].count++,a&&e.user_id===a.id&&(c[e.post_id].userLiked=!0)}),l.data?.forEach(e=>m[e.post_id]=(m[e.post_id]||0)+1),d.data?.forEach(e=>{u[e.original_post_id]||(u[e.original_post_id]={count:0,userReposted:!1}),u[e.original_post_id].count++,a&&e.author_id===a.id&&(u[e.original_post_id].userReposted=!0)});const h=["oyasordaniel@gmail.com","akeledivine1@gmail.com"],x=n.filter(e=>!ur(e)).map(e=>({...e,likes_count:c[e.id]?.count||0,comments_count:m[e.id]||0,reposts_count:u[e.id]?.count||0,user_has_liked:c[e.id]?.userLiked||!1,user_has_reposted:u[e.id]?.userReposted||!1,is_vip:h.includes(e.profiles?.email)}));s(x)}l(!1)}},fetchSinglePost:w,currentUserProfile:d}}function xr(){const[e,t]=i.useState([]),[s,a]=i.useState(!0),[r,n]=i.useState(null),o=async()=>{a(!0),n(null);try{const{data:e,error:s}=await ns.from("sponsored_posts").select("*").order("created_at",{ascending:!1});if(s)throw s;t(e||[])}catch(e){n(e.message)}finally{a(!1)}};return i.useEffect(()=>{o()},[]),{posts:e,loading:s,error:r,fetchPosts:o,createPost:async e=>{try{const{data:t,error:s}=await ns.from("sponsored_posts").insert([{...e,created_by:(await ns.auth.getUser()).data.user?.id}]).select().single();if(s)throw s;return await o(),t}catch(t){throw t}},updatePost:async(e,s)=>{try{const{error:a}=await ns.from("sponsored_posts").update(s).eq("id",e);if(a)throw a;t(t=>t.map(t=>t.id===e?{...t,...s}:t))}catch(a){throw a}},deletePost:async e=>{try{const{error:s}=await ns.from("sponsored_posts").delete().eq("id",e);if(s)throw s;t(t=>t.filter(t=>t.id!==e))}catch(s){throw s}},trackImpression:async e=>{try{await ns.rpc("increment_sponsored_post_impression",{post_id:e});const{data:{user:t}}=await ns.auth.getUser();t&&await ns.from("sponsored_post_impressions").insert({sponsored_post_id:e,user_id:t.id})}catch(t){}},trackClick:async e=>{try{await ns.rpc("increment_sponsored_post_click",{post_id:e});const{data:{user:t}}=await ns.auth.getUser();t&&await ns.from("sponsored_post_impressions").update({clicked:!0,clicked_at:(new Date).toISOString()}).eq("sponsored_post_id",e).eq("user_id",t.id)}catch(t){}}}}function pr({post:t}){const{trackImpression:s,trackClick:a}=xr();i.useEffect(()=>{s(t.id)},[t.id]);return e.jsxs("article",{className:"bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-800 rounded-2xl overflow-hidden mb-4 hover:border-stone-300 dark:hover:border-zinc-700 transition-all shadow-sm",children:[e.jsxs("div",{className:"p-4 flex items-start gap-3",children:[e.jsx(d,{to:`/app/profile/${t.organization?.username||t.organization?.id}`,className:"shrink-0 relative",children:e.jsx("div",{className:"w-10 h-10 rounded-full bg-stone-100 dark:bg-zinc-800 overflow-hidden ring-2 ring-stone-100 dark:ring-zinc-800",children:e.jsx("img",{src:t.organization?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.organization?.name||"Org")}`,alt:t.organization?.name,className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[e.jsx(d,{to:`/app/profile/${t.organization?.username||t.organization?.id}`,className:"font-bold text-stone-900 dark:text-white hover:underline truncate",children:t.organization?.name}),t.organization?.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500 shrink-0"}):t.organization?.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500 shrink-0"}):null,e.jsx("span",{className:"text-stone-400 dark:text-zinc-500 text-xs",children:"•"}),e.jsx("span",{className:"text-stone-500 dark:text-zinc-500 text-xs font-medium",children:"Sponsored"})]}),e.jsx("button",{className:"text-stone-400 hover:text-stone-600 dark:hover:text-zinc-300",children:e.jsx(ce,{className:"w-5 h-5"})})]}),t.organization?.username&&e.jsxs("p",{className:"text-xs text-stone-500 dark:text-zinc-500",children:["@",t.organization.username]})]})]}),e.jsx("div",{className:"px-4 pb-3",children:e.jsx("p",{className:"whitespace-pre-wrap text-stone-800 dark:text-zinc-200 text-[15px] leading-relaxed",children:t.content})}),t.media_url&&e.jsx("div",{className:"w-full bg-black/5 dark:bg-black/20",children:"video"===t.media_type?e.jsx("video",{src:t.media_url,controls:!0,className:"w-full max-h-[500px] object-contain",poster:t.media_url.replace(/\.[^/.]+$/,"")+"_thumb.jpg"}):e.jsx("img",{src:t.media_url,alt:"Ad content",className:"w-full max-h-[500px] object-cover"})}),e.jsxs("div",{className:"p-3 bg-stone-50 dark:bg-zinc-800/50 border-t border-stone-100 dark:border-zinc-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-stone-500 dark:text-zinc-500 uppercase font-semibold tracking-wider px-2",children:"Promoted"}),t.cta_url&&e.jsxs("a",{href:t.cta_url,target:"_blank",rel:"noopener noreferrer",onClick:()=>{a(t.id)},className:"flex items-center gap-2 px-4 py-2 bg-stone-900 dark:bg-white text-white dark:text-stone-900 rounded-lg text-sm font-semibold hover:bg-stone-800 dark:hover:bg-zinc-200 transition-colors shadow-sm",children:[t.cta_text||"Learn More",e.jsx(ue,{className:"w-3.5 h-3.5"})]})]})]})}const gr=["🔥 Someone just liked a trending post","💬 New comment on a popular discussion","🚀 A student shared an exciting opportunity","🎓 New academic resource posted","⚡ Campus challenge is heating up — join now!","🏆 Leaderboard update — check your rank!","📢 New community post in your network","🤝 Someone connected with you on campus"];function fr({postCount:t}){const[s,a]=i.useState(0),[r,n]=i.useState(!0);return i.useEffect(()=>{const e=setInterval(()=>{n(!1),setTimeout(()=>{a(e=>(e+1)%gr.length),n(!0)},300)},4e3);return()=>clearInterval(e)},[]),e.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 dark:bg-emerald-950/20 border border-emerald-200/60 dark:border-emerald-800/30 rounded-xl px-3 py-2 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("span",{className:"text-xs font-bold text-emerald-700 dark:text-emerald-400 uppercase tracking-wide",children:"Live"})]}),e.jsx("p",{className:"text-xs text-emerald-800 dark:text-emerald-300 truncate transition-all duration-300 "+(r?"opacity-100 translate-x-0":"opacity-0 translate-x-2"),children:gr[s]}),t>0&&e.jsxs("span",{className:"flex-shrink-0 ml-auto text-xs font-bold text-emerald-600 dark:text-emerald-400 bg-emerald-100 dark:bg-emerald-900/40 px-2 py-0.5 rounded-full",children:[t," posts"]})]})}function br(){const t=c(),{posts:s,loading:a,currentUserId:r,createPost:n,deletePost:o,toggleLike:l,toggleRepost:d,toggleComments:m,activeCommentPostId:h,comments:x,loadingComments:p,postComment:g,deleteComment:f,reportPost:b,votePoll:v,searchPosts:w,currentUserProfile:j}=hr(),{posts:N}=xr(),[C,S]=i.useState(""),[z,U]=i.useState(null),[A,D]=i.useState([]),[L,M]=i.useState([]);i.useEffect(()=>{const e=()=>U(null);return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),i.useEffect(()=>{ns.from("profiles").select("id, name, username, avatar_url, role").order("updated_at",{ascending:!1}).limit(5).then(({data:e})=>M(e||[]))},[]),i.useEffect(()=>{const e=setTimeout(async()=>{if(w(C),C.trim().length>=2){const{data:e}=await ns.from("profiles").select("id, name, username, avatar_url, headline, university, role, is_verified").or(`name.ilike.%${C}%,username.ilike.%${C}%,university.ilike.%${C}%`).limit(4);D(e||[])}else D([])},500);return()=>clearTimeout(e)},[C]);const E=e=>{U(t=>t===e?null:e)},T=s.reduce((e,t)=>(((t.content||"").match(/#[a-z0-9_]+/gi)||[]).forEach(t=>{e[t]=(e[t]||0)+1}),e),{}),I=Object.entries(T).sort(([,e],[,t])=>t-e).slice(0,6).map(([e])=>e),O=i.useMemo(()=>{const e=new Set;return s.forEach((t,a)=>{if(!t.id)return;(a+1)%(5+t.id.split("").reduce((e,t)=>e+t.charCodeAt(0),0)%3)===0&&a<s.length-1&&e.add(a)}),e},[s]),R=[{to:"/app/network",icon:k,label:"Network",color:"blue"},{to:"/app/communities",icon:_,label:"Communities",color:"purple"},{to:"/app/challenge",icon:H,label:"Challenge",color:"yellow"},{to:"/app/leaderboard",icon:Y,label:"Leaderboard",color:"orange"}];return a?e.jsx("div",{className:"max-w-7xl mx-auto pb-20",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start",children:e.jsxs("div",{className:"lg:col-span-8 space-y-4",children:[e.jsx("div",{className:"h-9 bg-stone-100 dark:bg-zinc-800 rounded-lg animate-pulse"}),e.jsx(or,{})]})})}):e.jsx("div",{className:"max-w-7xl mx-auto pb-20",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 items-start",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-3",children:[e.jsx("div",{className:"sticky top-4 z-30 mb-1 px-4 lg:px-0",children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:e.jsx(Q,{className:"h-4 w-4 text-stone-400 dark:text-zinc-600 group-focus-within:text-emerald-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-4 py-2.5 bg-white/90 dark:bg-zinc-900/90 backdrop-blur-sm border border-stone-200/60 dark:border-zinc-800/60 rounded-xl text-sm text-stone-900 dark:text-zinc-100 placeholder:text-stone-400 dark:placeholder:text-zinc-600 focus:ring-2 focus:ring-emerald-500/30 focus:border-emerald-500/50 shadow-sm transition-all",placeholder:"Search posts, people, topics…",value:C,onChange:e=>S(e.target.value)})]})}),e.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-0.5 px-4 lg:px-0",children:R.map(({to:t,icon:s,label:a})=>e.jsxs(u,{to:t,className:({isActive:e})=>"flex items-center gap-1.5 px-3.5 py-1.5 rounded-full text-xs font-semibold whitespace-nowrap border transition-all flex-shrink-0 "+(e?"bg-emerald-600 text-white border-emerald-600 shadow-sm shadow-emerald-200 dark:shadow-emerald-900/30":"bg-white dark:bg-zinc-900 text-stone-600 dark:text-zinc-300 border-stone-200 dark:border-zinc-700 hover:border-emerald-300 dark:hover:border-emerald-700 hover:text-emerald-700 dark:hover:text-emerald-400"),children:[e.jsx(s,{className:"w-3 h-3"}),a]},t))}),!C&&e.jsx("div",{className:"px-4 lg:px-0",children:e.jsx(fr,{postCount:s.length})}),j&&e.jsx("div",{className:"px-4 lg:px-0",children:e.jsx(rr,{userName:j.name.split(" ")[0]})}),e.jsx("div",{className:"mb-1",children:e.jsx(Ha,{onCreate:n,user:j})}),C.trim().length>=2&&A.length>0&&e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-stone-200/80 dark:border-zinc-800 rounded-2xl overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-4 pt-3 pb-1",children:e.jsxs("p",{className:"text-xs font-bold text-stone-400 dark:text-zinc-500 uppercase tracking-wider flex items-center gap-1.5",children:[e.jsx(ve,{className:"w-3.5 h-3.5"})," People"]})}),A.map(s=>e.jsxs("button",{onClick:()=>t(`/app/profile/${s.username||s.id}`),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-stone-50 dark:hover:bg-zinc-800 transition-colors",children:[e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=random`,alt:s.name,className:"w-9 h-9 rounded-full object-cover flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-stone-900 dark:text-zinc-100 truncate",children:s.name}),e.jsx("p",{className:"text-xs text-stone-400 dark:text-zinc-500 truncate",children:s.headline||s.university||s.role})]}),s.is_verified&&e.jsx("span",{className:"text-emerald-500 text-xs font-bold",children:"✓ Verified"})]},s.id))]}),e.jsx("div",{className:"space-y-2",children:0===s.length?C?e.jsxs("div",{className:"text-center py-12 bg-white dark:bg-zinc-900 border-y border-stone-200/80 dark:border-zinc-800 rounded-2xl",children:[e.jsxs("p",{className:"text-stone-500 dark:text-zinc-500 mb-2",children:['No posts found for "',C,'"']}),e.jsx("button",{onClick:()=>S(""),className:"text-emerald-600 dark:text-emerald-500 font-medium hover:underline",children:"Clear search"})]}):e.jsx(nr,{onCreatePost:()=>window.scrollTo({top:0,behavior:"smooth"})}):s.map((t,s)=>{const a=(s+1)%8==0&&N.length>0,n=a?N[Math.floor(s/8)%N.length]:null,i=s<8?60*s+"ms":"0ms";return e.jsxs("div",{style:{animationDelay:i,animationFillMode:"both"},className:"animate-[feedIn_0.4s_ease_forwards]",children:[e.jsx(tr,{post:t,currentUserId:r,isActiveCommentSection:h===t.id,isActiveMenu:z===t.id,comments:x[t.id]||[],loadingComments:p&&h===t.id,onDelete:o,onLike:l,onRepost:d,onToggleComments:m,onToggleMenu:E,onPostComment:g,onSearchTag:S,onReport:b,onDeleteComment:f,onVotePoll:v}),n&&e.jsx("div",{className:"my-4 animate-[feedIn_0.5s_ease_forwards]",children:e.jsx(pr,{post:n})}),!C&&O.has(s)&&!a&&e.jsx("div",{className:"my-4",children:e.jsx(sr,{})})]},t.id)})})]}),e.jsxs("div",{className:"hidden lg:block lg:col-span-4 sticky top-4 space-y-4",children:[L.length>0&&e.jsxs("div",{className:"bg-white/80 dark:bg-zinc-900/80 backdrop-blur-md rounded-2xl p-5 shadow-sm border border-stone-200/50 dark:border-zinc-700/50",children:[e.jsxs("h3",{className:"font-bold text-sm text-stone-700 dark:text-zinc-300 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),"Active on campus"]}),e.jsx("div",{className:"space-y-2.5",children:L.map(s=>e.jsxs("button",{onClick:()=>t(`/app/profile/${s.username||s.id}`),className:"w-full flex items-center gap-3 group hover:bg-stone-50 dark:hover:bg-zinc-800 rounded-xl p-2 -mx-2 transition-colors",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=random`,alt:s.name,className:"w-8 h-8 rounded-full object-cover"}),e.jsx("span",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-emerald-500 border-2 border-white dark:border-zinc-900 rounded-full"})]}),e.jsx("span",{className:"text-sm font-medium text-stone-700 dark:text-zinc-300 group-hover:text-emerald-600 dark:group-hover:text-emerald-400 transition-colors truncate",children:s.name})]},s.id))})]}),e.jsxs("div",{className:"bg-white/80 dark:bg-zinc-900/80 backdrop-blur-md rounded-2xl p-5 shadow-sm border border-stone-200/50 dark:border-zinc-700/50",children:[e.jsxs("h3",{className:"font-bold text-sm text-stone-700 dark:text-zinc-300 mb-3 flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-500"}),"Trending topics"]}),e.jsx("div",{className:"space-y-1",children:0===I.length?e.jsx("p",{className:"text-stone-400 dark:text-zinc-500 text-sm py-2",children:"No trends yet — start a hashtag!"}):I.map((t,s)=>e.jsxs("button",{onClick:()=>S(t),className:"w-full flex items-center justify-between group p-2 hover:bg-stone-50 dark:hover:bg-zinc-800 rounded-xl transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-stone-300 dark:text-zinc-600 w-4 text-right",children:s+1}),e.jsx("span",{className:"font-semibold text-sm text-stone-700 dark:text-zinc-300 group-hover:text-emerald-600 dark:group-hover:text-emerald-400 transition-colors",children:t})]}),e.jsx("span",{className:"text-xs text-stone-400 dark:text-zinc-600 bg-stone-100 dark:bg-zinc-800 px-2 py-0.5 rounded-full group-hover:bg-emerald-50 dark:group-hover:bg-emerald-900/30 group-hover:text-emerald-600 transition-colors",children:T[t]})]},t))})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-600 to-teal-700 rounded-2xl p-5 text-white shadow-md shadow-emerald-200/30 dark:shadow-emerald-900/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(y,{className:"w-4 h-4 text-yellow-300"}),e.jsx("span",{className:"font-bold text-sm",children:"Campus Challenge"})]}),e.jsx("p",{className:"text-emerald-100/90 text-xs leading-relaxed mb-3",children:"Earn points, climb the leaderboard, and win prizes. New challenge every week!"}),e.jsxs(u,{to:"/app/challenge",className:"inline-flex items-center gap-1.5 bg-white text-emerald-700 text-xs font-bold px-3.5 py-1.5 rounded-lg hover:bg-emerald-50 transition-colors",children:[e.jsx(be,{className:"w-3.5 h-3.5 text-orange-500"}),"Join Challenge"]})]}),e.jsxs("div",{className:"text-xs text-stone-400 dark:text-zinc-500 px-2 leading-relaxed",children:["© 2025 UniLink Nigeria •"," ",e.jsx("span",{className:"hover:text-stone-600 dark:hover:text-zinc-400 cursor-pointer",children:"Privacy"})," •"," ",e.jsx("span",{className:"hover:text-stone-600 dark:hover:text-zinc-400 cursor-pointer",children:"Terms"})]})]})]})})}function vr(e){const{title:t,description:s,image:a,url:r}=e;t&&(document.title=`${t} | UniLink`);const n=(e,t,s=!1)=>{const a=s?"name":"property";let r=document.querySelector(`meta[${a}="${e}"]`);r||(r=document.createElement("meta"),r.setAttribute(a,e),document.head.appendChild(r)),r.setAttribute("content",t)};if(t&&(n("og:title",t),n("twitter:title",t,!0)),s){const e=function(e,t=200){if(!e||e.length<=t)return e;const s=e.match(/[^.!?]+[.!?]+/g);if(s&&s[0]&&s[0].length<=t)return s[0].trim();const a=e.substring(0,t),r=a.lastIndexOf(" ");return r>.8*t?a.substring(0,r)+"...":a+"..."}(s,200);n("og:description",e),n("twitter:description",e,!0),n("description",e,!0)}a&&(n("og:image",a),n("twitter:image",a,!0),n("twitter:card","summary_large_image",!0)),r&&n("og:url",r)}function wr(){vr({title:"UniLink - The #1 Network for Nigerian Students",description:"Connect with students across Nigerian universities. Network, share opportunities, and build your professional profile.",image:`${window.location.origin}/icon-512.png`,url:window.location.href})}function jr(){const{postId:t}=x(),s=c(),{fetchSinglePost:a,currentUserId:r,toggleLike:n,toggleRepost:o,toggleComments:l,comments:m,loadingComments:u,postComment:h,deleteComment:p,deletePost:g,reportPost:f,votePoll:b}=hr(),{posts:v}=lr(),w=v.find(e=>e.id===t),[j,y]=i.useState(!0),[N,k]=i.useState(null);return i.useEffect(()=>{t&&(y(!0),a(t).finally(()=>y(!1)),l(t))},[t]),i.useEffect(()=>{if(w){vr({title:`${w.profiles?.name||"UniLink User"}'s Post`,description:w.content||"",image:w.image_url||w.image_urls?.[0]||`${window.location.origin}/icon-512.png`,url:window.location.href})}return()=>{wr()}},[w]),j?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-500"})}):w?e.jsxs("div",{className:"max-w-2xl mx-auto pb-20",children:[e.jsxs("button",{onClick:()=>s(-1),className:"inline-flex items-center gap-2 text-stone-500 hover:text-stone-800 mb-6 transition-colors font-medium",children:[e.jsx(we,{className:"w-4 h-4"})," Back"]}),e.jsx(tr,{post:w,currentUserId:r,isActiveCommentSection:!0,isActiveMenu:N===w.id,comments:m[w.id]||[],loadingComments:u,onDelete:e=>{g(e),s("/app")},onLike:n,onRepost:(e,t)=>o(e,t),onToggleComments:()=>{},onToggleMenu:e=>k(N===e?null:e),onPostComment:h,onSearchTag:e=>s(`/app?search=${encodeURIComponent(e)}`),onReport:f,onDeleteComment:p,onVotePoll:b})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[e.jsx("p",{className:"text-stone-500",children:"Post not found or deleted."}),e.jsx(d,{to:"/app",className:"text-emerald-600 font-medium hover:underline",children:"Back to Feed"})]})}function yr({conversations:t,activeChat:s,setActiveChat:a,unreadCounts:r,onlineUsers:n}){return e.jsxs("div",{className:"w-full md:w-80 border-r border-stone-100 flex flex-col h-full bg-white "+(s?"hidden md:flex":"flex"),children:[e.jsxs("div",{className:"p-4 border-b border-stone-100",children:[e.jsx("h2",{className:"font-bold text-lg mb-4",children:"Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search connections...",className:"w-full pl-9 pr-4 py-2 bg-stone-50 rounded-xl text-sm outline-none focus:ring-2 focus:ring-emerald-100"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:0===t.length?e.jsx("div",{className:"p-8 text-center text-stone-500 text-sm",children:e.jsx("p",{children:"No connections yet."})}):t.map(t=>e.jsxs("button",{onClick:()=>a(t),className:`w-full p-4 flex items-center gap-3 hover:bg-stone-50 transition-all duration-300 text-left \n                                    ${s?.id===t.id?"bg-emerald-50":""}\n                                    ${r[t.id]?"bg-emerald-50/50":""}\n                                `,children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-stone-200 overflow-hidden flex-shrink-0 relative",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=random`,alt:t.name,className:"w-full h-full object-cover"}),n.has(t.id)&&e.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full z-10"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-medium text-stone-900 truncate flex items-center gap-1",children:[t.name,t.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50 shrink-0"}):t.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50 shrink-0"}):null]}),r[t.id]>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center animate-in zoom-in duration-300 shadow-sm flex items-center justify-center",children:r[t.id]})]}),e.jsx("p",{className:"text-xs text-stone-500 truncate",children:t.headline||t.university||t.role})]})]},t.id))})]})}function Nr({msg:t,isMe:s,onReply:a,activeChat:r,onImageClick:n,onDelete:o,onForward:l}){const[d,c]=i.useState(!1),m=i.useRef(null),[u,h]=i.useState(!1),x=i.useRef(null),p=t.content.startsWith("> ")&&-1!==t.content.indexOf("\n\n");let g="",f=t.content;if(p){const e=t.content.indexOf("\n\n");g=t.content.substring(2,e),f=t.content.substring(e+2)}return e.jsxs("div",{className:`relative flex items-end gap-2 group ${s?"justify-end":"justify-start"} px-2`,onTouchStart:()=>{m.current=setTimeout(()=>{c(!0),navigator.vibrate&&navigator.vibrate(50)},500)},onTouchEnd:()=>{m.current&&clearTimeout(m.current)},onTouchMove:()=>{m.current&&clearTimeout(m.current)},onContextMenu:e=>{e.preventDefault()},children:[!s&&r&&e.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-stone-200 mb-1 shadow-sm shrink-0 border border-white",children:e.jsx("img",{src:r.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(r.name)}`,alt:"Avatar",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:`max-w-[85%] md:max-w-[70%] px-4 py-2 rounded-2xl text-sm relative z-10 shadow-sm transition-transform duration-200 ${s?"bg-emerald-600 text-white rounded-br-none":"bg-white border border-stone-100 text-stone-800 rounded-bl-none"} ${d?"scale-105 shadow-md ring-2 ring-emerald-500/20":""}`,children:[g&&e.jsxs("div",{className:"mb-2 p-2 rounded-lg text-xs border-l-2 flex flex-col select-none "+(s?"bg-emerald-800/40 border-emerald-400 text-emerald-100":"bg-stone-100 border-stone-300 text-stone-500"),children:[e.jsx("span",{className:"font-bold opacity-75 text-[10px] uppercase mb-0.5",children:"Replying to"}),e.jsxs("span",{className:"line-clamp-2 italic",children:['"',g,'"']})]}),e.jsx("div",{className:"break-words whitespace-pre-wrap",children:f}),t.image_url&&(b=t.image_url,/\.(jpg|jpeg|png|gif|webp)$/i.test(b.split("?")[0])?e.jsx("div",{className:"mt-2 rounded-lg overflow-hidden border border-black/10",children:e.jsx("img",{src:t.image_url,alt:"Attachment",className:"max-w-full max-h-60 object-cover cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>t.image_url&&n(t.image_url)})}):e.jsxs("a",{href:t.image_url,target:"_blank",rel:"noopener noreferrer",className:"mt-2 flex items-center gap-3 p-3 rounded-xl border transition-colors group/file "+(s?"bg-emerald-700/50 border-emerald-500/30 hover:bg-emerald-700/70 text-emerald-50":"bg-stone-50 border-stone-200 hover:bg-stone-100 text-stone-700"),children:[e.jsx("div",{className:"p-2 rounded-lg "+(s?"bg-emerald-800/50":"bg-stone-200"),children:e.jsx(je,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-medium truncate opacity-90",children:decodeURIComponent(t.image_url.split("/").pop()?.split("?")[0]||"Document")}),e.jsx("p",{className:"text-[10px] opacity-70",children:"Tap to view"})]}),e.jsx(j,{className:"w-4 h-4 opacity-70"})]})),t.audio_url&&e.jsxs("div",{className:"mt-2 flex items-center gap-3 p-3 rounded-xl min-w-[200px] "+(s?"bg-emerald-800/20":"bg-stone-100"),children:[e.jsx("button",{onClick:()=>{x.current&&(u?x.current.pause():x.current.play(),h(!u))},className:"p-2 rounded-full shrink-0 transition-colors "+(s?"bg-emerald-500 text-white hover:bg-emerald-400":"bg-stone-900 text-white hover:bg-stone-700"),children:u?e.jsx(ye,{className:"w-4 h-4 fill-current"}):e.jsx(Ne,{className:"w-4 h-4 fill-current"})}),e.jsx("div",{className:"flex-1 h-8 flex items-center",children:e.jsx("div",{className:"flex items-center gap-0.5 h-full w-full opacity-60",children:[...Array(15)].map((t,a)=>e.jsx("div",{className:`w-1 rounded-full ${s?"bg-white":"bg-stone-400"} animate-pulse`,style:{height:30+70*Math.random()+"%",animationDelay:.1*a+"s"}},a))})}),e.jsx("audio",{ref:x,src:t.audio_url,onEnded:()=>h(!1),onPause:()=>h(!1),onPlay:()=>h(!0),className:"hidden"})]}),e.jsxs("div",{className:"text-[10px] mt-1 flex justify-end items-center gap-1 select-none "+(s?"text-emerald-100/70":"text-stone-400"),children:[new Date(t.created_at||Date.now()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),s&&(t.id.startsWith("temp-")?e.jsx("div",{className:"flex items-center gap-0.5",title:"Sending...",children:e.jsx(ke,{className:"w-3 h-3 text-emerald-100/70"})}):t.read_at?e.jsx("div",{className:"flex items-center gap-0.5",title:`Seen ${new Date(t.read_at).toLocaleString()}`,children:e.jsx(_e,{className:"w-3.5 h-3.5 text-white"})}):e.jsx("div",{className:"flex items-center gap-0.5",title:"Delivered",children:e.jsx(E,{className:"w-3.5 h-3.5 text-emerald-200"})}))]}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/10 backdrop-blur-[1px]",onClick:e=>{e.stopPropagation(),c(!1)}}),e.jsxs("div",{className:`absolute z-50 bottom-full mb-2 ${s?"right-0":"left-0"} bg-white rounded-xl shadow-xl border border-stone-100 py-1 min-w-[140px] animate-in zoom-in-95 duration-200 overflow-hidden`,onClick:e=>e.stopPropagation(),children:[e.jsxs("button",{onClick:()=>{c(!1),a(t)},className:"w-full text-left px-4 py-3 text-sm text-stone-700 hover:bg-stone-50 flex items-center gap-3 active:bg-stone-100",children:[e.jsx(Ce,{className:"w-4 h-4"})," Reply"]}),l&&e.jsxs("button",{onClick:()=>{c(!1),l(t)},className:"w-full text-left px-4 py-3 text-sm text-stone-700 hover:bg-stone-50 flex items-center gap-3 active:bg-stone-100 border-t border-stone-50",children:[e.jsx(Se,{className:"w-4 h-4"})," Forward"]}),s&&o&&e.jsxs("button",{onClick:()=>{c(!1),o(t.id)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-3 border-t border-stone-50 active:bg-red-50",children:[e.jsx(me,{className:"w-4 h-4"})," Delete"]})]})]})]}),e.jsx("button",{onClick:()=>a(t),className:`p-2 text-stone-300 hover:text-stone-500 transition-opacity ${s?"mr-1":"ml-1"} opacity-0 group-hover:opacity-100 hidden md:block`,title:"Reply",children:e.jsx(Ce,{className:"w-4 h-4"})})]});var b}function kr({message:t,isOpen:s,onClose:a,onForward:r}){const[n,o]=i.useState([]),[l,d]=i.useState(new Set),[c,m]=i.useState(""),[u,h]=i.useState(!1),[x,p]=i.useState(!1);i.useEffect(()=>{s&&(g(),d(new Set),m(""))},[s]);const g=async()=>{h(!0);try{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{data:t}=await ns.from("connections").select("requester_id, recipient_id").eq("status","accepted").or(`requester_id.eq.${e.id},recipient_id.eq.${e.id}`);if(!t)return;const s=t.map(t=>t.requester_id===e.id?t.recipient_id:t.requester_id),{data:a}=await ns.from("profiles").select("*").in("id",s).order("name");a&&o(a)}catch(e){}finally{h(!1)}},f=n.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||e.username?.toLowerCase().includes(c.toLowerCase()));return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md shadow-2xl animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-stone-100 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900",children:"Forward Message"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-stone-100 rounded-full transition-colors",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 border-b border-stone-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"}),e.jsx("input",{type:"text",value:c,onChange:e=>m(e.target.value),placeholder:"Search contacts...",className:"w-full pl-10 pr-4 py-2 bg-stone-50 border border-stone-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto p-2",children:u?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(M,{className:"w-6 h-6 animate-spin text-emerald-600"})}):0===f.length?e.jsx("div",{className:"text-center py-8 text-stone-400",children:c?"No contacts found":"No connections yet"}):f.map(t=>e.jsxs("button",{onClick:()=>(e=>{const t=new Set(l);t.has(e)?t.delete(e):t.add(e),d(t)})(t.id),className:"w-full flex items-center gap-3 p-3 rounded-xl transition-colors "+(l.has(t.id)?"bg-emerald-50 border-2 border-emerald-500":"hover:bg-stone-50 border-2 border-transparent"),children:[e.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden bg-stone-200 shrink-0",children:e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}`,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("p",{className:"font-semibold text-stone-900 truncate",children:t.name}),t.username&&e.jsxs("p",{className:"text-xs text-stone-500 truncate",children:["@",t.username]})]}),l.has(t.id)&&e.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]},t.id))}),e.jsxs("div",{className:"p-4 border-t border-stone-100 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-stone-500",children:[l.size," selected"]}),e.jsx("button",{onClick:async()=>{if(t&&0!==l.size){p(!0);try{await r(Array.from(l),t),a()}catch(e){alert("Failed to forward message")}finally{p(!1)}}},disabled:0===l.size||x,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-xl font-medium hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:x?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 animate-spin"}),"Forwarding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4"}),"Forward"]})})]})]})}):null}function _r({activeChat:t,messages:s,userId:a,onlineUsers:r,onBack:n,onSendMessage:o,onDeleteMessage:c}){const[m,u]=i.useState(""),[h,x]=i.useState(null),[p,g]=i.useState(null),[f,b]=i.useState(null),[v,w]=i.useState(null),[j,y]=i.useState(!1),[N,k]=i.useState(null),[_,C]=i.useState(!1),[S,z]=i.useState(!1),U=i.useRef(null),P=i.useRef(0),A=i.useRef(null),L=i.useRef(null);i.useEffect(()=>{if(!a||!t)return;(async()=>{if(s.length>0&&s[0].conversation_id){const{error:e}=await ns.rpc("mark_conversation_as_read",{target_conversation_id:s[0].conversation_id})}})();const e=`chat-room:${[a,t.id].sort((e,t)=>e.localeCompare(t)).join("-")}`,r=ns.channel(e).on("broadcast",{event:"typing"},e=>{e.payload.sender_id===t.id&&(z(!0),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{z(!1)},3e3))}).subscribe();return()=>{U.current&&clearTimeout(U.current),ns.removeChannel(r)}},[a,t.id,s.length]);i.useEffect(()=>{A.current&&(A.current.scrollTop=A.current.scrollHeight)},[s,t,h,S]);const E=()=>{g(null),b(null),L.current&&(L.current.value="")},[T,I]=i.useState(!1),[O,R]=i.useState(!1),[F,$]=i.useState(0),q=i.useRef(null),B=i.useRef([]),H=i.useRef(null),W=async e=>{I(!0);try{const t=new FileReader;t.readAsDataURL(e),t.onloadend=async()=>{const e=t.result;try{await o("",null,h||void 0,e),x(null)}catch(s){alert("Failed to send voice note")}finally{I(!1)}},t.onerror=()=>{alert("Failed to process voice note"),I(!1)}}catch(t){alert("Failed to send voice note"),I(!1)}},K=e=>{k(e),C(!0)};return e.jsxs("div",{className:"flex-1 flex flex-col h-full bg-stone-50/50 flex",children:[e.jsxs("div",{className:"p-4 bg-white border-b border-stone-100 flex items-center gap-3 shadow-sm z-10",children:[e.jsx("button",{onClick:n,className:"md:hidden p-2 -ml-2 text-stone-500 hover:text-stone-800 active:bg-stone-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6"})}),e.jsxs(d,{to:`/app/profile/${t.username||t.id}`,className:"flex items-center gap-3 flex-1 min-w-0 hover:bg-stone-50 p-2 -my-2 rounded-lg transition-colors",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-stone-200 overflow-hidden relative shrink-0",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=random`,alt:t.name,className:"w-full h-full object-cover"}),r.has(t.id)&&e.jsx("div",{className:"absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full z-10"})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("h3",{className:"font-bold text-stone-900 flex items-center gap-1 truncate",children:[t.name,t.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50 shrink-0"}):t.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50 shrink-0"}):null]}),e.jsx("p",{className:"text-xs text-stone-500 truncate",children:r.has(t.id)?e.jsx("span",{className:"text-green-600 font-medium",children:"Online"}):t.headline||t.university||t.role})]})]})]}),e.jsxs("div",{ref:A,className:"flex-1 overflow-y-auto p-4 space-y-4",children:[s.map(s=>e.jsx(Nr,{msg:s,isMe:s.sender_id===a,onReply:x,activeChat:t,onImageClick:w,onDelete:c,onForward:K},s.id)),S&&e.jsx("div",{className:"flex justify-start animate-in slide-in-from-bottom-2 duration-300",children:e.jsxs("div",{className:"bg-white px-4 py-3 rounded-2xl rounded-tl-none shadow-sm border border-stone-100 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-stone-400 rounded-full animate-bounce [animation-delay:-0.3s]"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-stone-400 rounded-full animate-bounce [animation-delay:-0.15s]"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-stone-400 rounded-full animate-bounce"})]})})]}),(h||p)&&e.jsxs("div",{className:"px-4 py-2 bg-stone-100 border-t border-stone-200 flex justify-between items-center text-sm text-stone-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h&&e.jsx(e.Fragment,{children:e.jsx(l.Fragment,{children:e.jsxs("span",{className:"truncate max-w-[150px] md:max-w-md",children:["Replying to: ",h.content]})})}),p&&e.jsx("div",{className:"flex items-center gap-2 ml-4",children:f?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("img",{src:f,className:"w-8 h-8 rounded object-cover border",alt:"preview"})]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-stone-900 truncate max-w-[120px]",children:p.name})]})})]}),e.jsx("button",{onClick:()=>{x(null),E()},className:"p-1 hover:text-stone-900 shrink-0 ml-2",children:e.jsx(D,{className:"w-4 h-4"})})]}),O?e.jsxs("div",{className:"p-4 bg-white border-t border-stone-100 flex items-center justify-between pb-safe",children:[e.jsxs("div",{className:"flex items-center gap-3 text-red-500 animate-pulse",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{className:"font-mono font-medium",children:(Y=F,`${Math.floor(Y/60)}:${(Y%60).toString().padStart(2,"0")}`)})]}),e.jsx("div",{className:"text-sm text-stone-500 font-medium",children:"Recording voice note..."}),e.jsx("button",{onClick:()=>{q.current&&O&&(q.current.stop(),R(!1),H.current&&clearInterval(H.current))},className:"p-3 bg-red-500 text-white rounded-full hover:bg-red-600 transition-transform active:scale-95 shadow-lg shadow-red-200",children:e.jsx(ze,{className:"w-5 h-5 fill-current"})})]}):e.jsxs("div",{className:"p-4 bg-white border-t border-stone-100 pb-safe relative",children:[j&&e.jsxs("div",{className:"absolute bottom-full left-4 mb-2 bg-white rounded-2xl shadow-xl border border-stone-100 p-4 w-72 grid grid-cols-4 gap-2 animate-in slide-in-from-bottom-5 z-20",children:[e.jsxs("div",{className:"col-span-4 flex justify-between items-center mb-2 pb-2 border-b border-stone-50",children:[e.jsx("span",{className:"text-xs font-bold text-stone-500 uppercase",children:"Stickers"}),e.jsx("button",{onClick:()=>y(!1),className:"bg-stone-100 p-1 rounded-full",children:e.jsx(D,{className:"w-3 h-3"})})]}),["happy","love","cool","wink","cry","surprised","angry","confused","sleep","laugh","kiss","shades"].map(t=>e.jsx("button",{onClick:()=>{o("",`https://api.dicebear.com/7.x/fun-emoji/svg?seed=${t}&radius=50&backgroundColor=transparent`,h||void 0),y(!1)},className:"hover:bg-stone-50 p-1 rounded-xl transition-colors",children:e.jsx("img",{src:`https://api.dicebear.com/7.x/fun-emoji/svg?seed=${t}&radius=50&backgroundColor=transparent`,alt:t,className:"w-full h-auto"})},t))]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(m.trim()||p)&&a&&!T){I(!0);try{let e=null;if(p){const t=p.name.split(".").pop(),s=`chat/${Date.now()}_${Math.random()}.${t}`,{error:a}=await ns.storage.from("uploads").upload(s,p);if(a)return void alert("Failed to send image.");const{data:{publicUrl:r}}=ns.storage.from("uploads").getPublicUrl(s);e=r}await o(m,e,h||void 0),u(""),x(null),E()}finally{I(!1)}}},className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:L,className:"hidden",accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt",onChange:e=>{const t=e.target.files?.[0];if(t){const e=10485760;if(t.size>e)return alert("Image size must be less than 10MB. Please choose a smaller image."),void(L.current&&(L.current.value=""));if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/plain"].includes(t.type))return alert("Invalid file format. Please upload an Image, PDF, DOC, XLS, PPT, or TXT file."),void(L.current&&(L.current.value=""));g(t),t.type.startsWith("image/")?b(URL.createObjectURL(t)):b(null)}}}),e.jsx("button",{type:"button",onClick:()=>y(!j),className:"p-2 rounded-xl transition-all "+(j?"bg-emerald-50 text-emerald-600":"bg-stone-50 text-stone-400 hover:text-emerald-600"),children:e.jsx(oe,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:()=>{L.current?.click()},className:"p-2 rounded-xl transition-all "+(p?"bg-emerald-50 text-emerald-600":"bg-stone-50 text-stone-400 hover:text-emerald-600"),children:e.jsx(Ue,{className:"w-5 h-5"})}),e.jsx("input",{type:"text",value:m,onChange:e=>{u(e.target.value),(async()=>{if(!a||!t)return;const e=Date.now();if(e-P.current>2e3){P.current=e;const s=`chat-room:${[a,t.id].sort((e,t)=>e.localeCompare(t)).join("-")}`;await ns.channel(s).send({type:"broadcast",event:"typing",payload:{sender_id:a}})}})()},placeholder:h?"Type your reply...":"Type a message...",className:"flex-1 px-4 py-2 rounded-xl bg-stone-50 border-none outline-none focus:ring-2 focus:ring-emerald-100",autoFocus:!0}),m.trim()||p?e.jsx("button",{type:"submit",disabled:T,className:"p-2 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:T?e.jsx(M,{className:"w-5 h-5 animate-spin"}):e.jsx(le,{className:"w-5 h-5"})}):e.jsx("button",{type:"button",onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":MediaRecorder.isTypeSupported("audio/mp4")?"audio/mp4":"",s=new MediaRecorder(e,t?{mimeType:t}:void 0);q.current=s,B.current=[],s.ondataavailable=e=>{e.data.size>0&&B.current.push(e.data)},s.onstop=async()=>{const t=new Blob(B.current,{type:"audio/mpeg"});await W(t),e.getTracks().forEach(e=>e.stop())},s.start(),R(!0),$(0),H.current=setInterval(()=>{$(e=>e+1)},1e3)}catch(e){alert("Cannot access microphone. Please allow permissions.")}},className:"p-2 bg-stone-50 text-stone-500 rounded-xl hover:bg-stone-200 transition-colors",title:"Record Voice Note",children:e.jsx(Pe,{className:"w-5 h-5"})})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4 cursor-zoom-out",onClick:()=>w(null),children:e.jsx("img",{src:v,alt:"Full size",className:"max-w-full max-h-full object-contain"})}),e.jsx(kr,{message:N,isOpen:_,onClose:()=>{C(!1),k(null)},onForward:async(e,t)=>{try{const{data:{user:s}}=await ns.auth.getUser();if(!s)return;for(const a of e){const{data:e}=await ns.from("conversation_participants").select("conversation_id").eq("user_id",s.id).single();let r=e?.conversation_id;if(!r){const{data:e}=await ns.from("conversations").insert({type:"private"}).select().single();e&&(r=e.id,await ns.from("conversation_participants").insert([{conversation_id:r,user_id:s.id},{conversation_id:r,user_id:a}]))}await ns.from("messages").insert({conversation_id:r,sender_id:s.id,recipient_id:a,content:t.content,image_url:t.image_url,audio_url:t.audio_url})}}catch(s){throw s}}})]});var Y}function Cr(){const{conversations:t,activeChat:s,setActiveChat:a,messages:r,loading:n,userId:o,onlineUsers:l,unreadCounts:d,sendMessage:c,deleteMessage:m}=function(){const[e,t]=i.useState([]),[s,a]=i.useState(null),[r,n]=i.useState([]),[o,l]=i.useState(null),[d,c]=i.useState(new Set),[m,u]=i.useState({}),[h,x]=i.useState(!0),p=i.useRef(null);i.useEffect(()=>{p.current=s,s&&u(e=>{if(!e[s.id])return e;const t={...e};return delete t[s.id],t})},[s]);const g=i.useCallback(async e=>{const{data:s,error:a}=await ns.rpc("get_sorted_conversations",{current_user_id:e});a||s&&t(s)},[]),f=i.useCallback(async e=>{o&&(n(t=>t.map(t=>t.sender_id!==e||t.read_at?t:{...t,read_at:(new Date).toISOString()})),await ns.from("messages").update({read_at:(new Date).toISOString()}).eq("sender_id",e).eq("recipient_id",o).is("read_at",null),u(t=>{const s={...t};return delete s[e],s}))},[o]);return i.useEffect(()=>{(async()=>{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;l(e.id),await g(e.id);const{data:t}=await ns.rpc("fetch_unread_counts",{current_user_id:e.id});if(t){const e={};t.forEach(t=>{e[t.sender_id]=parseInt(t.unread_count,10)||0}),u(e)}x(!1)})()},[g]),i.useEffect(()=>{if(!o)return;const e=ns.channel("global-messages-listener").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`recipient_id=eq.${o}`},async e=>{const t=e.new.sender_id;p.current?.id!==t&&u(e=>({...e,[t]:(e[t]||0)+1})),g(o)}).subscribe(),t=ns.channel("global-presence");return t.on("presence",{event:"sync"},()=>{const e=t.presenceState(),s=new Set;for(const t in e)e[t].forEach(e=>{e.user_id&&s.add(e.user_id)});c(s)}).subscribe(async e=>{"SUBSCRIBED"===e&&await t.track({user_id:o,online_at:(new Date).toISOString()})}),()=>{ns.removeChannel(e),t.untrack().then(()=>ns.removeChannel(t))}},[o]),i.useEffect(()=>{if(!s||!o)return;(async()=>{const{data:e}=await ns.from("messages").select("*").or(`and(sender_id.eq.${o},recipient_id.eq.${s.id}),and(sender_id.eq.${s.id},recipient_id.eq.${o})`).order("created_at",{ascending:!0});n(e||[]),f(s.id)})();const e=ns.channel(`chat:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},e=>{const t=e.new;(t.sender_id===s.id&&t.recipient_id===o||t.sender_id===o&&t.recipient_id===s.id)&&n(e=>{if(e.some(e=>e.id===t.id))return e;if(t.sender_id===o){const s=e.find(e=>e.id.startsWith("temp-")&&(e.audio_url&&e.audio_url===t.audio_url||!e.audio_url&&e.content===t.content));if(s)return e.map(e=>e.id===s.id?t:e)}return t.sender_id===s.id&&f(s.id),[...e,t]})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},e=>{const t=e.new;(t.sender_id===s.id&&t.recipient_id===o||t.sender_id===o&&t.recipient_id===s.id)&&n(e=>e.map(e=>e.id===t.id?t:e))}).subscribe();return()=>{ns.removeChannel(e)}},[s,o,f]),{conversations:e,activeChat:s,setActiveChat:a,messages:r,loading:h,userId:o,onlineUsers:d,unreadCounts:m,sendMessage:async(e,t=null,a,r=null)=>{if(!s||!o)return;let i=e;if(a){let t=a.content;if(t.startsWith("> ")&&t.includes("\n\n")){const e=t.indexOf("\n\n");-1!==e&&(t=t.substring(e+2))}i=`> ${t.substring(0,50)}${t.length>50?"...":""}\n\n${e}`}const l={id:"temp-"+Date.now(),sender_id:o,recipient_id:s.id,content:i||(r?"Voice Message":""),created_at:(new Date).toISOString(),image_url:t,audio_url:r};n(e=>[...e,l]);const{error:d}=await ns.from("messages").insert({sender_id:o,recipient_id:s.id,content:i||(r?"Voice Message":""),image_url:t,audio_url:r});d||g(o)},deleteMessage:async e=>{n(t=>t.filter(t=>t.id!==e));const{error:t}=await ns.from("messages").delete().eq("id",e)}}}(),[u]=p(),h=u.get("chat");return i.useEffect(()=>{if(h&&t.length>0&&!s){const e=t.find(e=>e.id===h);e&&a(e)}},[h,t,s,a]),n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"})}):e.jsxs("div",{className:"fixed inset-0 top-[64px] md:top-0 left-0 md:left-[280px] right-0 bottom-[60px] md:bottom-0 bg-white z-20 flex",children:[e.jsx(yr,{conversations:t,activeChat:s,setActiveChat:a,unreadCounts:d,onlineUsers:l}),s?e.jsx("div",{className:"flex-1 flex flex-col h-full w-full md:w-auto",children:e.jsx(_r,{activeChat:s,messages:r,userId:o,onlineUsers:l,onBack:()=>a(null),onSendMessage:c,onDeleteMessage:m})}):e.jsxs("div",{className:"flex-1 flex-col items-center justify-center text-stone-400 bg-stone-50/50 hidden md:flex",children:[e.jsx("div",{className:"w-16 h-16 bg-stone-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(le,{className:"w-8 h-8 opacity-20"})}),e.jsx("p",{children:"Select a conversation to start messaging"})]})]})}function Sr(){const[t,s]=i.useState([]),[a,r]=i.useState(!0),[n,o]=i.useState(null),[l,d]=i.useState(null),[c,m]=i.useState(""),[u,h]=i.useState(!1),[x,p]=i.useState(null),[g,f]=i.useState(!1),[b,v]=i.useState({}),[w,j]=i.useState(null),[y,N]=i.useState(null),[S,z]=i.useState([]),[U,P]=i.useState(!1),A=()=>{j(null)},D=async e=>{P(!0);const{data:t,error:s}=await ns.from("job_applications").select("\n                user_id,\n                status,\n                created_at,\n                profiles:user_id (\n                    id,\n                    name,\n                    headline,\n                    avatar_url,\n                    university,\n                    email\n                )\n            ").eq("job_id",e).order("created_at",{ascending:!1});!s&&t&&z(t),P(!1)},[L,E]=i.useState(!1),[T,I]=i.useState({title:"",company:"",type:"Internship",description:"",application_link:"",location:"",salary_range:"",deadline:"",logo_url:""}),[O,R]=i.useState(""),[F,$]=i.useState("All"),q=async()=>{r(!0);const{data:e,error:t}=await ns.from("jobs").select("*").order("created_at",{ascending:!1});!t&&e&&s(e),r(!1)};i.useEffect(()=>{(async()=>{const{data:{user:e}}=await ns.auth.getUser();if(e){d(e.id);const{data:t}=await ns.from("profiles").select("role, university, company_name").eq("id",e.id).single();t&&(o(t.role),m(t.company_name||t.university||""))}})(),q(),(async()=>{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{data:t}=await ns.from("job_applications").select("job_id, status").eq("user_id",e.id);if(t){const e={};t.forEach(t=>{e[t.job_id]=t.status}),v(e)}})();const e=ns.channel("public:jobs").on("postgres_changes",{event:"INSERT",schema:"public",table:"jobs"},e=>{s(t=>[e.new,...t])}).subscribe();return()=>{ns.removeChannel(e)}},[l]);const B=()=>{p(null),E(!1),I({title:"",company:c,type:"Internship",description:"",application_link:"",location:"",salary_range:"",deadline:"",logo_url:""})},H=async e=>{const{data:{user:t}}=await ns.auth.getUser();if(t&&(e.application_link&&window.open(e.application_link,"_blank"),!b[e.id])){const{error:s}=await ns.from("job_applications").insert({user_id:t.id,job_id:e.id,status:"applied"});s||v(t=>({...t,[e.id]:"applied"}))}},W=t.filter(e=>{const t=e.title.toLowerCase().includes(O.toLowerCase())||e.company.toLowerCase().includes(O.toLowerCase())||e.description&&e.description.toLowerCase().includes(O.toLowerCase()),s="All"===F||e.type===F,a=!g||l&&e.creator_id===l;return t&&s&&a});return a?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-500"})}):e.jsxs("div",{className:"max-w-5xl mx-auto space-y-8 pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-start md:items-center sticky top-4 z-30",children:[e.jsxs("div",{className:"relative group flex-1 w-full md:max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(Q,{className:"h-5 w-5 text-stone-400 group-focus-within:text-emerald-500 transition-colors"})}),e.jsx("input",{type:"text",className:"block w-full pl-11 pr-4 py-3 bg-white/80 backdrop-blur-md border border-stone-200/50 rounded-2xl text-stone-900 placeholder:text-stone-400 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500/50 shadow-sm transition-all",placeholder:"Search jobs, internships, companies...",value:O,onChange:e=>R(e.target.value)})]}),e.jsx("div",{className:"flex gap-3 w-full md:w-auto overflow-x-auto pb-2 md:pb-0 px-1",children:["All","Internship","Entry Level","Full Time"].map(t=>e.jsx("button",{onClick:()=>$(t),className:"px-4 py-2.5 rounded-xl text-sm font-semibold whitespace-nowrap transition-all "+(F===t?"bg-stone-900 text-white shadow-md":"bg-white text-stone-500 hover:bg-stone-50 border border-stone-200/50"),children:t},t))}),"org"===n&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(!g),className:"hidden md:flex items-center gap-2 px-5 py-3 rounded-xl font-semibold transition-all shrink-0 "+(g?"bg-stone-900 text-white shadow-md":"bg-white text-stone-600 border border-stone-200 hover:bg-stone-50"),children:g?"All Jobs":"My Jobs"}),e.jsx("button",{onClick:()=>{L?B():E(!0)},className:"hidden md:flex items-center gap-2 px-5 py-3 bg-emerald-600 text-white rounded-xl font-semibold hover:bg-emerald-700 hover:shadow-lg hover:shadow-emerald-200 transition-all shrink-0",children:L?"Cancel":e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-5 h-5"})," Post Job"]})})]})]}),"org"===n&&e.jsx("button",{onClick:()=>E(!L),className:"md:hidden fixed bottom-24 right-6 w-14 h-14 bg-emerald-600 text-white rounded-full shadow-xl flex items-center justify-center z-50 hover:bg-emerald-700 transition-transform active:scale-95",children:L?e.jsx(M,{className:"w-6 h-6 animate-spin"}):e.jsx(ae,{className:"w-6 h-6"})}),L&&e.jsxs("div",{className:"bg-white/70 backdrop-blur-md p-6 md:p-8 rounded-[2rem] border border-white/50 shadow-[0_8px_30px_rgb(0,0,0,0.04)] animate-in slide-in-from-top-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-stone-800 mb-6 flex items-center gap-2",children:[x?e.jsx(Ae,{className:"w-6 h-6 text-emerald-600"}):e.jsx(C,{className:"w-6 h-6 text-emerald-600"}),x?"Edit Opportunity":"Post a New Opportunity"]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),h(!0);const{data:{user:t}}=await ns.auth.getUser();if(t)try{if(x){const{error:e}=await ns.from("jobs").update({...T,application_link:T.application_link||null}).eq("id",x.id);if(e)throw e;s(e=>e.map(e=>e.id===x.id?{...e,...T}:e))}else{const{data:e,error:a}=await ns.from("jobs").insert({creator_id:t.id,...T,application_link:T.application_link||null,status:"active"}).select().single();if(a)throw a;e&&s(t=>[e,...t])}E(!1),p(null),I({title:"",company:c,type:"Internship",description:"",application_link:"",location:"",salary_range:"",deadline:"",logo_url:""})}catch(a){alert("Failed to save job post.")}finally{h(!1)}},className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsx("input",{placeholder:"Job Title",required:!0,className:"w-full bg-white rounded-xl px-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.title,onChange:e=>I({...T,title:e.target.value})}),e.jsx("input",{placeholder:"Company Name",required:!0,className:"w-full bg-white rounded-xl px-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.company,onChange:e=>I({...T,company:e.target.value})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:e.jsxs("select",{className:"w-full bg-white rounded-xl px-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all appearance-none",value:T.type,onChange:e=>I({...T,type:e.target.value}),children:[e.jsx("option",{children:"Internship"}),e.jsx("option",{children:"Entry Level"}),e.jsx("option",{children:"Full Time"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-4 top-3.5 w-5 h-5 text-stone-400"}),e.jsx("input",{placeholder:"Location (e.g. Lagos, Remote)",className:"w-full bg-white rounded-xl pl-11 pr-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.location,onChange:e=>I({...T,location:e.target.value})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-4 top-3.5 w-5 h-5 text-stone-400"}),e.jsx("input",{placeholder:"Salary Range (e.g. ₦150k - ₦200k)",className:"w-full bg-white rounded-xl pl-11 pr-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.salary_range,onChange:e=>I({...T,salary_range:e.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-4 top-3.5 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"date",placeholder:"Deadline",className:"w-full bg-white rounded-xl pl-11 pr-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.deadline,onChange:e=>I({...T,deadline:e.target.value})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-4 top-3.5 w-5 h-5 text-stone-400"}),e.jsx("input",{placeholder:"Application Link (http://...)",className:"w-full bg-white rounded-xl pl-11 pr-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",value:T.application_link,onChange:e=>I({...T,application_link:e.target.value})})]})]}),e.jsx("textarea",{placeholder:"Description",rows:4,className:"w-full bg-white rounded-xl px-4 py-3 border border-stone-200 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all resize-none",value:T.description,onChange:e=>I({...T,description:e.target.value})}),e.jsxs("div",{className:"flex gap-3",children:[x&&e.jsx("button",{type:"button",onClick:B,className:"flex-1 bg-stone-100 text-stone-600 py-3.5 rounded-xl font-bold hover:bg-stone-200 transition-all",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-stone-900 text-white py-3.5 rounded-xl font-bold hover:bg-emerald-600 transition-all disabled:opacity-50",children:u?"Saving...":x?"Update Job Post":"Create Job Post"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:0===W.length?e.jsxs("div",{className:"col-span-full text-center py-20 bg-white rounded-[2rem] border border-dashed border-stone-200",children:[e.jsx(C,{className:"w-12 h-12 text-stone-200 mx-auto mb-4"}),e.jsx("p",{className:"text-stone-400 font-medium",children:"No opportunities found matching your criteria."})]}):W.map(t=>e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-stone-100 shadow-[0_2px_12px_rgba(0,0,0,0.03)] hover:shadow-[0_8px_24px_rgba(0,0,0,0.06)] transition-all group flex flex-col justify-between h-full relative",children:[l&&t.creator_id===l&&e.jsxs("div",{className:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),N(t),D(t.id)},className:"p-2 bg-stone-100 text-stone-600 rounded-full hover:bg-stone-200 hover:text-stone-900 transition-colors",title:"View Applicants",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),(e=>{p(e),I({title:e.title,company:e.company,type:e.type||"Internship",description:e.description||"",application_link:e.application_link||"",location:e.location||"",salary_range:e.salary_range||"",deadline:e.deadline?new Date(e.deadline).toISOString().split("T")[0]:"",logo_url:e.logo_url||""}),E(!0),window.scrollTo({top:0,behavior:"smooth"})})(t)},className:"p-2 bg-stone-100 text-stone-600 rounded-full hover:bg-stone-200 hover:text-stone-900 transition-colors",title:"Edit Job",children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),(async(e,t)=>{const a="active"===t?"closed":"active";s(t=>t.map(t=>t.id===e?{...t,status:a}:t));const{error:r}=await ns.from("jobs").update({status:a}).eq("id",e);r&&(alert("Failed to update status"),q())})(t.id,t.status||"active")},className:"p-2 rounded-full transition-colors "+("closed"===t.status?"bg-emerald-50 text-emerald-600 hover:bg-emerald-100":"bg-amber-50 text-amber-600 hover:bg-amber-100"),title:"closed"===t.status?"Reopen Job":"Close Job",children:"closed"===t.status?e.jsx(Le,{className:"w-4 h-4"}):e.jsx(Me,{className:"w-4 h-4"})}),e.jsx("button",{onClick:e=>{e.preventDefault(),(async e=>{if(!confirm("Are you sure you want to delete this job posting? This action cannot be undone."))return;s(t=>t.filter(t=>t.id!==e));const{error:t}=await ns.from("jobs").delete().eq("id",e);t&&(alert("Failed to delete job. You might not have permission."),q())})(t.id)},className:"p-2 bg-red-50 text-red-500 rounded-full hover:bg-red-100 hover:text-red-600 transition-colors",title:"Delete Job Post",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-emerald-50 to-teal-50 flex items-center justify-center text-emerald-600 mb-2 group-hover:scale-110 transition-transform duration-500",children:e.jsx(Ee,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex gap-2",children:["closed"===t.status&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs font-bold px-3 py-1.5 rounded-full uppercase tracking-wide",children:"Closed"}),e.jsx("span",{className:"bg-stone-50 text-stone-600 text-xs font-bold px-3 py-1.5 rounded-full uppercase tracking-wide",children:t.type})]})]}),e.jsx("h3",{className:"text-xl font-bold text-stone-900 mb-1 leading-snug",children:t.title}),e.jsx("p",{className:"text-stone-500 font-medium mb-3 flex items-center gap-1",children:t.company}),e.jsxs("div",{className:"space-y-1.5 mb-4",children:[t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-500 text-sm",children:[e.jsx(Te,{className:"w-4 h-4 text-stone-400"}),t.location]}),t.salary_range&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-500 text-sm",children:[e.jsx(De,{className:"w-4 h-4 text-stone-400"}),t.salary_range]}),t.deadline&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-500 text-sm",children:[e.jsx(Ie,{className:"w-4 h-4 text-stone-400"}),"Deadline: ",new Date(t.deadline).toLocaleDateString()]})]}),e.jsx("div",{className:"space-y-2 mb-6",children:t.description&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-stone-600 text-sm line-clamp-3 leading-relaxed",children:t.description}),e.jsx("button",{onClick:e=>{e.preventDefault(),(e=>{j(e)})(t)},className:"text-emerald-600 text-xs font-bold hover:underline mt-1",children:"View Details"})]})})]}),"closed"===t.status?e.jsxs("button",{disabled:!0,className:"w-full py-3 rounded-xl bg-stone-100 text-stone-400 font-bold text-center cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(Me,{className:"w-4 h-4"}),"Position Closed"]}):b[t.id]?e.jsxs("div",{className:"w-full py-3 rounded-xl bg-emerald-50 text-emerald-700 font-bold text-center flex items-center justify-center gap-2 cursor-default border border-emerald-100",children:[e.jsx(Le,{className:"w-4 h-4"}),b[t.id].charAt(0).toUpperCase()+b[t.id].slice(1)]}):e.jsxs("button",{onClick:()=>H(t),className:"block w-full py-3 rounded-xl bg-stone-50 text-stone-900 font-bold text-center hover:bg-stone-900 hover:text-white transition-all group-hover:shadow-lg flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Apply Now"]})]},t.id))}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/40 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden relative animate-in zoom-in-95 duration-200 flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"p-6 md:p-8 border-b border-stone-100 flex justify-between items-start bg-stone-50/50",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-emerald-100 to-teal-50 flex items-center justify-center text-emerald-600 shadow-sm",children:e.jsx(Ee,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-stone-900 leading-tight mb-2",children:w.title}),e.jsxs("div",{className:"flex flex-col gap-1.5 text-stone-500 font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:w.company})]}),w.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{children:w.location})]}),w.salary_range&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:w.salary_range})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("span",{className:"bg-stone-100 text-stone-600 text-xs font-bold px-2 py-1 rounded-md uppercase tracking-wide",children:w.type}),w.deadline&&e.jsxs("span",{className:"text-xs bg-red-50 text-red-600 px-2 py-1 rounded-md font-medium",children:["Deadline: ",new Date(w.deadline).toLocaleDateString()]})]})]})]})]}),e.jsx("button",{onClick:A,className:"p-2 bg-white text-stone-400 hover:text-stone-900 rounded-full hover:bg-stone-100 transition-all border border-stone-200/50",children:e.jsx(Me,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 md:p-8 overflow-y-auto custom-scrollbar",children:[e.jsx("h3",{className:"text-lg font-bold text-stone-900 mb-3",children:"About the Role"}),e.jsx("p",{className:"text-stone-600 leading-relaxed whitespace-pre-wrap text-[15px]",children:w.description})]}),e.jsxs("div",{className:"p-5 border-t border-stone-100 bg-stone-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:A,className:"px-6 py-3 rounded-xl font-bold text-stone-500 hover:bg-stone-200/50 transition-colors",children:"Close"}),"closed"!==w.status&&(b[w.id]?e.jsxs("button",{disabled:!0,className:"px-8 py-3 rounded-xl bg-emerald-100 text-emerald-700 font-bold flex items-center gap-2 cursor-default",children:[e.jsx(Le,{className:"w-5 h-5"}),b[w.id].charAt(0).toUpperCase()+b[w.id].slice(1)]}):e.jsxs("button",{onClick:()=>H(w),className:"px-8 py-3 rounded-xl bg-stone-900 text-white font-bold hover:bg-emerald-600 shadow-lg shadow-emerald-900/10 hover:shadow-emerald-500/30 transition-all flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),"Apply Now"]}))]})]})}),y&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-stone-900/40 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden relative animate-in zoom-in-95 duration-200 flex flex-col max-h-[85vh]",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 flex justify-between items-center bg-stone-50/50",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-stone-900",children:"Applicants"}),e.jsxs("p",{className:"text-stone-500 text-sm font-medium",children:["for ",y.title]})]}),e.jsx("button",{onClick:()=>N(null),className:"p-2 bg-white text-stone-400 hover:text-stone-900 rounded-full hover:bg-stone-100 transition-all border border-stone-200/50",children:e.jsx(Me,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-0 overflow-y-auto custom-scrollbar flex-1 bg-stone-50/30",children:U?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-500"})}):0===S.length?e.jsxs("div",{className:"text-center py-12 px-6",children:[e.jsx("div",{className:"w-16 h-16 bg-stone-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(k,{className:"w-8 h-8 text-stone-300"})}),e.jsx("p",{className:"text-stone-500 font-medium",children:"No applicants yet."})]}):e.jsx("div",{className:"divide-y divide-stone-100",children:S.map(t=>e.jsxs("div",{className:"p-4 md:p-6 bg-white hover:bg-stone-50 transition-colors flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-stone-200 flex-shrink-0 overflow-hidden",children:t.profiles?.avatar_url?e.jsx("img",{src:t.profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-emerald-100 text-emerald-600 font-bold text-lg",children:t.profiles?.name?.[0]||"?"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-stone-900",children:t.profiles?.name||"Unknown User"}),e.jsx("p",{className:"text-stone-500 text-sm",children:t.profiles?.headline||t.profiles?.university||"No headline"}),e.jsxs("p",{className:"text-stone-400 text-xs mt-0.5",children:["Applied ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex items-center gap-3 w-full md:w-auto mt-2 md:mt-0 pl-[4rem] md:pl-0",children:e.jsxs("select",{value:t.status,onChange:e=>(async(e,t,s)=>{z(e=>e.map(e=>e.user_id===t?{...e,status:s}:e));const{error:a}=await ns.from("job_applications").update({status:s}).match({job_id:e,user_id:t});a&&(D(e),alert("Failed to update status."))})(y.id,t.user_id,e.target.value),className:`\n                                                        px-3 py-2 rounded-xl text-sm font-bold border-none outline-none focus:ring-2 focus:ring-emerald-500/20 cursor-pointer transition-all\n                                                        ${"applied"===t.status?"bg-stone-100 text-stone-600":""}\n                                                        ${"interviewing"===t.status?"bg-amber-100 text-amber-700":""}\n                                                        ${"offer"===t.status?"bg-emerald-100 text-emerald-700":""}\n                                                        ${"rejected"===t.status?"bg-red-100 text-red-700":""}\n                                                    `,children:[e.jsx("option",{value:"applied",children:"Applied"}),e.jsx("option",{value:"interviewing",children:"Interviewing"}),e.jsx("option",{value:"offer",children:"Offer Sent"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})})]},t.user_id))})})]})})]})}function zr(){const[t,s]=i.useState([]),[a,r]=i.useState(!0),[n,o]=i.useState(""),[l,c]=i.useState("");i.useEffect(()=>{m()},[]);const m=async()=>{r(!0);const{data:e}=await ns.from("profiles").select("*, certificates(*)").eq("role","student").limit(100);e&&s(e),r(!1)},u=t.filter(e=>{const t=n.toLowerCase(),s=e.name.toLowerCase().includes(t)||e.headline?.toLowerCase().includes(t)||e.skills?.some(e=>e.toLowerCase().includes(t)),a=!l||e.university?.toLowerCase().includes(l.toLowerCase());return s&&a});return e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 font-display",children:"Talent Discovery"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Find the perfect candidates for your organization based on skills and verification."})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-slate-200 mb-8 flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, skill, or headline...",value:n,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-100 rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 transition-all font-medium"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Filter by University...",value:l,onChange:e=>c(e.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-100 rounded-xl outline-none focus:ring-2 focus:ring-indigo-100 transition-all font-medium"})]})]}),a?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-32 bg-slate-100 rounded-2xl animate-pulse"},t))}):u.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:u.map(t=>e.jsx("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 hover:border-indigo-200 hover:shadow-md transition-all group",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-slate-100 shrink-0",children:e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}`,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[t.name,t.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50"}):t.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50"}):null]}),e.jsx("p",{className:"text-slate-500 font-medium",children:t.headline||"Student"})]}),e.jsxs(d,{to:`/app/profile/${t.username||t.id}`,className:"px-4 py-2 bg-slate-50 text-slate-600 font-semibold text-sm rounded-xl group-hover:bg-indigo-600 group-hover:text-white transition-colors flex items-center gap-2",children:["View Profile ",e.jsx(U,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-400 mt-2",children:[t.university&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3.5 h-3.5"}),t.university]}),t.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-3.5 h-3.5"}),t.location]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t.skills&&t.skills.slice(0,5).map(t=>e.jsx("span",{className:"px-2.5 py-1 bg-indigo-50 text-indigo-600 text-xs font-bold rounded-lg",children:t},t)),t.certificates&&t.certificates.length>0&&e.jsxs("span",{className:"px-2.5 py-1 bg-orange-50 text-orange-600 text-xs font-bold rounded-lg flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3"})," ",t.certificates.length," Verified Certs"]})]})]})]})},t.id))}):e.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-300",children:e.jsx(Q,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"No candidates found"}),e.jsx("p",{className:"text-slate-500",children:"Try adjusting your filters to see more results."})]})]})}var Ur=Object.defineProperty,Pr=(e,t,s)=>((e,t,s)=>t in e?Ur(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);const Ar={x:0,y:0,width:0,height:0,unit:"px"},Dr=(e,t,s)=>Math.min(Math.max(e,t),s),Lr=(e,t)=>e===t||e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y&&e.unit===t.unit;function Mr(e,t,s){return"%"===e.unit?{...Ar,...e,unit:"%"}:{unit:"%",x:e.x?e.x/t*100:0,y:e.y?e.y/s*100:0,width:e.width?e.width/t*100:0,height:e.height?e.height/s*100:0}}function Er(e,t,s){return e.unit?"px"===e.unit?{...Ar,...e,unit:"px"}:{unit:"px",x:e.x?e.x*t/100:0,y:e.y?e.y*s/100:0,width:e.width?e.width*t/100:0,height:e.height?e.height*s/100:0}:{...Ar,...e,unit:"px"}}function Tr(e,t,s,a,r,n=0,i=0,o=a,l=r){const d={...e};let c=Math.min(n,a),m=Math.min(i,r),u=Math.min(o,a),h=Math.min(l,r);t&&(t>1?(c=i?i*t:c,m=c/t,u=o*t):(m=n?n/t:m,c=m*t,h=l/t)),d.y<0&&(d.height=Math.max(d.height+d.y,m),d.y=0),d.x<0&&(d.width=Math.max(d.width+d.x,c),d.x=0);const x=a-(d.x+d.width);x<0&&(d.x=Math.min(d.x,a-c),d.width+=x);const p=r-(d.y+d.height);if(p<0&&(d.y=Math.min(d.y,r-m),d.height+=p),d.width<c&&(("sw"===s||"nw"==s)&&(d.x-=c-d.width),d.width=c),d.height<m&&(("nw"===s||"ne"==s)&&(d.y-=m-d.height),d.height=m),d.width>u&&(("sw"===s||"nw"==s)&&(d.x-=u-d.width),d.width=u),d.height>h&&(("nw"===s||"ne"==s)&&(d.y-=h-d.height),d.height=h),t){const e=d.width/d.height;if(e<t){const e=Math.max(d.width/t,m);("nw"===s||"ne"==s)&&(d.y-=e-d.height),d.height=e}else if(e>t){const e=Math.max(d.height*t,c);("sw"===s||"nw"==s)&&(d.x-=e-d.width),d.width=e}}return d}const Ir={capture:!0,passive:!1};let Or=0;const Rr=class e extends i.PureComponent{constructor(){super(...arguments),Pr(this,"docMoveBound",!1),Pr(this,"mouseDownOnCrop",!1),Pr(this,"dragStarted",!1),Pr(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),Pr(this,"componentRef",i.createRef()),Pr(this,"mediaRef",i.createRef()),Pr(this,"resizeObserver"),Pr(this,"initChangeCalled",!1),Pr(this,"instanceId","rc-"+Or++),Pr(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),Pr(this,"onCropPointerDown",e=>{const{crop:t,disabled:s}=this.props,a=this.getBox();if(!t)return;const r=Er(t,a.width,a.height);if(s)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const n=e.target.dataset.ord,i=!!n;let o=e.clientX,l=e.clientY,d=r.x,c=r.y;if(n){const t=e.clientX-a.x,s=e.clientY-a.y;let i=0,m=0;"ne"===n||"e"==n?(i=t-(r.x+r.width),m=s-r.y,d=r.x,c=r.y+r.height):"se"===n||"s"===n?(i=t-(r.x+r.width),m=s-(r.y+r.height),d=r.x,c=r.y):"sw"===n||"w"==n?(i=t-r.x,m=s-(r.y+r.height),d=r.x+r.width,c=r.y):("nw"===n||"n"==n)&&(i=t-r.x,m=s-r.y,d=r.x+r.width,c=r.y+r.height),o=d+a.x+i,l=c+a.y+m}this.evData={startClientX:o,startClientY:l,startCropX:d,startCropY:c,clientX:e.clientX,clientY:e.clientY,isResize:i,ord:n},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),Pr(this,"onComponentPointerDown",e=>{const{crop:t,disabled:s,locked:a,keepSelection:r,onChange:n}=this.props,i=this.getBox();if(s||a||r&&t)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const o=e.clientX-i.x,l=e.clientY-i.y,d={unit:"px",x:o,y:l,width:0,height:0};this.evData={startClientX:e.clientX,startClientY:e.clientY,startCropX:o,startCropY:l,clientX:e.clientX,clientY:e.clientY,isResize:!0},this.mouseDownOnCrop=!0,n(Er(d,i.width,i.height),Mr(d,i.width,i.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),Pr(this,"onDocPointerMove",e=>{const{crop:t,disabled:s,onChange:a,onDragStart:r}=this.props,n=this.getBox();if(s||!t||!this.mouseDownOnCrop)return;e.cancelable&&e.preventDefault(),this.dragStarted||(this.dragStarted=!0,r&&r(e));const{evData:i}=this;let o;i.clientX=e.clientX,i.clientY=e.clientY,o=i.isResize?this.resizeCrop():this.dragCrop(),Lr(t,o)||a(Er(o,n.width,n.height),Mr(o,n.width,n.height))}),Pr(this,"onComponentKeyDown",t=>{const{crop:s,disabled:a,onChange:r,onComplete:n}=this.props;if(a)return;const i=t.key;let o=!1;if(!s)return;const l=this.getBox(),d=this.makePixelCrop(l),c=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?e.nudgeStepLarge:t.shiftKey?e.nudgeStepMedium:e.nudgeStep;if("ArrowLeft"===i?(d.x-=c,o=!0):"ArrowRight"===i?(d.x+=c,o=!0):"ArrowUp"===i?(d.y-=c,o=!0):"ArrowDown"===i&&(d.y+=c,o=!0),o){t.cancelable&&t.preventDefault(),d.x=Dr(d.x,0,l.width-d.width),d.y=Dr(d.y,0,l.height-d.height);const e=Er(d,l.width,l.height),s=Mr(d,l.width,l.height);r(e,s),n&&n(e,s)}}),Pr(this,"onHandlerKeyDown",(t,s)=>{const{aspect:a=0,crop:r,disabled:n,minWidth:i=0,minHeight:o=0,maxWidth:l,maxHeight:d,onChange:c,onComplete:m}=this.props,u=this.getBox();if(n||!r)return;if("ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"ArrowLeft"!==t.key&&"ArrowRight"!==t.key)return;t.stopPropagation(),t.preventDefault();const h=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?e.nudgeStepLarge:t.shiftKey?e.nudgeStepMedium:e.nudgeStep,x=function(e,t,s,a){const r={...e};return"ArrowLeft"===t?"nw"===a?(r.x-=s,r.y-=s,r.width+=s,r.height+=s):"w"===a?(r.x-=s,r.width+=s):"sw"===a?(r.x-=s,r.width+=s,r.height+=s):"ne"===a?(r.y+=s,r.width-=s,r.height-=s):"e"===a?r.width-=s:"se"===a&&(r.width-=s,r.height-=s):"ArrowRight"===t&&("nw"===a?(r.x+=s,r.y+=s,r.width-=s,r.height-=s):"w"===a?(r.x+=s,r.width-=s):"sw"===a?(r.x+=s,r.width-=s,r.height-=s):"ne"===a?(r.y-=s,r.width+=s,r.height+=s):"e"===a?r.width+=s:"se"===a&&(r.width+=s,r.height+=s)),"ArrowUp"===t?"nw"===a?(r.x-=s,r.y-=s,r.width+=s,r.height+=s):"n"===a?(r.y-=s,r.height+=s):"ne"===a?(r.y-=s,r.width+=s,r.height+=s):"sw"===a?(r.x+=s,r.width-=s,r.height-=s):"s"===a?r.height-=s:"se"===a&&(r.width-=s,r.height-=s):"ArrowDown"===t&&("nw"===a?(r.x+=s,r.y+=s,r.width-=s,r.height-=s):"n"===a?(r.y+=s,r.height-=s):"ne"===a?(r.y+=s,r.width-=s,r.height-=s):"sw"===a?(r.x-=s,r.width+=s,r.height+=s):"s"===a?r.height+=s:"se"===a&&(r.width+=s,r.height+=s)),r}(Er(r,u.width,u.height),t.key,h,s),p=Tr(x,a,s,u.width,u.height,i,o,l,d);if(!Lr(r,p)){const e=Mr(p,u.width,u.height);c(p,e),m&&m(p,e)}}),Pr(this,"onDocPointerDone",e=>{const{crop:t,disabled:s,onComplete:a,onDragEnd:r}=this.props,n=this.getBox();this.unbindDocMove(),!s&&t&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,r&&r(e),a&&a(Er(t,n.width,n.height),Mr(t,n.width,n.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),Pr(this,"onDragFocus",()=>{var e;null==(e=this.componentRef.current)||e.scrollTo(0,0)})}get document(){return document}getBox(){const e=this.mediaRef.current;if(!e)return{x:0,y:0,width:0,height:0};const{x:t,y:s,width:a,height:r}=e.getBoundingClientRect();return{x:t,y:s,width:a,height:r}}componentDidUpdate(e){const{crop:t,onComplete:s}=this.props;if(s&&!e.crop&&t){const{width:e,height:a}=this.getBox();e&&a&&s(Er(t,e,a),Mr(t,e,a))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,Ir),this.document.addEventListener("pointerup",this.onDocPointerDone,Ir),this.document.addEventListener("pointercancel",this.onDocPointerDone,Ir),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,Ir),this.document.removeEventListener("pointerup",this.onDocPointerDone,Ir),this.document.removeEventListener("pointercancel",this.onDocPointerDone,Ir),this.docMoveBound=!1)}getCropStyle(){const{crop:e}=this.props;if(e)return{top:`${e.y}${e.unit}`,left:`${e.x}${e.unit}`,width:`${e.width}${e.unit}`,height:`${e.height}${e.unit}`}}dragCrop(){const{evData:e}=this,t=this.getBox(),s=this.makePixelCrop(t),a=e.clientX-e.startClientX,r=e.clientY-e.startClientY;return s.x=Dr(e.startCropX+a,0,t.width-s.width),s.y=Dr(e.startCropY+r,0,t.height-s.height),s}getPointRegion(e,t,s,a){const{evData:r}=this,n=r.clientX-e.x,i=r.clientY-e.y;let o,l;return o=a&&t?"nw"===t||"n"===t||"ne"===t:i<r.startCropY,l=s&&t?"nw"===t||"w"===t||"sw"===t:n<r.startCropX,l?o?"nw":"sw":o?"ne":"se"}resolveMinDimensions(e,t,s=0,a=0){const r=Math.min(s,e.width),n=Math.min(a,e.height);return t&&(r||n)?t>1?r?[r,r/t]:[n*t,n]:n?[n*t,n]:[r,r/t]:[r,n]}resizeCrop(){const{evData:t}=this,{aspect:s=0,maxWidth:a,maxHeight:r}=this.props,n=this.getBox(),[i,o]=this.resolveMinDimensions(n,s,this.props.minWidth,this.props.minHeight);let l=this.makePixelCrop(n);const d=this.getPointRegion(n,t.ord,i,o),c=t.ord||d;let m=t.clientX-t.startClientX,u=t.clientY-t.startClientY;(i&&"nw"===c||"w"===c||"sw"===c)&&(m=Math.min(m,-i)),(o&&"nw"===c||"n"===c||"ne"===c)&&(u=Math.min(u,-o));const h={unit:"px",x:0,y:0,width:0,height:0};"ne"===d?(h.x=t.startCropX,h.width=m,s?(h.height=h.width/s,h.y=t.startCropY-h.height):(h.height=Math.abs(u),h.y=t.startCropY-h.height)):"se"===d?(h.x=t.startCropX,h.y=t.startCropY,h.width=m,h.height=s?h.width/s:u):"sw"===d?(h.x=t.startCropX+m,h.y=t.startCropY,h.width=Math.abs(m),h.height=s?h.width/s:u):"nw"===d&&(h.x=t.startCropX+m,h.width=Math.abs(m),s?(h.height=h.width/s,h.y=t.startCropY-h.height):(h.height=Math.abs(u),h.y=t.startCropY+u));const x=Tr(h,s,d,n.width,n.height,i,o,a,r);return s||e.xyOrds.indexOf(c)>-1?l=x:e.xOrds.indexOf(c)>-1?(l.x=x.x,l.width=x.width):e.yOrds.indexOf(c)>-1&&(l.y=x.y,l.height=x.height),l.x=Dr(l.x,0,n.width-l.width),l.y=Dr(l.y,0,n.height-l.height),l}renderCropSelection(){const{ariaLabels:t=e.defaultProps.ariaLabels,disabled:s,locked:a,renderSelectionAddon:r,ruleOfThirds:n,crop:i}=this.props,o=this.getCropStyle();if(i)return l.createElement("div",{style:o,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!s&&!a&&l.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},l.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),l.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),l.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),l.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"nw"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"n"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"ne"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"e"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"se"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"s"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"sw"),role:"button"}),l.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:e=>this.onHandlerKeyDown(e,"w"),role:"button"})),r&&l.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:e=>e.stopPropagation()},r(this.state)),n&&l.createElement(l.Fragment,null,l.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),l.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(e){return Er({...Ar,...this.props.crop||{}},e.width,e.height)}render(){const{aspect:e,children:t,circularCrop:s,className:a,crop:r,disabled:n,locked:i,style:o,ruleOfThirds:d}=this.props,{cropIsActive:c,newCropIsBeingDrawn:m}=this.state,u=r?this.renderCropSelection():null,h=((...e)=>e.filter(e=>e&&"string"==typeof e).join(" "))("ReactCrop",a,c&&"ReactCrop--active",n&&"ReactCrop--disabled",i&&"ReactCrop--locked",m&&"ReactCrop--new-crop",r&&e&&"ReactCrop--fixed-aspect",r&&s&&"ReactCrop--circular-crop",r&&d&&"ReactCrop--rule-of-thirds",!this.dragStarted&&r&&!r.width&&!r.height&&"ReactCrop--invisible-crop",s&&"ReactCrop--no-animate");return l.createElement("div",{ref:this.componentRef,className:h,style:o},l.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},t),r?l.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},l.createElement("defs",null,l.createElement("mask",{id:`hole-${this.instanceId}`},l.createElement("rect",{width:"100%",height:"100%",fill:"white"}),s?l.createElement("ellipse",{cx:`${r.x+r.width/2}${r.unit}`,cy:`${r.y+r.height/2}${r.unit}`,rx:`${r.width/2}${r.unit}`,ry:`${r.height/2}${r.unit}`,fill:"black"}):l.createElement("rect",{x:`${r.x}${r.unit}`,y:`${r.y}${r.unit}`,width:`${r.width}${r.unit}`,height:`${r.height}${r.unit}`,fill:"black"}))),l.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,u)}};Pr(Rr,"xOrds",["e","w"]),Pr(Rr,"yOrds",["n","s"]),Pr(Rr,"xyOrds",["nw","ne","se","sw"]),Pr(Rr,"nudgeStep",1),Pr(Rr,"nudgeStepMedium",10),Pr(Rr,"nudgeStepLarge",100),Pr(Rr,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}});let Fr=Rr;function $r({imageUrl:t,onCropComplete:s,onCancel:a,aspectRatio:r=1}){const[n,o]=i.useState({unit:"%",width:80,height:1===r?80:60,x:10,y:1===r?10:20}),[l,d]=i.useState(null),[c,m]=i.useState(null),[u,h]=i.useState(0);return e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"p-6 border-b border-stone-200 dark:border-zinc-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100",children:"Crop Image"}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400 mt-1",children:"Drag to reposition • Resize corners to zoom"})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-stone-100 dark:hover:bg-zinc-800 rounded-lg transition-colors",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("button",{onClick:()=>{h(e=>(e+90)%360)},className:"flex items-center gap-2 px-4 py-2 bg-stone-100 dark:bg-zinc-800 hover:bg-stone-200 dark:hover:bg-zinc-700 rounded-lg transition-colors",children:[e.jsx(Oe,{className:"w-4 h-4"}),"Rotate 90°"]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Fr,{crop:n,onChange:e=>o(e),onComplete:e=>d(e),aspect:r,circularCrop:1===r,children:e.jsx("img",{ref:m,src:t,alt:"Crop preview",style:{maxHeight:"60vh",transform:`rotate(${u}deg)`}})})})]}),e.jsxs("div",{className:"p-6 border-t border-stone-200 dark:border-zinc-800 flex gap-3 justify-end",children:[e.jsx("button",{onClick:a,className:"px-6 py-2.5 border border-stone-300 dark:border-zinc-700 rounded-lg hover:bg-stone-50 dark:hover:bg-zinc-800 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{if(!l||!c)return;const e=document.createElement("canvas"),t=c.naturalWidth/c.width,a=c.naturalHeight/c.height,r=e.getContext("2d");if(!r)return;const n=window.devicePixelRatio;if(e.width=l.width*t*n,e.height=l.height*a*n,r.setTransform(n,0,0,n,0,0),r.imageSmoothingQuality="high",0!==u){const t=e.width/2,s=e.height/2;r.translate(t,s),r.rotate(u*Math.PI/180),r.translate(-t,-s)}r.drawImage(c,l.x*t,l.y*a,l.width*t,l.height*a,0,0,l.width*t,l.height*a),e.toBlob(e=>{e&&s(e)},"image/jpeg",.95)},className:"px-6 py-2.5 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Apply Crop"]})]})]})})}function qr({profile:t}){const s=()=>{let e=0;return t.linkedin_url&&e++,t.github_url&&e++,t.twitter_url&&e++,t.instagram_url&&e++,t.facebook_url&&e++,(t.website_url||t.website)&&e++,e},{checks:a,percentage:r}=(()=>{const e=[{label:"Profile Picture",completed:!!t.avatar_url,weight:15},{label:"Headline",completed:!!t.headline&&t.headline.length>10,weight:10},{label:"About",completed:!!t.about&&t.about.length>50,weight:15},{label:"Location",completed:!!t.location,weight:5},{label:"Skills (3+)",completed:!!t.skills&&t.skills.length>=3,weight:15},{label:"Experience",completed:!!t.experience&&t.experience.length>=1,weight:20},{label:"Social Links (2+)",completed:s()>=2,weight:10},{label:"Resume",completed:!!t.resume_url,weight:10}],a=e.reduce((e,t)=>e+t.weight,0),r=e.filter(e=>e.completed).reduce((e,t)=>e+t.weight,0);return{checks:e,percentage:Math.round(r/a*100)}})();return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-stone-200 dark:border-zinc-800 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-stone-900 dark:text-zinc-100",children:"Profile Completion"}),e.jsxs("span",{className:"text-2xl font-bold "+(r>=80?"text-emerald-600 dark:text-emerald-500":r>=50?"text-yellow-600 dark:text-yellow-500":"text-orange-600 dark:text-orange-500"),children:[r,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-stone-200 dark:bg-zinc-800 rounded-full overflow-hidden mb-6",children:e.jsx("div",{className:`h-full ${r>=80?"bg-emerald-600":r>=50?"bg-yellow-500":"bg-orange-500"} transition-all duration-500 ease-out`,style:{width:`${r}%`}})}),e.jsx("div",{className:"space-y-3",children:a.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3",children:[t.completed?e.jsx(N,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-500 flex-shrink-0"}):e.jsx(Re,{className:"w-5 h-5 text-stone-300 dark:text-zinc-700 flex-shrink-0"}),e.jsx("span",{className:"text-sm "+(t.completed?"text-stone-900 dark:text-zinc-100":"text-stone-500 dark:text-zinc-500"),children:t.label}),e.jsxs("span",{className:"ml-auto text-xs text-stone-400 dark:text-zinc-600",children:["+",t.weight,"%"]})]},s))}),r<100&&e.jsx("div",{className:"mt-6 p-4 bg-emerald-50 dark:bg-emerald-950/30 rounded-lg border border-emerald-200 dark:border-emerald-900",children:e.jsxs("p",{className:"text-sm text-emerald-800 dark:text-emerald-300",children:["💡 Complete your profile to earn up to ",e.jsx("strong",{children:"+110 bonus points"})," and stand out to recruiters!"]})})]})}function Br(){const[t,s]=i.useState(null),[a,r]=i.useState(!0),[n,o]=i.useState(!1),[l,d]=i.useState(""),[c,m]=i.useState(""),[u,h]=i.useState(""),[x,p]=i.useState(""),[g,f]=i.useState(""),[b,v]=i.useState(""),[w,y]=i.useState(""),[N,k]=i.useState([]),[S,z]=i.useState(""),[U,P]=i.useState([]),[A,L]=i.useState([]),[E,T]=i.useState(!1),[I,O]=i.useState(!1),[F,$]=i.useState({title:"",description:"",link:""}),[q,B]=i.useState({title:"",issuing_org:"",issue_date:""}),[H,K]=i.useState(""),[Y,G]=i.useState(""),[V,Q]=i.useState(""),[J,X]=i.useState(""),[te,se]=i.useState(""),[re,ne]=i.useState(""),[ie,oe]=i.useState(""),[le,de]=i.useState(""),[ce,ue]=i.useState(""),[he,xe]=i.useState(""),[pe,ge]=i.useState(""),[fe,be]=i.useState(!1),[ve,we]=i.useState(!1),[ye,Ne]=i.useState(!1),[ke,_e]=i.useState(""),Ce=i.useRef(null),Se=i.useRef(null),ze=i.useRef(null),[Ue,Pe]=i.useState(null),Ae=e=>{s(e),d(e.name||""),m(e.headline||""),h(e.location||""),p(e.university||""),f(e.avatar_url||""),v(e.about||""),k(e.skills||[]),P(e.projects||[]),L(e.certificates||[]),K(e.website||e.website_url||""),G(e.github_url||""),Q(e.linkedin_url||""),X(e.instagram_url||""),se(e.twitter_url||""),ne(e.facebook_url||""),y(e.background_image_url||""),ge(e.resume_url||""),oe(e.youtube_url||""),de(e.tiktok_url||""),ue(e.whatsapp_url||""),xe(e.industry||"")};i.useEffect(()=>{(async()=>{try{const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{data:t,error:s}=await ns.from("profiles").select("*").eq("id",e.id).single();if(s&&"PGRST116"===s.code){const{data:t}=await ns.from("profiles").insert({id:e.id,email:e.email,name:e.user_metadata.name||e.email?.split("@")[0]||"User",role:e.user_metadata?.role||"student",avatar_url:`https://ui-avatars.com/api/?name=${e.email}&background=random`}).select().single();t&&Ae(t)}else t&&Ae(t)}catch(e){}finally{r(!1)}})()},[]);const De=()=>{S.trim()&&!N.includes(S.trim())&&(k([...N,S.trim()]),z(""))};if(a)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"})});if(!t)return null;const Le="student"===t.role;return e.jsxs("div",{className:"max-w-6xl mx-auto pb-20 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-stone-900 dark:text-zinc-100",children:"Edit Profile"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{const e=t?.username||t?.id,s=`${window.location.origin}/app/profile/${e}`;navigator.clipboard.writeText(s),alert("Profile link copied!")},className:"px-4 py-2.5 bg-white dark:bg-zinc-900 text-stone-600 dark:text-zinc-400 font-medium rounded-xl border border-stone-200 dark:border-zinc-800 hover:bg-stone-50 dark:hover:bg-zinc-800 transition-all flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Share"]}),e.jsxs("button",{onClick:async()=>{if(t){o(!0);try{const e={name:l,headline:c,location:u,avatar_url:g,background_image_url:w,about:b,skills:N,projects:U,certificates:A,website_url:H,github_url:Y,linkedin_url:V,instagram_url:J,twitter_url:te,facebook_url:re,resume_url:pe,youtube_url:ie,tiktok_url:le,whatsapp_url:ce,industry:"org"===t.role?he:null,university:"student"===t.role?x:null,updated_at:(new Date).toISOString()},{error:a}=await ns.from("profiles").update(e).eq("id",t.id);if(a)throw a;s({...t,...e}),Promise.resolve(ns.rpc("award_profile_completion_bonus",{p_user_id:t.id})).catch(()=>{}),alert("Profile updated successfully!")}catch(e){alert("Failed to update profile.")}finally{o(!1)}}},disabled:n,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2.5 rounded-xl font-medium transition-all shadow-lg disabled:opacity-70 flex items-center gap-2",children:[n?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(Fe,{className:"w-4 h-4"}),"Save Changes"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsx(qr,{profile:t}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-stone-200 dark:border-zinc-800 overflow-hidden",children:[e.jsxs("div",{className:"relative h-32 bg-gradient-to-br from-emerald-500 to-teal-600 group cursor-pointer",onClick:()=>Se.current?.click(),children:[w&&e.jsx("img",{src:w,alt:"Background",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx($e,{className:"w-6 h-6 text-white drop-shadow-md"})})]}),e.jsx("input",{type:"file",ref:Se,className:"hidden",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){if(t.size>10485760)return void alert("Image must be less than 10MB");const e=new FileReader;e.onloadend=()=>{_e(e.result),Ne(!0)},e.readAsDataURL(t)}}}),e.jsx("div",{className:"px-6 pb-6 relative",children:e.jsxs("div",{className:"flex flex-col items-center text-center -mt-16",children:[e.jsxs("div",{className:"w-32 h-32 rounded-full border-4 border-white dark:border-zinc-900 overflow-hidden mb-4 relative group shadow-lg bg-white",children:[e.jsx("img",{src:g||`https://ui-avatars.com/api/?name=${encodeURIComponent(l)}&background=10b981&color=fff`,alt:"Profile",className:"w-full h-full object-cover"}),e.jsx("div",{onClick:()=>Ce.current?.click(),className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",children:e.jsx($e,{className:"w-8 h-8 text-white"})})]}),e.jsx("input",{type:"file",ref:Ce,className:"hidden",accept:"image/*",onChange:e=>{const t=e.target.files?.[0];if(t){if(t.size>10485760)return void alert("Image must be less than 10MB");const e=new FileReader;e.onloadend=()=>{_e(e.result),we(!0)},e.readAsDataURL(t)}}}),e.jsxs("div",{className:"w-full space-y-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-semibold text-stone-400 dark:text-zinc-500 uppercase tracking-wider flex items-center gap-1 justify-center",children:[Le?"Full Name":"Company Name",t?.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50"}),t?.is_verified&&!t?.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50"})]}),e.jsx("input",{type:"text",value:l,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm font-medium text-stone-900 dark:text-zinc-100 focus:outline-none focus:border-emerald-500 mt-1",placeholder:Le?"Your Name":"Company Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-stone-400 dark:text-zinc-500 uppercase tracking-wider",children:Le?"Headline":"Industry"}),e.jsx("input",{type:"text",value:c,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500 mt-1",placeholder:Le?"Software Engineer | Designer":"FinTech | EdTech"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-stone-400 dark:text-zinc-500 uppercase tracking-wider",children:"Location"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Te,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"text",value:u,onChange:e=>h(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"Lagos, Nigeria"})]})]}),Le?e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-stone-400 dark:text-zinc-500 uppercase tracking-wider",children:"University"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(Z,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"text",value:x,onChange:e=>p(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"University Name"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-stone-400 dark:text-zinc-500 uppercase tracking-wider",children:"Industry"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(C,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"text",value:he,onChange:e=>xe(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"e.g. FinTech, EdTech, Healthcare"})]})]})]})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsxs("h3",{className:"text-lg font-semibold text-stone-900 dark:text-zinc-100 mb-4 flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-emerald-600"}),"Social Links"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"email",value:t.email,disabled:!0,className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-100 dark:border-zinc-800 rounded-lg text-sm text-stone-400 dark:text-zinc-600 cursor-not-allowed"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Be,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:V,onChange:e=>Q(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"LinkedIn URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:Y,onChange:e=>G(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"GitHub URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(We,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:te,onChange:e=>se(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"X (Twitter) URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ke,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:J,onChange:e=>X(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"Instagram URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ye,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:re,onChange:e=>ne(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"Facebook URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:ie,onChange:e=>oe(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"YouTube URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:ce,onChange:e=>ue(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"WhatsApp URL"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-2.5 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"url",value:H,onChange:e=>K(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500",placeholder:"Portfolio Website"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsxs("h3",{className:"text-lg font-semibold text-stone-900 dark:text-zinc-100 mb-4 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-emerald-600"}),Le?"Skills":"Specialties"]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:N.map(t=>e.jsxs("span",{className:"px-3 py-1 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 rounded-full text-xs font-medium flex items-center gap-1",children:[t,e.jsx("button",{onClick:()=>{return e=t,void k(N.filter(t=>t!==e));var e},className:"hover:text-red-500",children:e.jsx(D,{className:"w-3 h-3"})})]},t))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:S,onChange:e=>z(e.target.value),onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),De()),className:"flex-1 px-3 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500",placeholder:"Add skill..."}),e.jsx("button",{onClick:De,className:"p-2 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-500 rounded-lg hover:bg-emerald-200 dark:hover:bg-emerald-900/50 transition-colors",children:e.jsx(ae,{className:"w-5 h-5"})})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100 mb-4",children:Le?"About Me":"About Us"}),e.jsx("textarea",{value:b,onChange:e=>v(e.target.value),className:"w-full h-32 p-4 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-xl text-sm text-stone-600 dark:text-zinc-400 focus:outline-none focus:border-emerald-500 resize-none",placeholder:Le?"Tell your story...":"Describe your company mission..."})]}),Le&&e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsxs("h3",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100 mb-4 flex items-center gap-2",children:[e.jsx(je,{className:"w-6 h-6 text-emerald-600"}),"Resume"]}),pe?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-emerald-50 dark:bg-emerald-900/30 border border-emerald-200 dark:border-emerald-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-stone-900 dark:text-zinc-100",children:"Resume.pdf"}),e.jsx("p",{className:"text-xs text-stone-500 dark:text-zinc-500",children:"Uploaded"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:pe,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-colors",children:e.jsx(Ve,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-500"})}),e.jsx("a",{href:pe,download:!0,className:"p-2 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-colors",children:e.jsx(j,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-500"})}),e.jsx("button",{onClick:()=>ze.current?.click(),className:"p-2 hover:bg-emerald-100 dark:hover:bg-emerald-900/50 rounded-lg transition-colors",children:e.jsx(Qe,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-500"})})]})]}):e.jsx("button",{onClick:()=>ze.current?.click(),disabled:fe,className:"w-full p-6 border-2 border-dashed border-stone-300 dark:border-zinc-700 rounded-xl hover:border-emerald-500 dark:hover:border-emerald-600 transition-colors flex flex-col items-center gap-3",children:fe?e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"w-8 h-8 text-stone-400 dark:text-zinc-600"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium text-stone-900 dark:text-zinc-100",children:"Upload Resume"}),e.jsx("p",{className:"text-xs text-stone-500 dark:text-zinc-500 mt-1",children:"PDF only, max 5MB"})]})]})}),e.jsx("input",{type:"file",ref:ze,className:"hidden",accept:"application/pdf",onChange:async e=>{const s=e.target.files?.[0];if(s&&t)if(s.size>10485760)alert("Resume must be less than 10MB");else if("application/pdf"===s.type)try{be(!0);const e=`${t.id}/resume_${Date.now()}.pdf`,{error:a}=await ns.storage.from("resumes").upload(e,s,{upsert:!0});if(a)throw a;const{data:{publicUrl:r}}=ns.storage.from("resumes").getPublicUrl(e);ge(r),await ns.from("profiles").update({resume_url:r}).eq("id",t.id),alert("Resume uploaded successfully!")}catch(a){alert("Failed to upload resume")}finally{be(!1)}else alert("Please upload a PDF file")}})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100",children:Le?"Projects & Experience":"Company Highlights"}),e.jsxs("button",{onClick:()=>T(!0),className:"text-sm text-emerald-600 dark:text-emerald-500 font-medium hover:text-emerald-700 dark:hover:text-emerald-400 flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"})," Add Project"]})]}),E&&e.jsxs("div",{className:"mb-8 p-6 bg-stone-50 dark:bg-zinc-800 rounded-xl border border-stone-200 dark:border-zinc-700 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Project Title",value:F.title,onChange:e=>$({...F,title:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsx("textarea",{placeholder:"Description",value:F.description,onChange:e=>$({...F,description:e.target.value}),className:"w-full h-20 px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500 resize-none"}),e.jsx("input",{type:"url",placeholder:"Project Link (Optional)",value:F.link,onChange:e=>$({...F,link:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 text-sm text-stone-500 dark:text-zinc-500 hover:text-stone-700 dark:hover:text-zinc-300",children:"Cancel"}),e.jsx("button",{onClick:()=>{F.title&&F.description&&(P([...U,F]),$({title:"",description:"",link:""}),T(!1))},className:"px-4 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700",children:"Add Project"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[U.map((t,s)=>e.jsx("div",{className:"group relative p-5 border border-stone-100 dark:border-zinc-800 rounded-xl hover:border-emerald-100 dark:hover:border-emerald-900 hover:bg-emerald-50/30 dark:hover:bg-emerald-950/20 transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-stone-900 dark:text-zinc-100 text-lg",children:t.title}),e.jsx("p",{className:"text-stone-600 dark:text-zinc-400 text-sm mt-1",children:t.description}),t.link&&e.jsxs("a",{href:t.link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-xs font-medium text-emerald-600 dark:text-emerald-500 mt-3 hover:underline",children:["View Project ",e.jsx(_,{className:"w-3 h-3"})]})]}),e.jsx("button",{onClick:()=>{return e=s,void P(U.filter((t,s)=>s!==e));var e},className:"opacity-0 group-hover:opacity-100 p-2 text-stone-400 dark:text-zinc-600 hover:text-red-500 transition-all",children:e.jsx(me,{className:"w-4 h-4"})})]})},s)),0===U.length&&!E&&e.jsx("div",{className:"text-center py-10 text-stone-400 dark:text-zinc-600 text-sm",children:"No projects added yet. Share your work!"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-8 rounded-2xl border border-stone-200 dark:border-zinc-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100",children:"Certifications"}),e.jsxs("button",{onClick:()=>O(!0),className:"text-sm text-emerald-600 dark:text-emerald-500 font-medium hover:text-emerald-700 dark:hover:text-emerald-400 flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"})," Add Certificate"]})]}),I&&e.jsxs("div",{className:"mb-8 p-6 bg-stone-50 dark:bg-zinc-800 rounded-xl border border-stone-200 dark:border-zinc-700 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Certificate Title",value:q.title,onChange:e=>B({...q,title:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsx("input",{type:"text",placeholder:"Issuing Organization",value:q.issuing_org,onChange:e=>B({...q,issuing_org:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"date",value:q.issue_date,onChange:e=>B({...q,issue_date:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsx("input",{type:"text",placeholder:"Credential ID",value:q.credential_id,onChange:e=>B({...q,credential_id:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"})]}),e.jsx("input",{type:"url",placeholder:"Credential URL (Optional)",value:q.credential_url,onChange:e=>B({...q,credential_url:e.target.value}),className:"w-full px-4 py-2 bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg text-sm focus:outline-none focus:border-emerald-500"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>O(!1),className:"px-4 py-2 text-sm text-stone-500 dark:text-zinc-500 hover:text-stone-700 dark:hover:text-zinc-300",children:"Cancel"}),e.jsx("button",{onClick:()=>{if(q.title&&q.issuing_org){const e={id:`cert-${Date.now()}`,user_id:t.id,title:q.title,issuing_org:q.issuing_org,issue_date:q.issue_date,credential_url:q.credential_url,credential_id:q.credential_id};L([...A,e]),B({title:"",issuing_org:"",issue_date:""}),O(!1)}},className:"px-4 py-2 bg-emerald-600 text-white text-sm rounded-lg hover:bg-emerald-700",children:"Add Certificate"})]})]}),e.jsxs("div",{className:"space-y-4",children:[A.map(s=>e.jsx("div",{className:"group relative p-4 border border-stone-100 dark:border-zinc-800 rounded-xl hover:border-emerald-100 dark:hover:border-emerald-900 hover:bg-emerald-50/30 dark:hover:bg-emerald-950/20 transition-all",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center flex-shrink-0",children:e.jsx(ee,{className:"w-6 h-6 text-emerald-600 dark:text-emerald-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-stone-900 dark:text-zinc-100",children:s.title}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400",children:s.issuing_org}),s.issue_date&&e.jsxs("p",{className:"text-xs text-stone-500 dark:text-zinc-500 mt-1",children:["Issued: ",new Date(s.issue_date).toLocaleDateString()]}),s.credential_url&&e.jsx("a",{href:s.credential_url,target:"_blank",rel:"noreferrer",className:"text-xs text-emerald-600 dark:text-emerald-500 hover:underline mt-2 inline-block",children:"View Credential"}),e.jsx("div",{className:"mt-3",children:s.certificate_pdf_url?e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("a",{href:s.certificate_pdf_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-emerald-600 dark:text-emerald-500 hover:underline flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"}),"View Certificate PDF"]})}):e.jsxs("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept="application/pdf,image/*",e.onchange=e=>{const a=e.target.files?.[0];a&&(async(e,s)=>{if(t)if(s.size>10485760)alert("Certificate must be less than 10MB");else try{Pe(e);const a=`${t.id}/cert_${e}_${Date.now()}.pdf`,{error:r}=await ns.storage.from("certificates").upload(a,s);if(r)throw r;const{data:{publicUrl:n}}=ns.storage.from("certificates").getPublicUrl(a);L(t=>t.map(t=>t.id===e?{...t,certificate_pdf_url:n}:t))}catch(a){alert("Failed to upload certificate PDF")}finally{Pe(null)}})(s.id,a)},e.click()},disabled:Ue===s.id,className:"text-xs text-stone-500 dark:text-zinc-500 hover:text-emerald-600 dark:hover:text-emerald-500 flex items-center gap-1",children:[Ue===s.id?e.jsx(M,{className:"w-3 h-3 animate-spin"}):e.jsx(Qe,{className:"w-3 h-3"}),"Upload Certificate PDF"]})})]}),e.jsx("button",{onClick:()=>{return e=s.id,void L(A.filter(t=>t.id!==e));var e},className:"opacity-0 group-hover:opacity-100 p-2 text-stone-400 dark:text-zinc-600 hover:text-red-500 transition-all",children:e.jsx(me,{className:"w-4 h-4"})})]})},s.id)),0===A.length&&!I&&e.jsx("div",{className:"text-center py-10 text-stone-400 dark:text-zinc-600 text-sm",children:"No certificates added yet."})]})]})]})]}),ve&&e.jsx($r,{imageUrl:ke,onCropComplete:async e=>{if(t)try{o(!0);const s=`${t.id}/avatar_${Date.now()}.jpg`,{error:a}=await ns.storage.from("avatars").upload(s,e,{upsert:!0});if(a)throw a;const{data:{publicUrl:r}}=ns.storage.from("avatars").getPublicUrl(s);f(r),await ns.from("profiles").update({avatar_url:r}).eq("id",t.id),we(!1)}catch(s){alert("Failed to upload avatar")}finally{o(!1)}},onCancel:()=>we(!1),aspectRatio:1}),ye&&e.jsx($r,{imageUrl:ke,onCropComplete:async e=>{if(t)try{o(!0);const s=`backgrounds/${t.id}_${Date.now()}.jpg`,{error:a}=await ns.storage.from("uploads").upload(s,e,{upsert:!0});if(a)throw a;const{data:{publicUrl:r}}=ns.storage.from("uploads").getPublicUrl(s);y(r),await ns.from("profiles").update({background_image_url:r}).eq("id",t.id),Ne(!1)}catch(s){alert("Failed to upload background image")}finally{o(!1)}},onCancel:()=>Ne(!1),aspectRatio:16/9})]})}function Hr(){const{requests:t,generalNotifications:s,loading:a,processing:r,handleAction:n,clearAll:o,deleteNotifications:l}=pa(),[c,m]=i.useState(new Set);return a?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"})}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-2xl border border-stone-100 shadow-sm sticky top-20 z-10",children:[e.jsxs("h1",{className:"text-xl font-bold text-stone-800 flex items-center gap-2",children:["Notifications",t.length>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-0.5 rounded-full",children:t.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c.size>0&&e.jsxs("button",{onClick:async()=>{confirm(`Delete ${c.size} notification(s)?`)&&(await l(Array.from(c)),m(new Set))},className:"bg-red-50 text-red-600 hover:bg-red-100 flex items-center gap-2 text-sm font-medium px-4 py-2 rounded-xl transition-all",children:[e.jsx(me,{className:"w-4 h-4"}),"Delete (",c.size,")"]}),s.length>0&&e.jsx("button",{onClick:async()=>{confirm("Are you sure you want to clear all notifications?")&&await o()},className:"text-stone-400 hover:text-stone-600 flex items-center gap-1 text-sm transition-colors px-3 py-2",children:e.jsx("span",{children:"Clear All"})})]})]}),e.jsx("div",{className:"space-y-6",children:0===t.length&&0===s.length?e.jsxs("div",{className:"text-center py-12 bg-white rounded-3xl border border-stone-100 border-dashed",children:[e.jsx(A,{className:"w-12 h-12 text-stone-300 mx-auto mb-3"}),e.jsx("h3",{className:"text-stone-900 font-medium",children:"No new notifications"}),e.jsx("p",{className:"text-stone-500 text-sm",children:"You're all caught up!"})]}):e.jsxs(e.Fragment,{children:[t.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-stone-500 uppercase tracking-wider pl-1",children:"Connection Requests"}),t.map(t=>e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-stone-100 shadow-sm flex items-center justify-between animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-12 h-12 rounded-full bg-stone-100 overflow-hidden relative",children:[e.jsx("img",{src:t.requester.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.requester.name)}&background=random`,alt:t.requester.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 right-0 bg-blue-500 rounded-full p-0.5 border-2 border-white",children:e.jsx(te,{className:"w-3 h-3 text-white"})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-stone-900 text-sm",children:[e.jsx("span",{className:"font-bold",children:t.requester.name})," wants to connect with you."]}),e.jsxs("p",{className:"text-xs text-stone-500 mt-0.5",children:["org"===t.requester.role?"Organization":t.requester.university," • ",new Date(t.created_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>n(t.id,"accept"),disabled:r===t.id,className:"p-2 bg-emerald-100 text-emerald-700 rounded-xl hover:bg-emerald-200 transition-colors disabled:opacity-50",title:"Accept",children:r===t.id?e.jsx(M,{className:"w-5 h-5 animate-spin"}):e.jsx(E,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>n(t.id,"reject"),disabled:r===t.id,className:"p-2 bg-stone-100 text-stone-500 rounded-xl hover:bg-red-50 hover:text-red-500 transition-colors disabled:opacity-50",title:"Reject",children:e.jsx(D,{className:"w-5 h-5"})})]})]},t.id))]}),s.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-stone-500 uppercase tracking-wider pl-1",children:"Recent Activity"}),s.map(t=>{let s=e.jsx(Je,{className:"w-5 h-5 text-stone-500"}),a="bg-stone-100",r="#";switch(t.type){case"message":s=e.jsx(Xe,{className:"w-5 h-5 text-indigo-500"}),a="bg-indigo-50",r="/app/messages";break;case"like":s=e.jsx(pe,{className:"w-5 h-5 text-red-500"}),a="bg-red-50";break;case"mention":s=e.jsx(L,{className:"w-5 h-5 text-orange-500"}),a="bg-orange-50";break;case"job_update":s=e.jsx(C,{className:"w-5 h-5 text-emerald-500"}),a="bg-emerald-50",r="/app/jobs";break;case"connection_rejected":s=e.jsx(D,{className:"w-5 h-5 text-red-500"}),a="bg-red-50";break;case"connection_accepted":s=e.jsx(E,{className:"w-5 h-5 text-green-500"}),a="bg-green-50",r="/app/network"}return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"pt-2",children:e.jsx("input",{type:"checkbox",checked:c.has(t.id),onChange:()=>(e=>{const t=new Set(c);t.has(e)?t.delete(e):t.add(e),m(t)})(t.id),className:"w-5 h-5 rounded-md border-stone-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx(d,{to:r,className:"flex-1 block bg-white p-4 rounded-2xl border border-stone-100 shadow-sm hover:border-stone-200 transition-all font-sans",onClick:()=>{},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${a}`,children:s}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-stone-900 text-sm",children:t.content}),e.jsxs("p",{className:"text-xs text-stone-400 mt-1",children:[new Date(t.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," • ",new Date(t.created_at).toLocaleDateString()]})]}),!t.read&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2"})]})})]},t.id)})]})]})})]})}function Wr(){const{userId:t}=x(),[s,a]=i.useState(null),[r,n]=i.useState(!0),[o,l]=i.useState([]),[c,m]=i.useState(null),[u,h]=i.useState(!1),[p,g]=i.useState({title:"",issuing_org:"",issue_date:"",credential_url:""}),[f,b]=i.useState(0),[v,w]=i.useState("none"),[j,y]=i.useState(!1),[N,k]=i.useState("posts"),[S,z]=i.useState(!1),[U,P]=i.useState(!1),[A,L]=i.useState([]),T="org"===s?.role,{isFollowing:I,followersCount:O,followingCount:F,toggleFollow:$,canFollow:q,loading:B}=function(e){const[t,s]=i.useState(!1),[a,r]=i.useState(!0),[n,o]=i.useState(0),[l,d]=i.useState(0),[c,m]=i.useState(null);i.useEffect(()=>{u(),h();const t=ns.channel(`followers:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"follows",filter:`following_id=eq.${e}`},()=>{h(),u()}).subscribe(),s=ns.channel(`following:${e}`).on("postgres_changes",{event:"*",schema:"public",table:"follows",filter:`follower_id=eq.${e}`},()=>{h()}).subscribe();return()=>{ns.removeChannel(t),ns.removeChannel(s)}},[e]);const u=async()=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return void r(!1);m(t.id);const{data:a,error:n}=await ns.from("follows").select("id").eq("follower_id",t.id).eq("following_id",e).maybeSingle();if(n)throw n;s(!!a)}catch(t){}finally{r(!1)}},h=async()=>{try{const{count:t}=await ns.from("follows").select("*",{count:"exact",head:!0}).eq("following_id",e),{count:s}=await ns.from("follows").select("*",{count:"exact",head:!0}).eq("follower_id",e);o(t||0),d(s||0)}catch(t){}};return{isFollowing:t,loading:a,followersCount:n,followingCount:l,toggleFollow:async()=>{if(!c||c===e)return;const a=t;s(!t);try{if(t){const{error:t}=await ns.from("follows").delete().eq("follower_id",c).eq("following_id",e);if(t)throw t}else{const{error:t}=await ns.from("follows").insert({follower_id:c,following_id:e});if(t)throw t}await h()}catch(r){s(a),"23514"===r.code?alert("You cannot follow yourself"):alert("Failed to update follow status")}},canFollow:c&&c!==e}}(s?.id||""),H=async()=>{y(!0);const{data:{user:e}}=await ns.auth.getUser();if(e&&s){if("none"===v||"rejected"===v){const{error:t}=await ns.from("connections").upsert({requester_id:e.id,recipient_id:s.id,status:"pending"},{onConflict:"requester_id,recipient_id"});t?alert(t.message):w("pending")}else if("received"===v){const{error:t}=await ns.from("connections").update({status:"accepted"}).eq("recipient_id",e.id).eq("requester_id",s.id);t||w("connected")}else if("blocked"===v){const{error:t}=await ns.from("connections").delete().match({requester_id:e.id,recipient_id:s.id});t||w("none")}y(!1)}},Y=async e=>{try{let t=ns.from("profiles").select("*, certificates(*)");t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?t.eq("id",e):t.eq("username",e.toLowerCase());const{data:s,error:r}=await t.single();a(r||!s?null:s)}catch(t){a(null)}finally{n(!1)}};i.useEffect(()=>{ns.auth.getUser().then(({data:e})=>m(e.user))},[]),i.useEffect(()=>{t&&Y(t)},[t]),i.useEffect(()=>(s&&vr({title:s.name,description:s.headline||s.about||`${s.name} on UniLink - Connect with students across Nigerian universities`,image:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&size=400&background=random`,url:window.location.href}),()=>wr()),[s]),i.useEffect(()=>{if(s?.id){(async e=>{const{data:{user:t}}=await ns.auth.getUser(),{data:s}=await ns.from("posts").select("\n                *,\n                profiles:author_id (*),\n                likes (user_id),\n                comments (id)\n            ").eq("author_id",e).order("created_at",{ascending:!1});if(s){const e=s.map(e=>({...e,likes_count:e.likes?e.likes.length:0,comments_count:e.comments?e.comments.length:0,user_has_liked:!!t&&e.likes.some(e=>e.user_id===t.id)}));l(e)}})(s.id),(async e=>{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const{data:s}=await ns.from("connections").select("*").or(`and(requester_id.eq.${t.id},recipient_id.eq.${e}),and(requester_id.eq.${e},recipient_id.eq.${t.id})`).maybeSingle();s?"blocked"===s.status?s.requester_id===t.id?w("blocked"):w("none"):"accepted"===s.status?w("connected"):"rejected"===s.status?w("rejected"):s.requester_id===t.id?w("pending"):w("received"):w("none")})(s.id);const e=()=>{ns.from("connections").select("*",{count:"exact",head:!0}).or(`requester_id.eq.${s.id},recipient_id.eq.${s.id}`).eq("status","accepted").then(({count:e})=>b(e||0))};e();const t=ns.channel(`connections:${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"connections",filter:`recipient_id=eq.${s.id}`},()=>e()).on("postgres_changes",{event:"*",schema:"public",table:"connections",filter:`requester_id=eq.${s.id}`},()=>e()).subscribe();return()=>{ns.removeChannel(t)}}},[s?.id]),i.useEffect(()=>{if(s?.id&&T){(async()=>{const{data:e}=await ns.from("jobs").select("*").eq("creator_id",s.id).order("created_at",{ascending:!1});e&&L(e)})()}},[s?.id,T]),i.useEffect(()=>{const e=e=>{"Escape"===e.key&&(S&&z(!1),U&&P(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[S,U]);return r?e.jsx("div",{className:"flex justify-center items-center min-h-screen bg-[#FAFAFA]",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"})}):s?e.jsxs("div",{className:"max-w-5xl mx-auto pb-20",children:[e.jsxs(d,{to:"/app/network",className:"inline-flex items-center gap-2 text-slate-500 hover:text-slate-800 mb-6 transition-colors font-medium",children:[e.jsx(we,{className:"w-4 h-4"})," Back to Network"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm relative overflow-hidden",children:[s.background_image_url?e.jsxs("div",{className:"absolute top-0 left-0 right-0 h-32 group/bg cursor-pointer",onClick:()=>P(!0),title:"Click to view full screen",children:[e.jsx("img",{src:s.background_image_url,alt:"Background",className:"w-full h-full object-cover opacity-90 group-hover/bg:opacity-100 transition-opacity"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-white/90"}),e.jsx("div",{className:"absolute inset-0 bg-black/30 opacity-0 group-hover/bg:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(Ze,{className:"w-8 h-8 text-white"})})]}):e.jsx("div",{className:"absolute top-0 left-0 right-0 h-24 bg-gradient-to-br from-indigo-500 to-purple-600 opacity-10"}),e.jsxs("div",{className:"flex flex-col items-center text-center relative z-10 pt-8",children:[e.jsxs("div",{className:"relative mb-4 inline-block group/avatar",children:[e.jsxs("div",{onClick:()=>z(!0),className:`w-32 h-32 ${T?"rounded-2xl":"rounded-full"} border-4 border-white shadow-lg overflow-hidden bg-white relative z-10 cursor-pointer group hover:ring-4 hover:ring-indigo-500/20 transition-all`,children:[e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=${T?"f97316":"10b981"}&color=fff`,alt:s.name,className:`w-full h-full ${T?"object-contain p-2":"object-cover"} group-hover:scale-110 transition-transform duration-300`}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(Ze,{className:"w-8 h-8 text-white"})})]}),e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),navigator.clipboard.writeText(window.location.href),alert("Profile link copied to clipboard!")},className:"absolute bottom-0 right-0 z-20 p-2.5 bg-white text-slate-500 hover:text-indigo-600 rounded-full shadow-lg border border-slate-100 transition-all hover:scale-110 hover:shadow-xl",title:"Copy Profile Link",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 flex items-center gap-1.5 justify-center",children:[s.name,s.gold_verified?e.jsx(ee,{className:"w-5 h-5 text-yellow-500 fill-yellow-50"}):s.is_verified?e.jsx(ee,{className:"w-5 h-5 text-blue-500 fill-blue-50"}):null]}),e.jsxs("p",{className:"text-stone-400 font-medium text-sm mb-3",children:["@",s.username||s.id.slice(0,6)]}),T&&e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-orange-50 border border-orange-200 text-orange-700 rounded-full text-xs font-semibold mb-3",children:[e.jsx(C,{className:"w-3.5 h-3.5"}),"Organization"]}),T&&s.industry&&e.jsx("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-emerald-50 border border-emerald-200 text-emerald-700 rounded-full text-xs font-semibold mb-3 ml-2",children:s.industry}),s.headline&&e.jsx("p",{className:"text-slate-600 font-medium mt-1 mb-3 text-sm",children:s.headline}),s.location&&e.jsxs("div",{className:"flex items-center gap-1.5 text-sm mb-2 "+(T?"text-slate-600 font-medium":"text-slate-400"),children:[e.jsx(Te,{className:"w-4 h-4"}),s.location]}),!T&&s.university&&e.jsxs("div",{className:"flex items-center gap-1 text-slate-400 text-sm",children:[e.jsx(Z,{className:"w-3.5 h-3.5"}),s.university]})]}),e.jsxs("div",{className:"flex justify-center gap-6 mt-6 border-t border-b border-stone-100 py-4 w-full",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-slate-900 text-lg",children:f}),e.jsx("div",{className:"text-xs text-slate-500 font-medium uppercase tracking-wide",children:T?"Contacts":"Connections"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-slate-900 text-lg",children:O}),e.jsx("div",{className:"text-xs text-slate-500 font-medium uppercase tracking-wide",children:"Followers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-bold text-slate-900 text-lg",children:F}),e.jsx("div",{className:"text-xs text-slate-500 font-medium uppercase tracking-wide",children:"Following"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-center gap-3",children:[s.instagram_url&&e.jsx("a",{href:s.instagram_url,target:"_blank",rel:"noreferrer",className:"p-2 text-slate-400 hover:text-pink-600 hover:bg-pink-50 rounded-full transition-all",children:e.jsx(Ke,{className:"w-5 h-5"})}),s.twitter_url&&e.jsx("a",{href:s.twitter_url,target:"_blank",rel:"noreferrer",className:"p-2 text-slate-400 hover:text-sky-500 hover:bg-sky-50 rounded-full transition-all",children:e.jsx(We,{className:"w-5 h-5"})}),s.github_url&&e.jsx("a",{href:s.github_url,target:"_blank",rel:"noreferrer",className:"p-2 text-slate-400 hover:text-slate-900 hover:bg-slate-50 rounded-full transition-all",children:e.jsx(He,{className:"w-5 h-5"})}),s.linkedin_url&&e.jsx("a",{href:s.linkedin_url,target:"_blank",rel:"noreferrer",className:"p-2 text-slate-400 hover:text-blue-700 hover:bg-blue-50 rounded-full transition-all",children:e.jsx(Be,{className:"w-5 h-5"})}),s.website&&e.jsx("a",{href:s.website,target:"_blank",rel:"noreferrer",className:"p-2 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-full transition-all",children:e.jsx(_,{className:"w-5 h-5"})}),e.jsx("a",{href:`mailto:${s.email}`,className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-full transition-all",children:e.jsx(qe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")},className:"p-2 text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-full transition-all",title:"Share Profile",children:e.jsx(R,{className:"w-5 h-5"})})]}),c&&c.id===s.id?e.jsx("div",{className:"mt-6 px-6 w-full",children:e.jsx("div",{className:"mt-6 px-6 w-full",children:e.jsxs(d,{to:"/app/profile",className:"w-full py-2.5 rounded-xl bg-slate-900 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all hover:bg-slate-800 shadow-lg shadow-slate-200 hover:shadow-slate-300",children:[e.jsx(C,{className:"w-4 h-4"})," Edit Profile"]})})}):c&&e.jsxs("div",{className:"mt-6 px-6 w-full space-y-3",children:["connected"===v?e.jsxs(e.Fragment,{children:[e.jsxs("button",{disabled:!0,className:"w-full py-2.5 rounded-xl bg-green-50 text-green-600 font-semibold text-sm flex items-center justify-center gap-2 cursor-default border border-green-200",children:[e.jsx(E,{className:"w-4 h-4"})," Connected"]}),e.jsxs("button",{onClick:async()=>{if(!confirm("Are you sure you want to disconnect?"))return;y(!0);const{data:{user:e}}=await ns.auth.getUser();if(!e||!s)return;const{error:t}=await ns.from("connections").delete().or(`and(requester_id.eq.${e.id},recipient_id.eq.${s.id}),and(requester_id.eq.${s.id},recipient_id.eq.${e.id})`);t||w("none"),y(!1)},disabled:j,className:"w-full py-2.5 rounded-xl bg-white text-stone-500 font-medium text-sm flex items-center justify-center gap-2 border border-stone-200 hover:bg-stone-50 hover:text-red-600 transition-colors",children:[e.jsx(et,{className:"w-4 h-4"})," Disconnect"]})]}):"pending"===v?e.jsxs("button",{disabled:!0,className:"w-full py-2.5 rounded-xl bg-slate-100 text-slate-500 font-medium text-sm flex items-center justify-center gap-2 cursor-default border border-slate-200",children:[e.jsx(ke,{className:"w-4 h-4"})," Pending"]}):"received"===v?e.jsxs("button",{onClick:H,disabled:j,className:"w-full py-2.5 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all shadow-lg shadow-blue-200 hover:shadow-blue-300",children:[j?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(te,{className:"w-4 h-4"}),"Accept Request"]}):"blocked"===v?e.jsxs("button",{onClick:H,disabled:j,className:"w-full py-2.5 rounded-xl bg-red-600 hover:bg-red-700 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all shadow-lg shadow-red-200",children:[j?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(tt,{className:"w-4 h-4"}),"Unblock User"]}):e.jsxs("button",{onClick:H,disabled:j,className:"w-full py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-semibold text-sm flex items-center justify-center gap-2 transition-all shadow-lg shadow-indigo-200 hover:shadow-indigo-300",children:[j?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(te,{className:"w-4 h-4"}),"Connect"]}),q&&e.jsx("button",{onClick:$,disabled:B,className:"w-full py-2.5 rounded-xl font-semibold text-sm flex items-center justify-center gap-2 transition-all "+(I?"bg-stone-100 text-stone-700 hover:bg-stone-200 border border-stone-200":"bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg shadow-indigo-200 hover:shadow-indigo-300"),children:B?e.jsx(M,{className:"w-4 h-4 animate-spin"}):I?e.jsxs(e.Fragment,{children:[e.jsx(st,{className:"w-4 h-4"}),"Following"]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4"}),"Follow"]})}),"blocked"!==v&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:async()=>{const e=prompt(`Why are you reporting ${s.name}?`);if(!e)return;const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const{error:a}=await ns.from("reports").insert({reporter_id:t.id,reported_id:s.id,reason:e,status:"pending"});a?alert("Failed to submit report."):alert("Report submitted successfully. We will review this account.")},className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-stone-50 text-stone-500 hover:bg-stone-100 rounded-xl transition-all font-medium text-sm border border-stone-200",children:[e.jsx(xe,{className:"w-4 h-4"}),"Report Account"]}),e.jsxs("button",{onClick:async()=>{if(!confirm("Are you sure you want to block this user? They will not be able to contact you."))return;y(!0);const{data:{user:e}}=await ns.auth.getUser();if(!e||!s)return;const{error:t}=await ns.from("connections").upsert({requester_id:e.id,recipient_id:s.id,status:"blocked"});t||w("blocked"),y(!1)},className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-transparent text-stone-400 hover:text-red-600 rounded-xl transition-all font-medium text-sm",children:[e.jsx(tt,{className:"w-4 h-4"}),"Block User"]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-indigo-500"}),"Skills"]}),s.skills&&s.skills.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.skills.map(t=>e.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-700 rounded-full text-xs font-medium",children:t},t))}):e.jsx("p",{className:"text-slate-400 italic text-sm",children:"No skills listed."})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.about&&e.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm relative",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-indigo-500"})," About"]}),e.jsx("p",{className:"text-slate-600 leading-relaxed whitespace-pre-wrap",children:s.about})]}),s.experience&&s.experience.length>0&&e.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-indigo-500"})," Experience"]}),e.jsx("div",{className:"space-y-6",children:s.experience.map((t,s)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-50 flex items-center justify-center text-indigo-600 shrink-0 border border-indigo-100",children:e.jsx(C,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg",children:t.title}),e.jsx("p",{className:"font-medium text-slate-700",children:t.company}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium bg-slate-100 inline-block px-2 py-0.5 rounded-full",children:[new Date(t.start_date).getFullYear()," -",t.current?"Present":t.end_date?new Date(t.end_date).getFullYear():""]}),t.description&&e.jsx("p",{className:"text-sm text-slate-600 mt-2 leading-relaxed",children:t.description})]})]},s))})]}),(c?.id===s.id||s.certificates&&s.certificates.length>0)&&e.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-900 flex items-center gap-2",children:[e.jsx(at,{className:"w-5 h-5 text-indigo-500"})," Certificates"]}),c?.id===s.id&&e.jsx("button",{onClick:()=>h(!0),className:"text-sm font-semibold text-indigo-600 hover:text-indigo-700 bg-indigo-50 px-3 py-1.5 rounded-lg transition-colors",children:"+ Add"})]}),e.jsx("div",{className:"space-y-4",children:s.certificates&&s.certificates.length>0?s.certificates.map(t=>e.jsxs("div",{className:"flex gap-4 p-4 border border-slate-100 rounded-xl hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-orange-50 flex items-center justify-center text-orange-600 shrink-0 border border-orange-100",children:e.jsx(at,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:t.title}),e.jsx("p",{className:"font-medium text-slate-700",children:t.issuing_org}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Issued ",t.issue_date?new Date(t.issue_date).toLocaleDateString():"Unknown date"]}),t.credential_url&&e.jsxs("a",{href:t.credential_url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-xs font-medium text-indigo-600 mt-2 hover:underline",children:["Verify Credential ",e.jsx(ue,{className:"w-3 h-3"})]})]})]},t.id)):e.jsx("p",{className:"text-slate-400 italic text-sm",children:"No certificates added yet."})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Add Certificate"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Certificate Title"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",value:p.title,onChange:e=>g({...p,title:e.target.value}),placeholder:"e.g. AWS Certified Developer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Issuing Organization"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",value:p.issuing_org,onChange:e=>g({...p,issuing_org:e.target.value}),placeholder:"e.g. Amazon Web Services"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Issue Date"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",value:p.issue_date,onChange:e=>g({...p,issue_date:e.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Credential URL (Optional)"}),e.jsx("input",{type:"url",className:"w-full px-3 py-2 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 outline-none transition-all",value:p.credential_url,onChange:e=>g({...p,credential_url:e.target.value}),placeholder:"https://..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-slate-500 hover:text-slate-800 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!p.title||!p.issuing_org)return;const{data:{user:e}}=await ns.auth.getUser();if(!e)return;const{error:s}=await ns.from("certificates").insert({user_id:e.id,...p,issue_date:p.issue_date||null});s?alert("Failed to add certificate."):(h(!1),g({title:"",issuing_org:"",issue_date:"",credential_url:""}),t&&Y(t))},className:"px-4 py-2 bg-indigo-600 text-white rounded-xl font-medium hover:bg-indigo-700 transition-colors shadow-sm",children:"Save Certificate"})]})]})})]}),e.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-4",children:"About"}),s.about?e.jsx("p",{className:"text-slate-600 leading-relaxed whitespace-pre-line",children:s.about}):e.jsx("p",{className:"text-slate-400 italic",children:"No bio provided."})]}),s.projects&&s.projects.length>0&&e.jsxs("div",{className:"bg-white p-8 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-6",children:"Projects"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.projects.map((t,s)=>e.jsxs("div",{className:"p-5 border border-slate-100 rounded-xl hover:bg-slate-50 transition-colors",children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg",children:t.title}),e.jsx("p",{className:"text-slate-600 text-sm mt-1",children:t.description}),t.link&&e.jsxs("a",{href:t.link,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-xs font-medium text-indigo-600 mt-3 hover:underline",children:["View Project ",e.jsx(_,{className:"w-3 h-3"})]})]},s))})]}),T&&e.jsxs("div",{className:"flex gap-2 border-b border-stone-200 mb-6",children:[e.jsxs("button",{onClick:()=>k("posts"),className:"px-6 py-3 font-semibold text-sm transition-all relative "+("posts"===N?"text-emerald-600":"text-stone-500 hover:text-stone-700"),children:["Posts","posts"===N&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]}),e.jsxs("button",{onClick:()=>k("jobs"),className:"px-6 py-3 font-semibold text-sm transition-all relative "+("jobs"===N?"text-emerald-600":"text-stone-500 hover:text-stone-700"),children:["Jobs (",A.length,")","jobs"===N&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-emerald-600"})]})]}),(!T||"posts"===N)&&o.length>0&&e.jsxs("div",{className:"space-y-6",children:[!T&&e.jsx("h3",{className:"text-xl font-bold text-slate-900 px-2",children:"Recent Activity"}),o.map(t=>e.jsxs("article",{className:"bg-white rounded-[2rem] p-6 shadow-sm border border-stone-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden bg-stone-100",children:e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=random`,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-stone-900 text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-stone-400",children:new Date(t.created_at).toLocaleDateString()})]})]}),c?.id===s.id&&e.jsx("button",{onClick:()=>(async e=>{if(!confirm("Are you sure you want to delete this post? This action cannot be undone."))return;const{error:t}=await ns.from("posts").delete().eq("id",e);t?alert("Failed to delete post."):l(t=>t.filter(t=>t.id!==e))})(t.id),className:"text-stone-400 hover:text-red-500 transition-colors p-1",title:"Delete Post",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-stone-600 leading-relaxed mb-4 text-sm",children:t.content||""}),e.jsxs("div",{className:"flex items-center gap-4 text-stone-400 text-xs font-medium",children:[e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("button",{onClick:()=>(async e=>{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const s=e.user_has_liked,a=s?(e.likes_count||0)-1:(e.likes_count||0)+1;l(t=>t.map(t=>t.id===e.id?{...t,user_has_liked:!s,likes_count:a}:t)),s?await ns.from("likes").delete().match({post_id:e.id,user_id:t.id}):await ns.from("likes").insert({post_id:e.id,user_id:t.id})})(t),className:"flex items-center gap-1 hover:text-red-500 transition-colors "+(t.user_has_liked?"text-red-500":""),children:[e.jsx(pe,{className:"w-4 h-4 "+(t.user_has_liked?"fill-current":"")}),e.jsx("span",{children:t.likes_count})]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"})," ",t.comments_count]})]})]},t.id))]}),T&&"jobs"===N&&e.jsx("div",{className:"space-y-6",children:A.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:A.map(t=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-stone-100 shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 flex items-center justify-center text-emerald-600",children:e.jsx(C,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex gap-2",children:["closed"===t.status&&e.jsx("span",{className:"bg-red-100 text-red-700 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:"Closed"}),e.jsx("span",{className:"bg-stone-50 text-stone-600 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide",children:t.type})]})]}),e.jsx("h3",{className:"text-lg font-bold text-stone-900 mb-1",children:t.title}),e.jsx("p",{className:"text-stone-500 font-medium text-sm mb-3",children:t.company}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-stone-500 text-sm mb-2",children:[e.jsx(Te,{className:"w-4 h-4 text-stone-400"}),t.location]}),t.description&&e.jsx("p",{className:"text-stone-600 text-sm line-clamp-2 leading-relaxed mb-3",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-stone-100",children:[e.jsxs("span",{className:"text-xs text-stone-400",children:["Posted ",new Date(t.created_at).toLocaleDateString()]}),e.jsx(d,{to:"/app/jobs",className:"text-emerald-600 text-sm font-semibold hover:text-emerald-700 transition-colors",children:"View Details →"})]})]},t.id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl border border-dashed border-stone-200",children:[e.jsx(C,{className:"w-12 h-12 text-stone-200 mx-auto mb-4"}),e.jsx("p",{className:"text-stone-400 font-medium",children:"No jobs posted yet."})]})})]})]}),S&&e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>z(!1),children:[e.jsx("button",{onClick:()=>z(!1),className:"absolute top-4 right-4 p-3 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all hover:scale-110 z-10",title:"Close (ESC)",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{className:"absolute top-4 left-4 bg-black/50 backdrop-blur-sm px-4 py-3 rounded-xl text-white z-10",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[s.name,s.gold_verified?e.jsx(ee,{className:"w-5 h-5 text-yellow-500 fill-yellow-50"}):s.is_verified?e.jsx(ee,{className:"w-5 h-5 text-blue-500 fill-blue-50"}):null]}),e.jsxs("p",{className:"text-sm text-white/70",children:["@",s.username||s.id.slice(0,6)]})]}),e.jsx("div",{className:"relative max-w-4xl max-h-[90vh] animate-in zoom-in duration-300",onClick:e=>e.stopPropagation(),children:e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=${T?"f97316":"10b981"}&color=fff&size=1024`,alt:s.name,className:`max-w-full max-h-[90vh] ${T?"rounded-2xl object-contain":"rounded-full object-cover"} shadow-2xl`})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm",children:"Click anywhere or press ESC to close"})]}),U&&s.background_image_url&&e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>P(!1),children:[e.jsx("button",{onClick:()=>P(!1),className:"absolute top-4 right-4 p-3 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all hover:scale-110 z-10",title:"Close (ESC)",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{className:"absolute top-4 left-4 bg-black/50 backdrop-blur-sm px-4 py-3 rounded-xl text-white z-10",children:[e.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2",children:[s.name,"'s Background"]}),e.jsxs("p",{className:"text-sm text-white/70",children:["@",s.username||s.id.slice(0,6)]})]}),e.jsx("div",{className:"relative max-w-6xl max-h-[90vh] animate-in zoom-in duration-300",onClick:e=>e.stopPropagation(),children:e.jsx("img",{src:s.background_image_url,alt:`${s.name}'s background`,className:"max-w-full max-h-[90vh] rounded-2xl object-contain shadow-2xl"})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm",children:"Click anywhere or press ESC to close"})]})]}):e.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen bg-[#FAFAFA] px-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-6",children:e.jsx(K,{className:"w-10 h-10 text-slate-400"})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Profile Not Found"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"This user doesn't exist or may have been removed."}),e.jsxs(d,{to:"/app",className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-colors font-semibold",children:[e.jsx(we,{className:"w-4 h-4"}),"Back to Home"]})]})})}const Kr={privacy:{title:"Privacy Policy",icon:e.jsx(S,{className:"w-6 h-6 text-emerald-600"}),content:"\nLast Updated: January 12, 2026\n\n1. Introduction\nWelcome to UniLink. We respect your privacy and are committed to protecting your personal data. This privacy policy will inform you as to how we look after your personal data when you visit our website (regardless of where you visit it from) and tell you about your privacy rights and how the law protects you.\n\n2. Important Information and Who We Are\nUniLink is the controller and responsible for your personal data. We have appointed a data privacy manager who is responsible for overseeing questions in relation to this privacy policy.\n\n3. The Data We Collect About You\nWe may collect, use, store and transfer different kinds of personal data about you which we have grouped together as follows:\n- Identity Data: includes first name, last name, username or similar identifier, title, date of birth and gender.\n- Contact Data: includes billing address, delivery address, email address and telephone numbers.\n- Technical Data: includes internet protocol (IP) address, login data, browser type and version, time zone setting and location.\n- Profile Data: includes your username and password, purchases or orders made by you, your interests, preferences, feedback and survey responses.\n\n4. How We Use Your Personal Data\nWe will only use your personal data when the law allows us to. Most commonly, we will use your personal data in the following circumstances:\n- Where we need to perform the contract we are about to enter into or have entered into with you.\n- Where it is necessary for our legitimate interests (or those of a third party) and your interests and fundamental rights do not override those interests.\n- Where we need to comply with a legal or regulatory obligation.\n\n5. Data Security\nWe have put in place appropriate security measures to prevent your personal data from being accidentally lost, used or accessed in an unauthorized way, altered or disclosed.\n\n6. Your Legal Rights\nUnder certain circumstances, you have rights under data protection laws in relation to your personal data, including the right to request access, correction, erasure, restriction, transfer, to object to processing, to portability of data and (where the lawful ground of processing is consent) to withdraw consent.\n        "},terms:{title:"Terms of Service",icon:e.jsx(je,{className:"w-6 h-6 text-emerald-600"}),content:"\nLast Updated: January 12, 2026\n\n1. Agreement to Terms\nBy accessing our website, you agree to be bound by these Terms of Service and to comply with all applicable laws and regulations. If you do not agree with these terms, you are prohibited from using or accessing this site.\n\n2. Use License\nPermission is granted to temporarily download one copy of the materials (information or software) on UniLink's website for personal, non-commercial transitory viewing only. This is the grant of a license, not a transfer of title, and under this license you may not:\n- modify or copy the materials;\n- use the materials for any commercial purpose, or for any public display (commercial or non-commercial);\n- attempt to decompile or reverse engineer any software contained on UniLink's website;\n- remove any copyright or other proprietary notations from the materials; or\n- transfer the materials to another person or \"mirror\" the materials on any other server.\n\n3. Disclaimer\nThe materials on UniLink's website are provided on an 'as is' basis. UniLink makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including, without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.\n\n4. Limitations\nIn no event shall UniLink or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption) arising out of the use or inability to use the materials on UniLink's website.\n\n5. Governing Law\nThese terms and conditions are governed by and construed in accordance with the laws of Nigeria and you irrevocably submit to the exclusive jurisdiction of the courts in that State or location.\n        "},cookies:{title:"Cookie Policy",icon:e.jsx(nt,{className:"w-6 h-6 text-emerald-600"}),content:"\nLast Updated: January 12, 2026\n\n1. What Are Cookies\nCookies are small pieces of text sent by your web browser by a website you visit. A cookie file is stored in your web browser and allows the Service or a third-party to recognize you and make your next visit easier and the Service more useful to you.\n\n2. How We Use Cookies\nWhen you use and access the Service, we may place a number of cookies files in your web browser. We use cookies for the following purposes:\n- To enable certain functions of the Service.\n- To provide analytics.\n- To store your preferences.\n- To enable advertisements delivery, including behavioral advertising.\n\n3. Third-Party Cookies\nIn addition to our own cookies, we may also use various third-parties cookies to report usage statistics of the Service, deliver advertisements on and through the Service, and so on.\n\n4. Your Choices Regarding Cookies\nIf you'd like to delete cookies or instruct your web browser to delete or refuse cookies, please visit the help pages of your web browser. Please note, however, that if you delete cookies or refuse to accept them, you might not be able to use all of the features we offer, you may not be able to store your preferences, and some of our pages might not display properly.\n        "},copyright:{title:"Copyright Policy",icon:e.jsx(rt,{className:"w-6 h-6 text-emerald-600"}),content:'\nLast Updated: January 12, 2026\n\n1. Copyright Policy\nWe respect the intellectual property rights of others. It is our policy to respond to any claim that Content posted on the Service infringes the copyright or other intellectual property infringement ("Infringement") of any person.\n\n2. DMCA Notice\nIf you are a copyright owner, or authorized on behalf of one, and you believe that the copyrighted work has been copied in a way that constitutes copyright infringement that is taking place through the Service, you must submit your notice in writing to the attention of "Copyright Manager" of UniLink at unilinkrep@gmail.com and include in your notice a detailed description of the alleged Infringement.\n\n3. Intellectual Property Rights\nProprietary Rights. As between you and us, we (or our licensors) own all right, title, and interest in and to the Service, including all related intellectual property rights. The Service is protected by copyright, trade mark, and other laws of both the Nigeria and foreign countries. Our trade marks and trade dress may not be used in connection with any product or service without the prior written consent of us.\n        '}};function Yr(){const{type:t}=x(),s=t&&Kr[t]?Kr[t]:Kr.privacy;return e.jsxs("div",{className:"max-w-4xl mx-auto pb-20 pt-4",children:[e.jsxs(d,{to:"/app",className:"inline-flex items-center gap-2 text-stone-500 hover:text-stone-800 mb-8 transition-colors",children:[e.jsx(we,{className:"w-4 h-4"})," Back to App"]}),e.jsxs("div",{className:"bg-white rounded-[2rem] p-8 md:p-12 shadow-sm border border-stone-200",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-emerald-50 rounded-2xl",children:s.icon}),e.jsx("h1",{className:"text-3xl font-bold text-stone-900",children:s.title})]}),e.jsx("div",{className:"prose prose-stone max-w-none prose-headings:font-bold prose-headings:text-stone-900 prose-p:text-stone-600 prose-li:text-stone-600",children:s.content.split("\n").map((t,s)=>{const a=t.trim();return a?a.match(/^\d+\./)?e.jsx("h3",{className:"text-xl mt-8 mb-4",children:a},s):a.startsWith("-")?e.jsx("li",{className:"ml-4 list-disc",children:a.substring(1).trim()},s):e.jsx("p",{className:"mb-4 leading-relaxed",children:a},s):null})}),e.jsxs("div",{className:"mt-12 pt-8 border-t border-stone-100 text-sm text-stone-400",children:["© ",(new Date).getFullYear()," UniLink Nigeria. All rights reserved."]})]})]})}function Gr(){const{isInstallable:t,install:s,showInstallModal:a,setShowInstallModal:r,isIOs:n}=ga(),[o,l]=i.useState("Notification"in window?Notification.permission:"denied"),[c,m]=i.useState(!1),u=[{title:"Account",items:[{icon:K,label:"Personal Information",path:"/app/profile",description:"Update your profile details"},{icon:A,label:"Notifications",path:"/app/notifications",description:"Manage your alert preferences"}]},{title:"Support",items:[{icon:je,label:"Contact Support",path:"mailto:unilinkrep@gmail.com",description:"Get help with your account"},{icon:S,label:"Report a Problem",path:"mailto:unilinkrep@gmail.com?subject=Report%20Problem",description:"Found a bug? Let us know."},{icon:Je,label:"About UniLink",path:"/about",description:"Our mission and story"}]},{title:"Legal & Policies",items:[{icon:S,label:"Privacy Policy",path:"/app/legal/privacy",description:"How we handle your data"},{icon:je,label:"Terms of Service",path:"/app/legal/terms",description:"Usage agreement"},{icon:nt,label:"Cookie Policy",path:"/app/legal/cookies",description:"Cookie usage and preferences"},{icon:rt,label:"Copyright Policy",path:"/app/legal/copyright",description:"Intellectual property rights"}]}];return e.jsxs("div",{className:"max-w-2xl mx-auto pb-20",children:[e.jsx("h1",{className:"text-3xl font-bold text-stone-900 mb-8 font-display",children:"Settings"}),e.jsxs("div",{className:"space-y-8",children:[u.map((t,s)=>e.jsxs("div",{className:"bg-white rounded-[2rem] border border-stone-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-stone-100 bg-stone-50/50",children:e.jsx("h2",{className:"font-semibold text-stone-900",children:t.title})}),e.jsx("div",{className:"divide-y divide-stone-100",children:t.items.map((t,s)=>{const a=t.path.startsWith("http")||t.path.startsWith("mailto:"),r=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-2 bg-stone-100 rounded-xl text-stone-600 group-hover:bg-emerald-50 group-hover:text-emerald-600 transition-colors",children:e.jsx(t.icon,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-stone-900",children:t.label}),e.jsx("p",{className:"text-xs text-stone-500",children:t.description})]}),e.jsx(fe,{className:"w-4 h-4 text-stone-400 group-hover:text-emerald-500 group-hover:translate-x-1 transition-all"})]});return a?e.jsx("a",{href:t.path,className:"flex items-center gap-4 p-4 hover:bg-stone-50 transition-colors group",children:r},s):e.jsx(d,{to:t.path,className:"flex items-center gap-4 p-4 hover:bg-stone-50 transition-colors group",children:r},s)})})]},s)),"default"===o&&e.jsxs("div",{className:"bg-blue-50 rounded-[2rem] border border-blue-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl text-blue-600",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-blue-900",children:"Enable Notifications"}),e.jsx("p",{className:"text-xs text-blue-700",children:"Stay updated with messages and alerts"})]})]}),e.jsx("button",{onClick:async()=>{if(!("Notification"in window))return;const e=await Notification.requestPermission();l(e),"granted"===e&&new Notification("UniLink",{body:"Notifications enabled successfully!"})},className:"w-full bg-blue-600 rounded-xl shadow-sm p-3 text-white font-medium hover:bg-blue-700 transition-all text-sm",children:"Allow Notifications"})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-[2rem] border border-emerald-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-xl text-emerald-600",children:e.jsx(j,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-emerald-900",children:"Install UniLink App"}),e.jsx("p",{className:"text-xs text-emerald-700",children:t?"One-click install available!":"Add to your home screen"})]})]}),e.jsx("button",{onClick:t?s:()=>r(!0),className:"w-full bg-emerald-600 rounded-xl shadow-sm p-3 text-white font-medium hover:bg-emerald-700 transition-all text-sm",children:t?"Install Now":"Show Install Guide"})]}),e.jsxs("div",{className:"bg-orange-50 rounded-[2rem] border border-orange-100 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-xl text-orange-600",children:e.jsx(I,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-orange-900",children:"Clear Cache & Refresh"}),e.jsx("p",{className:"text-xs text-orange-700",children:"Force update to see the latest version"})]})]}),e.jsxs("button",{onClick:async()=>{m(!0);try{if("caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}if("serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(e=>e.unregister()))}window.location.reload()}catch(e){m(!1),alert("Failed to clear cache. Please try again.")}},disabled:c,className:"w-full bg-orange-600 rounded-xl shadow-sm p-3 text-white font-medium hover:bg-orange-700 transition-all text-sm disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 "+(c?"animate-spin":"")}),c?"Clearing...":"Clear Cache & Reload"]})]}),e.jsxs("button",{onClick:async()=>{await ns.auth.signOut(),window.location.href="/"},className:"w-full bg-white rounded-[2rem] border border-stone-200 shadow-sm p-4 flex items-center justify-center gap-3 text-red-600 font-medium hover:bg-red-50 hover:border-red-100 transition-all",children:[e.jsx(X,{className:"w-5 h-5"}),"Log Out"]}),e.jsxs("div",{className:"text-center text-xs text-stone-400",children:[e.jsx("p",{children:"UniLink Version 1.0.0"}),e.jsxs("p",{children:["© ",(new Date).getFullYear()," UniLink Nigeria"]})]})]}),e.jsx(ha,{isOpen:a,onClose:()=>r(!1),isIOS:n})]})}function Vr({isOpen:t,onClose:s,preSelectedUser:a,allUsers:r=[]}){const[n,o]=i.useState(""),[l,d]=i.useState(""),[c,m]=i.useState(!1),[u,h]=i.useState(a?"single":"all");if(!t)return null;const x=()=>{switch(u){case"single":return 1;case"all":return r.length;case"verified":return r.filter(e=>e.is_verified).length;case"unverified":return r.filter(e=>!e.is_verified).length;default:return 0}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center sm:p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-lg max-h-[85vh] sm:max-h-[90vh] rounded-t-3xl sm:rounded-3xl shadow-2xl overflow-hidden animate-in slide-in-from-bottom sm:zoom-in-95 duration-200 flex flex-col",children:[e.jsxs("div",{className:"bg-stone-50 px-4 sm:px-6 py-3 sm:py-4 flex items-center justify-between border-b border-stone-100 flex-shrink-0",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold text-stone-900 flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4 sm:w-5 sm:h-5 text-emerald-500"}),"Send Email"]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-stone-200 rounded-full transition-colors text-stone-500",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),m(!0);let t=[];switch(u){case"single":a?.email&&(t=[a.email]);break;case"all":t=r.map(e=>e.email).filter(Boolean);break;case"verified":t=r.filter(e=>e.is_verified).map(e=>e.email).filter(Boolean);break;case"unverified":t=r.filter(e=>!e.is_verified).map(e=>e.email).filter(Boolean)}if(0===t.length)return alert("No recipients found for this selection."),void m(!1);if(0===t.length)return alert("No recipients found for this selection."),void m(!1);const i=`mailto:?bcc=${t.join(",")}&subject=${encodeURIComponent(n)}&body=${encodeURIComponent(l)}`;i.length>2e3?(alert('The recipient list is too long for to open automatically (URL limit). Please use the "Copy All" button and paste them into your BCC field.'),window.location.href=i):window.location.href=i,m(!1),s()},className:"p-4 sm:p-5 space-y-4 sm:space-y-5 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-semibold text-stone-900",children:"Select Audience"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[a&&e.jsxs("button",{type:"button",onClick:()=>h("single"),className:"flex flex-col items-center p-3 rounded-xl border transition-all "+("single"===u?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-white border-stone-200 text-stone-500 hover:bg-stone-50"),children:[e.jsx(K,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Single User"})]}),e.jsxs("button",{type:"button",onClick:()=>h("all"),className:"flex flex-col items-center p-3 rounded-xl border transition-all "+("all"===u?"bg-emerald-50 border-emerald-200 text-emerald-700":"bg-white border-stone-200 text-stone-500 hover:bg-stone-50"),children:[e.jsx(k,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"All Users"})]}),e.jsxs("button",{type:"button",onClick:()=>h("verified"),className:"flex flex-col items-center p-3 rounded-xl border transition-all "+("verified"===u?"bg-blue-50 border-blue-200 text-blue-700":"bg-white border-stone-200 text-stone-500 hover:bg-stone-50"),children:[e.jsx(ee,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs font-medium",children:"Verified Only"})]}),e.jsxs("button",{type:"button",onClick:()=>h("unverified"),className:"flex flex-col items-center p-3 rounded-xl border transition-all "+("unverified"===u?"bg-stone-100 border-stone-300 text-stone-700":"bg-white border-stone-200 text-stone-500 hover:bg-stone-50"),children:[e.jsx(k,{className:"w-5 h-5 mb-1 opacity-50"}),e.jsx("span",{className:"text-xs font-medium",children:"Unverified Only"})]})]}),e.jsxs("p",{className:"text-xs text-stone-500 text-right",children:["Targeting ",e.jsx("span",{className:"font-bold text-stone-900",children:x()})," user(s)","single"===u&&a&&` (${a.name})`]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-sm font-semibold text-stone-900 flex justify-between items-center",children:[e.jsxs("span",{children:["Recipients (",x(),")"]}),e.jsx("button",{type:"button",onClick:async()=>{const e=(()=>{switch(u){case"single":return a?.email?[a.email]:[];case"all":return r.map(e=>e.email).filter(Boolean);case"verified":return r.filter(e=>e.is_verified).map(e=>e.email).filter(Boolean);case"unverified":return r.filter(e=>!e.is_verified).map(e=>e.email).filter(Boolean);default:return[]}})();await navigator.clipboard.writeText(e.join(", ")),alert("Copied all emails to clipboard!")},className:"text-emerald-600 text-xs hover:underline",children:"Copy All"})]}),e.jsx("div",{className:"p-3 bg-stone-50 rounded-xl border border-stone-200 text-xs text-stone-500 max-h-24 overflow-y-auto break-all",children:(()=>{switch(u){case"single":return a?.email?[a.email]:[];case"all":return r.map(e=>e.email).filter(Boolean);case"verified":return r.filter(e=>e.is_verified).map(e=>e.email).filter(Boolean);case"unverified":return r.filter(e=>!e.is_verified).map(e=>e.email).filter(Boolean);default:return[]}})().join(", ")||"No recipients selected"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"subject",className:"text-sm font-semibold text-stone-900",children:"Subject Line"}),e.jsx("input",{id:"subject",type:"text",className:"w-full px-4 py-3 rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all font-medium",placeholder:"Important update...",value:n,onChange:e=>o(e.target.value)})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"message",className:"text-sm font-semibold text-stone-900",children:"Message Body"}),e.jsx("textarea",{id:"message",rows:4,className:"w-full px-4 py-3 rounded-xl border border-stone-200 focus:outline-none focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all resize-none",placeholder:"Write your message here...",value:l,onChange:e=>d(e.target.value)})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-stone-100",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-2.5 rounded-xl text-stone-500 font-medium hover:bg-stone-100 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:c||0===x(),className:"px-6 py-2.5 bg-emerald-600 text-white rounded-xl font-semibold shadow-lg shadow-emerald-200 hover:bg-emerald-700 hover:shadow-emerald-300 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(qe,{className:"w-4 h-4"}),c?"Opening...":"Open Mail Client"]})]})]})]})})}function Qr({users:t}){const s=i.useMemo(()=>{if(0===t.length)return{daily:0,weekly:0,monthly:0,total:0};const e=new Date,s=new Date(e.getTime()-864e5),a=new Date(e.getTime()-6048e5),r=new Date(e.getTime()-2592e6);return{daily:t.filter(e=>new Date(e.created_at)>=s).length,weekly:t.filter(e=>new Date(e.created_at)>=a).length,monthly:t.filter(e=>new Date(e.created_at)>=r).length,total:t.length}},[t]),a=i.useMemo(()=>{if(0===t.length)return 0;const e=t.filter(e=>e.is_verified).length;return Math.round(e/t.length*100)},[t]),r=i.useMemo(()=>{const e=new Map;return t.forEach(t=>{const s=t.university?.trim()||"Not Specified";e.set(s,(e.get(s)||0)+1)}),Array.from(e.entries()).sort((e,t)=>t[1]-e[1]).slice(0,5)},[t]),n=i.useMemo(()=>{const e={students:0,orgs:0,verified:0};return t.forEach(t=>{"org"===t.role?e.orgs++:e.students++,t.is_verified&&e.verified++}),e},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-[2rem] p-6 md:p-8 text-white shadow-xl",children:[e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold mb-2 flex items-center gap-2",children:[e.jsx(P,{className:"w-6 h-6 md:w-8 md:h-8"}),"Platform Growth"]}),e.jsx("p",{className:"text-emerald-100 mb-6 text-sm md:text-base",children:"Real-time user acquisition metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 md:p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(it,{className:"w-4 h-4 text-emerald-200"}),e.jsx("p",{className:"text-xs md:text-sm text-emerald-200 font-medium",children:"Last 24h"})]}),e.jsx("p",{className:"text-2xl md:text-4xl font-bold",children:s.daily}),e.jsx("p",{className:"text-xs text-emerald-200 mt-1",children:"new users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 md:p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ie,{className:"w-4 h-4 text-emerald-200"}),e.jsx("p",{className:"text-xs md:text-sm text-emerald-200 font-medium",children:"Last 7 days"})]}),e.jsx("p",{className:"text-2xl md:text-4xl font-bold",children:s.weekly}),e.jsx("p",{className:"text-xs text-emerald-200 mt-1",children:"new users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 md:p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ot,{className:"w-4 h-4 text-emerald-200"}),e.jsx("p",{className:"text-xs md:text-sm text-emerald-200 font-medium",children:"Last 30 days"})]}),e.jsx("p",{className:"text-2xl md:text-4xl font-bold",children:s.monthly}),e.jsx("p",{className:"text-xs text-emerald-200 mt-1",children:"new users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 md:p-4 border border-white/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(k,{className:"w-4 h-4 text-emerald-200"}),e.jsx("p",{className:"text-xs md:text-sm text-emerald-200 font-medium",children:"Total"})]}),e.jsx("p",{className:"text-2xl md:text-4xl font-bold",children:s.total}),e.jsx("p",{className:"text-xs text-emerald-200 mt-1",children:"registered"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-4 md:p-6 border border-stone-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(at,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"font-bold text-stone-900 text-sm md:text-base",children:"Engagement Rate"})]}),e.jsxs("p",{className:"text-3xl md:text-5xl font-bold text-green-600",children:[a,"%"]}),e.jsxs("p",{className:"text-xs md:text-sm text-stone-500 mt-2",children:[n.verified," verified users"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 md:p-6 border border-stone-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(k,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-stone-900 text-sm md:text-base",children:"Students"})]}),e.jsx("p",{className:"text-3xl md:text-5xl font-bold text-blue-600",children:n.students}),e.jsxs("p",{className:"text-xs md:text-sm text-stone-500 mt-2",children:[Math.round(n.students/t.length*100),"% of total"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 md:p-6 border border-stone-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(ot,{className:"w-5 h-5 text-orange-600"})}),e.jsx("h3",{className:"font-bold text-stone-900 text-sm md:text-base",children:"Organizations"})]}),e.jsx("p",{className:"text-3xl md:text-5xl font-bold text-orange-600",children:n.orgs}),e.jsxs("p",{className:"text-xs md:text-sm text-stone-500 mt-2",children:[Math.round(n.orgs/t.length*100),"% of total"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 md:p-6 border border-stone-200 shadow-sm",children:[e.jsx("h3",{className:"font-bold text-stone-900 mb-4 md:mb-6 text-base md:text-lg",children:"Top Universities"}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[r.map(([s,a],r)=>e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-1 min-w-0",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 md:w-8 md:h-8 rounded-full bg-emerald-100 text-emerald-600 font-bold text-xs md:text-sm flex items-center justify-center",children:r+1}),e.jsx("span",{className:"font-medium text-stone-700 text-sm md:text-base truncate",children:s})]}),e.jsx("span",{className:"font-bold text-stone-900 text-base md:text-lg ml-2",children:a})]}),e.jsx("div",{className:"w-full bg-stone-100 h-2 md:h-3 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full bg-emerald-600 transition-all duration-500",style:{width:a/t.length*100+"%"}})})]},s)),0===r.length&&e.jsx("p",{className:"text-stone-400 text-sm text-center py-4",children:"No university data yet"})]})]})]})}function Jr({isOpen:t,onClose:s,title:a,children:r,footer:n,size:i="md",hideHeader:o=!1}){if(!t)return null;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:`\n                    relative w-full ${{sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl"}[i]} \n                    bg-white dark:bg-zinc-900 \n                    rounded-t-3xl sm:rounded-3xl \n                    shadow-2xl \n                    max-h-[95vh] sm:max-h-[90vh]\n                    flex flex-col\n                    animate-in \n                    slide-in-from-bottom sm:fade-in sm:zoom-in-95 \n                    duration-200\n                `,children:[!o&&e.jsxs("div",{className:"flex-shrink-0 px-6 py-4 border-b border-stone-200 dark:border-zinc-800 flex justify-between items-center bg-stone-50 dark:bg-zinc-900/50 rounded-t-3xl",children:[e.jsx("h2",{className:"font-bold text-lg text-stone-900 dark:text-zinc-100",children:a}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-stone-200 dark:hover:bg-zinc-800 rounded-full transition-colors",children:e.jsx(D,{className:"w-5 h-5 text-stone-500 dark:text-zinc-400"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:r}),n&&e.jsx("div",{className:"flex-shrink-0 border-t border-stone-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 px-4 sm:px-6 py-4",children:n})]}),e.jsx("style",{children:"\n                .custom-scrollbar::-webkit-scrollbar {\n                    width: 8px;\n                }\n                .custom-scrollbar::-webkit-scrollbar-track {\n                    background: transparent;\n                }\n                .custom-scrollbar::-webkit-scrollbar-thumb {\n                    background: #d1d5db;\n                    border-radius: 4px;\n                }\n                .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n                    background: #9ca3af;\n                }\n            "})]})}function Xr(){const{posts:t,loading:s,createPost:a,deletePost:r}=xr(),[n,o]=i.useState(!1),[l,d]=i.useState([]),[c,m]=i.useState({content:"",organization_id:"",cta_text:"Learn More",cta_url:"",target_audience:"all",media_url:"",media_type:"image",priority:0});i.useEffect(()=>{(async()=>{const{data:e}=await ns.from("profiles").select("*").eq("role","org").order("name",{ascending:!0});e&&(d(e),e.length>0&&!c.organization_id&&m(t=>({...t,organization_id:e[0].id})))})()},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-stone-900 dark:text-white",children:"Sponsored Posts"}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),"New Ad"]})]}),s?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):0===t.length?e.jsx("div",{className:"text-center p-8 text-stone-500 bg-stone-50 dark:bg-zinc-800/50 rounded-xl border border-dashed border-stone-200 dark:border-zinc-700",children:"No sponsored posts yet. Create one to get started!"}):e.jsx("div",{className:"grid gap-4",children:t.map(t=>e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-4 rounded-xl border border-stone-200 dark:border-zinc-800 shadow-sm flex items-start gap-4",children:[e.jsx("div",{className:"w-32 h-20 bg-stone-100 dark:bg-zinc-800 rounded-lg overflow-hidden shrink-0 relative",children:t.media_url?"video"===t.media_type?e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black/10",children:e.jsx(Ne,{className:"w-8 h-8 text-stone-400"})}):e.jsx("img",{src:t.media_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(re,{className:"w-6 h-6 text-stone-300"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-bold text-stone-900 dark:text-white truncate",children:t.organization?.name||"Unknown Org"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this sponsored post?"))try{await r(e)}catch(t){alert("Failed to delete post: "+t.message)}})(t.id),className:"p-1.5 text-stone-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(me,{className:"w-4 h-4"})})})]}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400 line-clamp-2 mb-2",children:t.content}),e.jsxs("div",{className:"flex gap-4 text-xs text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ve,{className:"w-3 h-3"})," ",t.impressions," views"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(lt,{className:"w-3 h-3"})," ",t.clicks," clicks"]}),e.jsx("span",{className:"px-2 py-0.5 rounded-full "+(t.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:t.is_active?"Active":"Inactive"})]})]})]},t.id))}),e.jsx(Jr,{isOpen:n,onClose:()=>o(!1),title:"Create Sponsored Post",size:"2xl",footer:e.jsxs("div",{className:"flex justify-end gap-3 w-full",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-stone-600 hover:text-stone-900 font-medium",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(c.content&&c.organization_id)try{await a(c),o(!1),m({content:"",organization_id:l[0]?.id||"",cta_text:"Learn More",cta_url:"",target_audience:"all",media_url:"",media_type:"image",priority:0})}catch(e){alert("Failed to create post: "+e.message)}},className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium shadow-sm",children:"Create Ad"})]}),children:e.jsxs("div",{className:"space-y-6 p-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Organization"}),e.jsx("select",{value:c.organization_id,onChange:e=>m({...c,organization_id:e.target.value}),className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500",children:l.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Ad Content"}),e.jsx("textarea",{value:c.content,onChange:e=>m({...c,content:e.target.value}),placeholder:"Write your sponsored message here...",rows:4,className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Media URL"}),e.jsx("input",{type:"text",value:c.media_url||"",onChange:e=>m({...c,media_url:e.target.value}),placeholder:"https://...",className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Media Type"}),e.jsxs("select",{value:c.media_type||"image",onChange:e=>m({...c,media_type:e.target.value}),className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"video",children:"Video"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Button Text"}),e.jsx("input",{type:"text",value:c.cta_text||"",onChange:e=>m({...c,cta_text:e.target.value}),placeholder:"Learn More",className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Button URL"}),e.jsx("input",{type:"text",value:c.cta_url||"",onChange:e=>m({...c,cta_url:e.target.value}),placeholder:"https://...",className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Target Audience"}),e.jsxs("select",{value:c.target_audience||"all",onChange:e=>m({...c,target_audience:e.target.value}),className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"students",children:"Students Only"}),e.jsx("option",{value:"organizations",children:"Organizations Only"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-1",children:"Priority (Higher = More Frequent)"}),e.jsx("input",{type:"number",value:c.priority||0,onChange:e=>m({...c,priority:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-stone-200 dark:border-zinc-700 rounded-lg bg-white dark:bg-zinc-800 text-stone-900 dark:text-white focus:ring-2 focus:ring-emerald-500"})]})]})]})})]})}function Zr({reports:t,setReports:s}){return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 dark:border-zinc-800 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-500 rounded-lg",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-xl font-bold text-stone-900 dark:text-white",children:"Flagged Accounts & Reports"})]}),e.jsx("div",{className:"overflow-x-auto",children:0===t.length?e.jsx("div",{className:"p-8 text-center text-stone-500",children:e.jsx("p",{children:"No active reports found. All good! 👍"})}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-red-50 text-red-900 text-xs uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-semibold",children:"Reported User"}),e.jsx("th",{className:"px-6 py-4 font-semibold",children:"Reported By"}),e.jsx("th",{className:"px-6 py-4 font-semibold",children:"Reason"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-red-100",children:t.map(t=>e.jsxs("tr",{className:"hover:bg-red-50/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-stone-200 overflow-hidden",children:e.jsx("img",{src:t.reported?.avatar_url,alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-stone-900 text-sm",children:t.reported?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-stone-500",children:t.reported?.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-stone-200 overflow-hidden",children:e.jsx("img",{src:t.reporter?.avatar_url,alt:"",className:"w-full h-full object-cover"})}),e.jsx("span",{className:"text-sm font-medium text-stone-700",children:t.reporter?.name||"Unknown"})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-stone-700 max-w-xs",children:t.reason}),e.jsx("p",{className:"text-xs text-stone-400 mt-1",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>(async e=>{const{error:t}=await ns.from("reports").update({status:"resolved"}).eq("id",e);t?alert("Failed to resolve report"):s(t=>t.filter(t=>t.id!==e))})(t.id),className:"px-3 py-1.5 bg-white border border-stone-200 hover:bg-stone-50 text-stone-600 text-xs font-semibold rounded-lg shadow-sm",children:"Mark Resolved"})})]},t.id))})]})})]})}function en({users:t,setUsers:s,stats:a,setStats:r}){const[n,o]=i.useState(""),[l,d]=i.useState(!1),[c,m]=i.useState(null),u=t.filter(e=>e.name.toLowerCase().includes(n.toLowerCase())||e.email?.toLowerCase().includes(n.toLowerCase())),h=e=>{m(e||null),d(!0)};return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 dark:border-zinc-800 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-stone-100 dark:bg-zinc-800 rounded-lg",children:e.jsx(k,{className:"w-5 h-5 text-stone-600 dark:text-zinc-400"})}),e.jsx("h2",{className:"text-xl font-bold text-stone-900 dark:text-white",children:"User Management"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>h(),className:"flex items-center gap-2 bg-stone-100 hover:bg-stone-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-stone-700 dark:text-zinc-300 px-4 py-2 rounded-xl text-sm font-semibold transition-colors",children:[e.jsx(qe,{className:"w-4 h-4"}),"Broadcast"]}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"w-4 h-4 text-stone-400 dark:text-zinc-500 absolute left-3 top-1/2 -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:n,onChange:e=>o(e.target.value),className:"pl-9 pr-4 py-2 bg-stone-50 dark:bg-zinc-800 border border-stone-200 dark:border-zinc-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-stone-900 dark:focus:ring-emerald-500 w-full md:w-64 text-sm text-stone-900 dark:text-white"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-stone-50 dark:bg-zinc-800/50 text-stone-500 dark:text-zinc-500 text-xs uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 font-semibold",children:"User"}),e.jsx("th",{className:"px-6 py-4 font-semibold",children:"Role"}),e.jsx("th",{className:"px-6 py-4 font-semibold",children:"University"}),e.jsx("th",{className:"px-6 py-4 font-semibold",children:"Status"}),e.jsx("th",{className:"px-6 py-4 font-semibold text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-stone-100 dark:divide-zinc-800",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-stone-50/50 dark:hover:bg-zinc-800/50 transition-colors cursor-grab active:cursor-grabbing",draggable:"true",onDragStart:e=>{e.dataTransfer.setData("application/ulink-user",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy"},children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-stone-200 dark:bg-zinc-700 overflow-hidden pointer-events-none",children:e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}`,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-stone-900 dark:text-white flex items-center gap-1",children:[t.name,t.gold_verified?e.jsx(ee,{className:"w-4 h-4 text-yellow-500"}):t.is_verified?e.jsx(ee,{className:"w-4 h-4 text-blue-500"}):null]}),e.jsx("p",{className:"text-xs text-stone-500 dark:text-zinc-500",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+(t.is_admin?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"org"===t.role?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-stone-100 text-stone-600 dark:bg-zinc-800 dark:text-zinc-400"),children:t.is_admin?"Admin":"org"===t.role?"Organization":"Student"})}),e.jsx("td",{className:"px-6 py-4 text-stone-600 dark:text-zinc-400 text-sm",children:t.university||"N/A"}),e.jsx("td",{className:"px-6 py-4",children:t.gold_verified?e.jsxs("span",{className:"flex items-center gap-1.5 text-yellow-600 dark:text-yellow-500 text-xs font-medium",children:[e.jsx(ee,{className:"w-4 h-4"})," Gold"]}):t.is_verified?e.jsxs("span",{className:"flex items-center gap-1.5 text-blue-600 dark:text-blue-500 text-xs font-medium",children:[e.jsx(ee,{className:"w-4 h-4"})," Verified"]}):e.jsx("span",{className:"text-stone-400 dark:text-zinc-600 text-xs",children:"Unverified"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsx("button",{onClick:()=>h(t),className:"p-1.5 text-stone-400 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20 rounded-lg transition-colors",title:"Send Email",children:e.jsx(qe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>(async(e,t)=>{const{error:n}=await ns.rpc("admin_toggle_verify",{target_id:e,should_verify:!t});n?alert("Failed to update verification status. Please try again."):(s(s=>s.map(s=>s.id===e?{...s,is_verified:!t}:s)),a&&r({...a,total_verified:t?a.total_verified-1:a.total_verified+1}))})(t.id,t.is_verified||!1),className:"text-xs font-medium px-3 py-1.5 rounded-lg border transition-colors "+(t.is_verified?"border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900/30 dark:hover:bg-red-900/20 dark:text-red-500":"border-blue-200 text-blue-600 hover:bg-blue-50 dark:border-blue-900/30 dark:hover:bg-blue-900/20 dark:text-blue-500"),children:t.is_verified?"Remove Badge":"Verify"})]})})]},t.id))})]})}),e.jsx(Vr,{isOpen:l,onClose:()=>d(!1),preSelectedUser:c,allUsers:t})]})}const tn=[{key:"yellow",bg:"bg-yellow-100",border:"border-yellow-300",shadow:"shadow-yellow-200"},{key:"pink",bg:"bg-pink-100",border:"border-pink-300",shadow:"shadow-pink-200"},{key:"blue",bg:"bg-sky-100",border:"border-sky-300",shadow:"shadow-sky-200"},{key:"green",bg:"bg-emerald-100",border:"border-emerald-300",shadow:"shadow-emerald-200"},{key:"purple",bg:"bg-purple-100",border:"border-purple-300",shadow:"shadow-purple-200"},{key:"orange",bg:"bg-orange-100",border:"border-orange-300",shadow:"shadow-orange-200"}],sn=["📝","🎯","💡","🚀","⚡","🎉","🔥","🌟","💬","📌","👀","🛠️"],an=["❤️","🔥","😂","👏","🎯","💡","👀","🚀"],rn=e=>tn.find(t=>t.key===e)??tn[0],nn=e=>{const t=Date.now()-new Date(e).getTime(),s=Math.floor(t/6e4);if(s<1)return"just now";if(s<60)return`${s}m ago`;const a=Math.floor(s/60);return a<24?`${a}h ago`:`${Math.floor(a/24)}d ago`};function on(){const[t,s]=i.useState([]),[a,r]=i.useState(null),[n,o]=i.useState(!0),[l,d]=i.useState(!1),[c,m]=i.useState(""),[u,h]=i.useState("yellow"),[x,p]=i.useState("📝"),[g,f]=i.useState(!1),[b,v]=i.useState(!1),w=i.useRef(null);i.useEffect(()=>{ns.auth.getUser().then(({data:e})=>{r(e.user?.id??null)})},[]);const j=async()=>{const{data:e,error:t}=await ns.from("admin_notes").select("*, author:author_id(name, avatar_url, email)").order("created_at",{ascending:!1});!t&&e&&s(e),o(!1)};i.useEffect(()=>{j();const e=ns.channel("admin_notes_realtime").on("postgres_changes",{event:"*",schema:"public",table:"admin_notes"},()=>{j()}).subscribe();return()=>{ns.removeChannel(e)}},[]);return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900 dark:text-white",children:"Admin Board"}),e.jsxs("p",{className:"text-xs text-stone-500 dark:text-zinc-400",children:[t.length," note",1!==t.length?"s":""," · visible to admins only"]})]}),e.jsxs("button",{onClick:()=>{d(e=>!e),setTimeout(()=>w.current?.focus(),50)},className:"flex items-center gap-1.5 bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-2 rounded-xl text-sm font-semibold transition-all shadow-md shadow-emerald-200 dark:shadow-emerald-900/30",children:[l?e.jsx(D,{className:"w-4 h-4"}):e.jsx(ae,{className:"w-4 h-4"}),l?"Cancel":"Add Note"]})]}),l&&e.jsxs("div",{className:`rounded-2xl border-2 p-4 space-y-3 shadow-lg transition-all ${rn(u).bg} ${rn(u).border}`,children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>v(e=>!e),className:"text-2xl w-10 h-10 flex items-center justify-center rounded-xl bg-white/60 hover:bg-white/90 transition border border-white/80",children:x}),b&&e.jsx("div",{className:"absolute top-12 left-0 z-20 bg-white dark:bg-zinc-800 rounded-2xl shadow-xl p-3 border border-stone-200 dark:border-zinc-700 flex flex-wrap gap-2 w-52",children:sn.map(t=>e.jsx("button",{onClick:()=>{p(t),v(!1)},className:"text-xl p-1.5 rounded-lg hover:bg-stone-100 dark:hover:bg-zinc-700 transition "+(x===t?"bg-stone-100 dark:bg-zinc-700":""),children:t},t))})]}),e.jsx("div",{className:"flex gap-1.5",children:tn.map(t=>e.jsx("button",{onClick:()=>h(t.key),className:`w-7 h-7 rounded-full border-2 transition-transform ${t.bg} ${u===t.key?"scale-125 border-stone-600":"border-transparent hover:scale-110"}`},t.key))})]}),e.jsx("textarea",{ref:w,value:c,onChange:e=>m(e.target.value.slice(0,280)),placeholder:"What's on your mind? Drop a note for the team…",rows:3,className:"w-full bg-white/50 dark:bg-white/10 rounded-xl px-3 py-2.5 text-sm text-stone-800 dark:text-white placeholder-stone-400 border border-white/60 focus:outline-none focus:ring-2 focus:ring-emerald-400 resize-none"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-stone-400",children:[c.length,"/280"]}),e.jsxs("button",{onClick:async()=>{c.trim()&&a&&(f(!0),await ns.from("admin_notes").insert({author_id:a,content:c.trim(),color:u,emoji:x,reactions:{}}),m(""),h("yellow"),p("📝"),d(!1),f(!1))},disabled:!c.trim()||g,className:"flex items-center gap-1.5 bg-stone-900 dark:bg-emerald-600 hover:bg-stone-700 dark:hover:bg-emerald-700 disabled:opacity-50 text-white px-4 py-2 rounded-xl text-sm font-semibold transition-all",children:[e.jsx(le,{className:"w-3.5 h-3.5"}),"Post"]})]})]}),n?e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("div",{className:"w-10 h-10 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})}):0===t.length?e.jsxs("div",{className:"flex flex-col items-center justify-center h-48 gap-3 text-stone-400 dark:text-zinc-500",children:[e.jsx("span",{className:"text-5xl",children:"📌"}),e.jsx("p",{className:"font-medium",children:"No notes yet — be the first to drop one!"})]}):e.jsx("div",{className:"columns-1 sm:columns-2 lg:columns-3 gap-4 space-y-0",children:t.map(t=>{const r=rn(t.color),n=t.author_id===a,i=Object.values(t.reactions).reduce((e,t)=>e+t.length,0);return e.jsxs("div",{className:`break-inside-avoid mb-4 rounded-2xl border-2 p-4 shadow-lg ${r.bg} ${r.border} ${r.shadow} group relative`,children:[n&&e.jsx("button",{onClick:()=>(async e=>{s(t=>t.filter(t=>t.id!==e)),await ns.from("admin_notes").delete().eq("id",e)})(t.id),className:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 focus:opacity-100 p-1.5 rounded-lg bg-white/70 hover:bg-red-100 text-stone-400 hover:text-red-500 transition-all",title:"Delete note",children:e.jsx(me,{className:"w-3.5 h-3.5"})}),e.jsx("div",{className:"text-3xl mb-2",children:t.emoji}),e.jsx("p",{className:"text-sm text-stone-800 whitespace-pre-wrap leading-relaxed mb-3",children:t.content}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.author?.avatar_url?e.jsx("img",{src:t.author.avatar_url,alt:"",className:"w-6 h-6 rounded-full object-cover"}):e.jsx("div",{className:"w-6 h-6 rounded-full bg-stone-300 flex items-center justify-center text-xs font-bold text-stone-700",children:(o=t.author?.name,l=t.author?.email,o?.trim()?o.trim()[0].toUpperCase():l?l[0].toUpperCase():"?")}),e.jsx("span",{className:"text-xs text-stone-600 font-medium truncate",children:t.author?.name??t.author?.email?.split("@")[0]??"Admin"}),e.jsx("span",{className:"text-xs text-stone-400 ml-auto shrink-0",children:nn(t.created_at)})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:an.map(r=>{const n=t.reactions[r]??[],i=!!a&&n.includes(a);return e.jsxs("button",{onClick:()=>(async(e,t)=>{if(!a)return;const r=e.reactions[t]??[],n=r.includes(a)?r.filter(e=>e!==a):[...r,a],i={...e.reactions,[t]:n};0===i[t].length&&delete i[t],s(t=>t.map(t=>t.id===e.id?{...t,reactions:i}:t)),await ns.from("admin_notes").update({reactions:i}).eq("id",e.id)})(t,r),className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium border transition-all "+(i?"bg-stone-800 border-stone-700 text-white scale-105":"bg-white/60 border-white/80 text-stone-600 hover:bg-white/90 hover:scale-105"),children:[r,n.length>0&&e.jsx("span",{children:n.length})]},r)})}),i>0&&e.jsxs("p",{className:"text-xs text-stone-400 mt-1.5",children:[i," reaction",1!==i?"s":""]})]},t.id);var o,l})})]})}const ln=["🔥","✅","💡","🚀","❤️","😂","🎯","⚡","🌟","🏆","💎","🎉"],dn=()=>Math.random().toString(36).slice(2,7);function cn(){const[t,s]=i.useState([]),[a,r]=i.useState(!0),[n,o]=i.useState(!1),[l,d]=i.useState(""),[c,m]=i.useState(""),[u,h]=i.useState([{id:dn(),text:"",emoji:"🔥"},{id:dn(),text:"",emoji:"✅"}]),[x,p]=i.useState(""),[g,f]=i.useState(!1),b=async()=>{const{data:e}=await ns.from("polls").select("*").order("created_at",{ascending:!1});s(e??[]),r(!1)};i.useEffect(()=>{b()},[]);const v=(e,t,s)=>{h(a=>a.map(a=>a.id===e?{...a,[t]:s}:a))};return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-stone-900 dark:text-white",children:"Campus Challenges"}),e.jsxs("p",{className:"text-xs text-stone-500 dark:text-zinc-400",children:[t.filter(e=>e.is_active).length," active poll",1!==t.filter(e=>e.is_active).length?"s":""]})]}),e.jsxs("button",{onClick:()=>o(e=>!e),className:"flex items-center gap-1.5 bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-2 rounded-xl text-sm font-semibold transition-all shadow-md shadow-emerald-200 dark:shadow-emerald-900/30",children:[n?e.jsx(D,{className:"w-4 h-4"}):e.jsx(ae,{className:"w-4 h-4"}),n?"Cancel":"New Poll"]})]}),n&&e.jsxs("div",{className:"bg-stone-50 dark:bg-zinc-800/60 rounded-2xl border border-stone-200 dark:border-zinc-700 p-5 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-stone-600 dark:text-zinc-300",children:"Question *"}),e.jsx("input",{value:l,onChange:e=>d(e.target.value.slice(0,300)),placeholder:"e.g. Which superpower would you choose?",className:"w-full bg-white dark:bg-zinc-900 rounded-xl px-3 py-2.5 text-sm border border-stone-200 dark:border-zinc-700 focus:outline-none focus:ring-2 ring-emerald-400"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-stone-600 dark:text-zinc-300",children:"Description (optional)"}),e.jsx("input",{value:c,onChange:e=>m(e.target.value.slice(0,500)),placeholder:"Add context or instructions…",className:"w-full bg-white dark:bg-zinc-900 rounded-xl px-3 py-2.5 text-sm border border-stone-200 dark:border-zinc-700 focus:outline-none focus:ring-2 ring-emerald-400"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold text-stone-600 dark:text-zinc-300",children:"Options (2–6) *"}),u.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{value:t.emoji,onChange:e=>v(t.id,"emoji",e.target.value),className:"bg-white dark:bg-zinc-900 border border-stone-200 dark:border-zinc-700 rounded-lg px-1 py-2 text-lg focus:outline-none",children:ln.map(t=>e.jsx("option",{value:t,children:t},t))}),e.jsx("input",{value:t.text,onChange:e=>v(t.id,"text",e.target.value.slice(0,100)),placeholder:`Option ${s+1}`,className:"flex-1 bg-white dark:bg-zinc-900 rounded-xl px-3 py-2 text-sm border border-stone-200 dark:border-zinc-700 focus:outline-none focus:ring-2 ring-emerald-400"}),u.length>2&&e.jsx("button",{onClick:()=>{return e=t.id,void(u.length<=2||h(t=>t.filter(t=>t.id!==e)));var e},className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:e.jsx(me,{className:"w-3.5 h-3.5"})})]},t.id)),u.length<6&&e.jsxs("button",{onClick:()=>{u.length>=6||h(e=>[...e,{id:dn(),text:"",emoji:ln[e.length%ln.length]}])},className:"text-sm text-emerald-600 dark:text-emerald-400 font-medium hover:underline flex items-center gap-1",children:[e.jsx(ae,{className:"w-3.5 h-3.5"})," Add option"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-semibold text-stone-600 dark:text-zinc-300",children:"End date (optional)"}),e.jsx("input",{type:"datetime-local",value:x,onChange:e=>p(e.target.value),className:"bg-white dark:bg-zinc-900 rounded-xl px-3 py-2 text-sm border border-stone-200 dark:border-zinc-700 focus:outline-none focus:ring-2 ring-emerald-400"})]}),e.jsxs("button",{onClick:async()=>{if(!l.trim()||u.some(e=>!e.text.trim()))return;f(!0);const{data:{user:e}}=await ns.auth.getUser();await ns.from("polls").insert({question:l.trim(),description:c.trim()||null,options:u,created_by:e?.id,ends_at:x||null,is_active:!0}),d(""),m(""),h([{id:dn(),text:"",emoji:"🔥"},{id:dn(),text:"",emoji:"✅"}]),p(""),o(!1),f(!1),b()},disabled:!l.trim()||u.some(e=>!e.text.trim())||g,className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 disabled:opacity-50 text-white px-5 py-2.5 rounded-xl font-semibold text-sm transition-all",children:[e.jsx(le,{className:"w-4 h-4"}),g?"Creating…":"Create Challenge"]})]}),a?e.jsx("div",{className:"text-center py-10 text-stone-400",children:"Loading…"}):0===t.length?e.jsx("div",{className:"text-center py-10 text-stone-400",children:"No challenges yet — create the first one!"}):e.jsx("div",{className:"space-y-3",children:t.map(t=>e.jsx("div",{className:"rounded-2xl border p-4 transition-all "+(t.is_active?"bg-white dark:bg-zinc-900 border-stone-200 dark:border-zinc-700":"bg-stone-50 dark:bg-zinc-800/40 border-stone-200 dark:border-zinc-700 opacity-60"),children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full "+(t.is_active?"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400":"bg-stone-100 text-stone-500 dark:bg-zinc-700 dark:text-zinc-400"),children:t.is_active?"● Live":"○ Inactive"}),e.jsxs("span",{className:"text-xs text-stone-400",children:[t.options.length," options"]})]}),e.jsx("p",{className:"font-semibold text-stone-900 dark:text-white text-sm leading-snug",children:t.question}),e.jsx("div",{className:"flex gap-2 flex-wrap mt-2",children:t.options.map(t=>e.jsxs("span",{className:"text-xs bg-stone-100 dark:bg-zinc-800 text-stone-600 dark:text-zinc-300 px-2 py-0.5 rounded-full",children:[t.emoji," ",t.text]},t.id))})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>(async e=>{await ns.from("polls").update({is_active:!e.is_active}).eq("id",e.id),s(t=>t.map(t=>t.id===e.id?{...t,is_active:!t.is_active}:t))})(t),className:"p-2 rounded-xl transition-colors "+(t.is_active?"text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/20":"text-stone-400 hover:bg-stone-100 dark:hover:bg-zinc-700"),title:t.is_active?"Deactivate":"Activate",children:t.is_active?e.jsx(dt,{className:"w-5 h-5"}):e.jsx(ct,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>(async e=>{window.confirm("Delete this poll and all its votes?")&&(await ns.from("polls").delete().eq("id",e),s(t=>t.filter(t=>t.id!==e)))})(t.id),className:"p-2 text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors",title:"Delete poll",children:e.jsx(me,{className:"w-4 h-4"})})]})]})},t.id))})]})}function mn(){const t=c(),[s,a]=i.useState(!0),[r,n]=i.useState(!1),[o,l]=i.useState("dashboard"),[d,m]=i.useState(null),[u,h]=i.useState([]),[x,p]=i.useState(!1),[g,f]=i.useState([]);i.useEffect(()=>{b()},[]);const b=async()=>{const{data:{user:e}}=await ns.auth.getUser();if(!e)return t("/");const{data:s}=await ns.from("profiles").select("*").eq("id",e.id).single();s?.is_admin?(n(!0),v()):t("/app/feed")},v=async()=>{a(!0);const{data:e}=await ns.rpc("get_admin_stats");e&&m(e);const{data:t}=await ns.from("profiles").select("*").order("created_at",{ascending:!1});t&&h(t);const{data:s}=await ns.from("reports").select("\n                *,\n                reporter:reporter_id(name, email, avatar_url),\n                reported:reported_id(name, email, avatar_url)\n            ").eq("status","pending").order("created_at",{ascending:!1});s&&f(s),a(!1)};return!r&&s?e.jsx("div",{className:"p-8 text-center text-stone-500",children:"Checking permissions..."}):r?e.jsxs("div",{className:"max-w-6xl mx-auto pb-20 space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-stone-900 dark:bg-emerald-600 text-white rounded-2xl shadow-lg shadow-emerald-900/20",children:e.jsx(S,{className:"w-5 h-5 md:w-6 md:h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-stone-900 dark:text-white font-display",children:"Admin Dashboard"}),e.jsx("p",{className:"text-stone-500 dark:text-zinc-400 text-sm",children:"Manage users and collaborate"})]})]}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl font-semibold shadow-lg shadow-emerald-200 dark:shadow-emerald-900/30 transition-all text-sm",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Send Broadcast"}),e.jsx("span",{className:"sm:hidden",children:"Broadcast"})]})]}),e.jsxs("div",{className:"flex gap-2 p-1 bg-stone-100 dark:bg-zinc-800 rounded-xl w-full sm:w-fit",children:[e.jsxs("button",{onClick:()=>l("dashboard"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all "+("dashboard"===o?"bg-white dark:bg-zinc-700 text-stone-900 dark:text-white shadow-sm":"text-stone-500 dark:text-zinc-400 hover:text-stone-900 dark:hover:text-zinc-200"),children:[e.jsx(mt,{className:"w-4 h-4"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>l("board"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all "+("board"===o?"bg-white dark:bg-zinc-700 text-stone-900 dark:text-white shadow-sm":"text-stone-500 dark:text-zinc-400 hover:text-stone-900 dark:hover:text-zinc-200"),children:[e.jsx(oe,{className:"w-4 h-4"}),"Board"]}),e.jsxs("button",{onClick:()=>l("polls"),className:"flex-1 sm:flex-none flex items-center justify-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all "+("polls"===o?"bg-white dark:bg-zinc-700 text-stone-900 dark:text-white shadow-sm":"text-stone-500 dark:text-zinc-400 hover:text-stone-900 dark:hover:text-zinc-200"),children:[e.jsx(H,{className:"w-4 h-4"}),"Challenges"]})]}),"dashboard"===o?e.jsxs("div",{className:"space-y-8 animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm flex items-center gap-4 hover:scale-[1.02] transition-transform duration-300",children:[e.jsx("div",{className:"p-4 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-500 rounded-2xl",children:e.jsx(k,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-500 dark:text-zinc-400 text-sm font-medium",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-stone-900 dark:text-white",children:d?.total_users||0})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm flex items-center gap-4 hover:scale-[1.02] transition-transform duration-300",children:[e.jsx("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-500 rounded-2xl",children:e.jsx(ee,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-500 dark:text-zinc-400 text-sm font-medium",children:"Verified Accounts"}),e.jsx("p",{className:"text-3xl font-bold text-stone-900 dark:text-white",children:d?.total_verified||0})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm flex items-center gap-4 hover:scale-[1.02] transition-transform duration-300",children:[e.jsx("div",{className:"p-4 bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-500 rounded-2xl",children:e.jsx(Ee,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-stone-500 dark:text-zinc-400 text-sm font-medium",children:"Organizations"}),e.jsx("p",{className:"text-3xl font-bold text-stone-900 dark:text-white",children:d?.total_orgs||0})]})]})]}),e.jsx(Qr,{users:u}),e.jsx(Zr,{reports:g,setReports:f}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-sm p-6 overflow-hidden",children:e.jsx(Xr,{})}),e.jsx(en,{users:u,setUsers:h,stats:d,setStats:m})]}):"board"===o?e.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-300",children:e.jsx(on,{})}):e.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-300",children:e.jsx(cn,{})}),e.jsx(Vr,{isOpen:x,onClose:()=>p(!1),preSelectedUser:null,allUsers:u})]}):null}function un(){const t=c();return e.jsxs("div",{className:"min-h-[80vh] flex flex-col items-center justify-center p-4 text-center",children:[e.jsx("div",{className:"bg-stone-100 p-6 rounded-full mb-6",children:e.jsx("span",{className:"text-4xl",children:"🛸"})}),e.jsx("h1",{className:"text-6xl font-black text-stone-900 mb-2 font-display",children:"404"}),e.jsx("h2",{className:"text-2xl font-bold text-stone-700 mb-4",children:"Page Not Found"}),e.jsx("p",{className:"text-stone-500 max-w-md mb-8",children:"The page you are looking for seems to have drifted into outer space. Let's get you back to solid ground."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>t(-1),className:"px-6 py-2.5 rounded-xl border border-stone-200 text-stone-600 font-medium hover:bg-stone-50 transition-colors flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"}),"Go Back"]}),e.jsxs("button",{onClick:()=>t("/app"),className:"px-6 py-2.5 rounded-xl bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition-colors flex items-center gap-2 shadow-lg shadow-indigo-200",children:[e.jsx(O,{className:"w-4 h-4"}),"Dashboard"]})]})]})}function hn(t){const n=i.useRef(null),[o]=i.useState(()=>{const e=new Float32Array(15e3);for(let t=0;t<5e3;t++){const s=Math.random(),a=Math.random(),r=2*Math.PI*s,n=Math.acos(2*a-1),i=1.2*Math.cbrt(Math.random()),o=i*Math.sin(n)*Math.cos(r),l=i*Math.sin(n)*Math.sin(r),d=i*Math.cos(n);e[3*t]=o,e[3*t+1]=l,e[3*t+2]=d}return e});return s((e,t)=>{n.current&&(n.current.rotation.x-=t/10,n.current.rotation.y-=t/15)}),e.jsx("group",{rotation:[0,0,Math.PI/4],children:e.jsx(a,{ref:n,positions:o,stride:3,frustumCulled:!1,...t,children:e.jsx(r,{transparent:!0,color:"#312e81",size:.005,sizeAttenuation:!0,depthWrite:!1})})})}function xn(){return e.jsxs("div",{className:"absolute inset-0 z-0 bg-[#FAFAFA]",children:[e.jsx(t,{camera:{position:[0,0,1.8]},children:e.jsx(hn,{})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#FAFAFA]/80 pointer-events-none"})]})}const pn=["Abia State University","Achievers University, Owo","Adamawa State University","Adekunle Ajasin University","Adeleke University","Admiralty University of Nigeria","Afe Babalola University","African University of Science and Technology","Ahmadu Bello University","Ajayi Crowther University","Akwa Ibom State University","Alex Ekwueme Federal University, Ndufu-Alike","Al-Hikmah University","Al-Qalam University, Katsina","Ambrose Alli University","American University of Nigeria","Anchor University, Lagos","Arthur Jarvis University","Atiba University","Augustine University","Babcock University","Bauchi State University","Bayero University Kano","Baze University","Bells University of Technology","Benson Idahosa University","Benue State University","Bingham University","Borno State University","Bowen University","Buka Abba Ibrahim University","Caleb University","Caritas University","Chrisland University","Christopher University","Chukwuemeka Odumegwu Ojukwu University","Clifford University","Coal City University","Covenant University","Crawford University","Crescent University, Abeokuta","Cross River University of Technology","Crown Hill University","Delta State University, Abraka","Dominican University, Ibadan","Eastern Palm University","Ebonyi State University","Edo University","Edwin Clark University","Ekiti State University, Ado Ekiti","Eko University of Medicine and Health Sciences","Elizade University","Enugu State University of Science and Technology","Evangel University, Akaeze","Federal University of Agriculture, Abeokuta","Federal University of Petroleum Resources","Federal University of Technology, Akure","Federal University of Technology, Minna","Federal University of Technology, Owerri","Federal University, Birnin Kebbi","Federal University, Dutse","Federal University, Dutsin-Ma","Federal University, Gashua","Federal University, Gusau","Federal University, Kashere","Federal University, Lafia","Federal University, Lokoja","Federal University, Otuoke","Federal University, Oye-Ekiti","Federal University, Wukari","Fountain University, Osogbo","Gombe State University","G Gregory University, Uturu","Hallmark University","Hezekiah University","Ibrahim Badamasi Babangida University","Igbinedion University Okada","Ignatius Ajuru University of Education","Imo State University","Joseph Ayo Babalola University","Kaduna State University","Kano University of Science and Technology","Kebbi State University of Science and Technology","Kings University","Kogi State University","Kola Daisi University","Kwara State University","Kwararafa University, Wukari","Ladoke Akintola University of Technology","Lagos State University","Landmark University","Lead City University","Legacy University, Okija","Madonna University, Nigeria","Mcpherson University","Michael and Cecilia Ibru University","Michael Okpara University of Agriculture","Modibbo Adama University of Technology","Mountain Top University","Nasarawa State University","Niger Delta University","Nile University of Nigeria","Nnamdi Azikiwe University","Novena University","Obafemi Awolowo University","Obong University","Oduduwa University","Olabisi Onabanjo University","Ondo State University of Science and Technology","Osun State University","Pan-Atlantic University","Paul University","Plateau State University","PAMO University of Medical Sciences","Precious Cornerstone University","Redeemer's University","Renaissance University","Rhema University","Ritman University","Rivers State University","Salem University","Samuel Adegboyega University","Skyline University Nigeria","Sokoto State University","Southwestern University, Nigeria","Spiritan University, Nneochi","Summit University, Offa","Tai Solarin University of Education","Tansian University","Taraba State University","The Technical University","Umaru Musa Yar'adua University","University of Abuja","University of Africa, Toru-Orua","University of Agriculture, Makurdi","University of Benin","University of Calabar","University of Ibadan","University of Ilorin","University of Jos","University of Lagos","University of Maiduguri","University of Medical Sciences","University of Mkar","University of Nigeria","University of Port Harcourt","University of Uyo","Usmanu Danfodiyo University","Veritas University","Wellspring University","Wesley University of Science and Technology","Western Delta University","Yobe State University","Akanu Ibiam Federal Polytechnic, Unwana","Air Force Institute of Technology, Kaduna","Auchi Polytechnic","Federal Polytechnic, Ado-Ekiti","Federal Polytechnic, Ayede","Federal Polytechnic, Bali","Federal Polytechnic, Bauchi","Federal Polytechnic, Bida","Federal Polytechnic, Damaturu","Federal Polytechnic, Daura","Federal Polytechnic, Ede","Federal Polytechnic, Ekowe","Federal Polytechnic, Idah","Federal Polytechnic, Ilaro","Federal Polytechnic, Ile-Oluji","Federal Polytechnic, Kaura Namoda","Federal Polytechnic, Mubi","Federal Polytechnic, Nasarawa","Federal Polytechnic, Nekede","Federal Polytechnic, Offa","Federal Polytechnic, Oko","Federal Polytechnic, Ugep","Hussaini Adamu Federal Polytechnic, Kazaure","Kaduna Polytechnic","Waziri Umaru Federal Polytechnic, Birnin Kebbi","Yaba College of Technology","Abdu Gusau Polytechnic, Talata Mafara","Abia State Polytechnic, Aba","Abraham Adesanya Polytechnic, Ijebu-Igbo","Abubakar Tatari Ali Polytechnic, Bauchi","Adamawa State Polytechnic, Yola","Adeseun Ogundoyin Polytechnic, Eruwa","Akwa Ibom State Polytechnic, Ikot Osurua","Anambra State Polytechnic, Mgbakwu","Bayelsa State Polytechnic, Aleibiri","Benue State Polytechnic, Ugbokolo","Binyaminu Usman Polytechnic, Hadejia","Delta State Polytechnic, Ogwashi-Uku","Delta State Polytechnic, Otefe-Oghara","Delta State Polytechnic, Ozoro","D.S. Adegbenro ICT Polytechnic, Itori-Ewekoro","Edo State Polytechnic, Usen","Enugu State Polytechnic, Iwollo","Gateway Polytechnic, Igbesa","Gateway Polytechnic, Saapade","Hassan Usman Katsina Polytechnic, Katsina","Institute of Management and Technology, Enugu","Jigawa State Polytechnic, Dutse","Kano State Polytechnic","Ken Saro-Wiwa Polytechnic, Bori","Kogi State Polytechnic, Lokoja","Kwara State Polytechnic, Ilorin","Lagos State Polytechnic, Ikorodu","Mai-Idris Alooma Polytechnic, Geidam","Moshood Abiola Polytechnic, Abeokuta","Niger State Polytechnic, Zungeru","Nuhu Bamalli Polytechnic, Zaria","Osun State College of Technology, Esa-Oke","Osun State Polytechnic, Iree","Plateau State Polytechnic, Barkin-Ladi","Port Harcourt Polytechnic","Ramat Polytechnic, Maiduguri","Rivers State Polytechnic, Bori","Rufus Giwa Polytechnic, Owo","The Polytechnic, Ibadan","Yobe State Polytechnic, Damaturu","Ajayi Polytechnic, Ikere Ekiti","Al-Hikma Polytechnic, Karu","Allover Central Polytechnic, Sango Ota","Ashi Polytechnic, Anyiin","Bellarks Polytechnic, Kwale","Best Solution Polytechnic, Akure","Bolmor Polytechnic, Ibadan","Brainfill Polytechnic, Ikot Ekpene","Calvary Polytechnic, Owa-Oyibu","Citi Polytechnic, Abuja","Coastal Polytechnic, Apapa","Covenant Polytechnic, Aba","Crown Polytechnic, Ado-Ekiti","Dorben Polytechnic, Bwari","Eastern Polytechnic, Port Harcourt","Fidei Polytechnic, Gboko","Foundation College of Technology, Ikot Ekpene","Grace Polytechnic, Surulere","Heritage Polytechnic, Eket","Igbajo Polytechnic, Igbajo","Kalac Christal Polytechnic, Lekki","Kings Polytechnic","Lagos City Polytechnic, Ikeja","Lighthouse Polytechnic","Our Saviour Institute of Science, Agriculture & Technology, Enugu","Prime Polytechnic, Ajaokuta","Ronik Polytechnic, Ejigbo","Saf Polytechnic, Iseyin","Southern Atlantic Polytechnic, Uyo","Speedway Polytechnic, Ojudu","Temple Gate Polytechnic, Aba","The Polytechnic, Ile-Ife","Tower Polytechnic, Ibadan","Wolex Polytechnic, Iwo"].sort();function gn(){const t=c(),[s,a]=i.useState("profile"),[r,n]=i.useState(!1),[o,l]=i.useState("student"),[d,m]=i.useState(""),[u,h]=i.useState(""),[x,p]=i.useState(!1),[g,f]=i.useState(null),[b,v]=i.useState([]),[w,j]=i.useState(new Set),[_,C]=i.useState(!1),[S,z]=i.useState(null);i.useEffect(()=>{(async()=>{const{data:{user:e}}=await ns.auth.getUser();if(!e)return t("/");const{data:s}=await ns.from("profiles").select("*").eq("id",e.id).single();s&&s.role&&t("/app")})()},[]);const P=async(e,t)=>{C(!0);try{let s=ns.from("profiles").select("id, name, username, avatar_url, university, headline, is_verified").neq("id",e).limit(12);t&&(s=s.eq("university",t));const{data:a}=await s;a&&v(a.sort(()=>Math.random()-.5))}catch(s){}finally{C(!1)}};return"connect"===s?e.jsxs("div",{className:"relative min-h-screen bg-[#FAFAFA] overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 z-0",children:e.jsx(xn,{})}),e.jsxs("div",{className:"relative z-10 pt-10 pb-6 text-center px-4",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-emerald-50 border border-emerald-200 text-emerald-700 text-sm font-semibold mb-4",children:[e.jsx(y,{className:"w-4 h-4"}),"You're all set!"]}),e.jsx("h1",{className:"text-3xl md:text-4xl font-display font-bold text-slate-900 mb-3",children:"People You May Know"}),e.jsx("p",{className:"text-slate-500 text-base max-w-md mx-auto",children:d?`Connect with fellow students from ${d}`:"Connect with other students on UniLink"}),e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-6",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-600 flex items-center justify-center",children:e.jsx(N,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Profile"})]}),e.jsx("div",{className:"w-8 h-px bg-emerald-300"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-600 flex items-center justify-center",children:e.jsx(k,{className:"w-3.5 h-3.5 text-white"})}),e.jsx("span",{className:"text-xs font-semibold text-emerald-700",children:"Connect"})]})]})]}),e.jsx("div",{className:"relative z-10 max-w-4xl mx-auto px-4 pb-32",children:_?e.jsx("div",{className:"flex justify-center py-16",children:e.jsx(M,{className:"w-8 h-8 text-emerald-600 animate-spin"})}):0===b.length?e.jsxs("div",{className:"text-center py-16 text-slate-400",children:[e.jsx(k,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"No suggestions yet — more people are joining every day!"})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:b.map((t,s)=>{const a=w.has(t.id),r=S===t.id;return e.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl border border-slate-100 p-4 flex flex-col items-center text-center shadow-sm hover:shadow-md hover:-translate-y-1 transition-all duration-300 animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:50*s+"ms"},children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsx("img",{src:t.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=059669&color=fff`,alt:t.name,className:"w-16 h-16 rounded-full object-cover border-2 border-emerald-100"}),t.is_verified&&e.jsx("span",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx(N,{className:"w-3 h-3 text-white"})})]}),e.jsx("p",{className:"font-bold text-slate-900 text-sm truncate w-full",children:t.name}),t.username&&e.jsxs("p",{className:"text-xs text-slate-400 mb-1",children:["@",t.username]}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2 mb-3 leading-relaxed",children:t.headline||t.university||"UniLink Student"}),e.jsx("button",{onClick:()=>!a&&(async e=>{z(e);try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;await ns.from("connections").insert({requester_id:t.id,recipient_id:e,status:"pending"}),j(t=>new Set([...t,e]))}catch(t){}finally{z(null)}})(t.id),disabled:a||r,className:"w-full py-2 rounded-xl text-xs font-semibold transition-all flex items-center justify-center gap-1.5 "+(a?"bg-emerald-50 text-emerald-600 border border-emerald-200 cursor-default":"bg-emerald-600 hover:bg-emerald-500 text-white shadow-sm hover:shadow-emerald-200 hover:shadow-md"),children:r?e.jsx(M,{className:"w-3.5 h-3.5 animate-spin"}):a?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-3.5 h-3.5"})," Connected"]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-3.5 h-3.5"})," Connect"]})})]},t.id)})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 bg-white/90 backdrop-blur-xl border-t border-slate-200 p-4",children:e.jsxs("div",{className:"max-w-md mx-auto flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-sm text-slate-500",children:w.size>0?e.jsxs("span",{className:"text-emerald-600 font-semibold",children:["🎉 ",w.size," connection",w.size>1?"s":""," made!"]}):"Connect with classmates to see their posts"}),e.jsxs("button",{onClick:()=>t("/app"),className:"flex items-center gap-2 bg-slate-900 hover:bg-slate-800 text-white font-semibold px-6 py-3 rounded-xl transition-all hover:scale-[1.02] active:scale-[0.98] shadow-lg text-sm whitespace-nowrap",children:[w.size>0?"Go to Feed":"Skip for now",e.jsx(fe,{className:"w-4 h-4"})]})]})})]}):e.jsxs("div",{className:"relative min-h-screen bg-[#FAFAFA] flex items-center justify-center p-4 overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute inset-0 z-0",children:e.jsx(xn,{})}),e.jsxs("div",{className:"relative z-10 w-full max-w-[420px] bg-white/80 backdrop-blur-xl rounded-3xl border border-white/60 shadow-[0_20px_40px_-12px_rgba(0,0,0,0.1)] p-8 animate-in fade-in zoom-in-95 duration-500",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-slate-900 mb-2",children:"Welcome to UniLink! 👋"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Set up your profile to get started."})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-emerald-500"}),e.jsx("div",{className:"flex-1 h-1.5 rounded-full bg-slate-200"}),e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:"Step 1 of 2"})]}),g&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 text-red-600 text-sm rounded-xl border border-red-100",children:g}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),n(!0),f(null),u.length<3)return f("Username must be at least 3 characters long"),void n(!1);if(!/^[a-zA-Z0-9_]+$/.test(u))return f("Username can only contain letters, numbers, and underscores"),void n(!1);try{const{data:{user:e}}=await ns.auth.getUser();if(!e)throw new Error("No user found");const t={id:e.id,email:e.email,name:e.user_metadata.name||e.email?.split("@")[0],avatar_url:e.user_metadata.avatar_url,role:o,username:u.toLowerCase(),university:"student"===o?d:null,updated_at:(new Date).toISOString()},{error:s}=await ns.from("profiles").upsert(t);if(s){if("23505"===s.code)throw new Error("Username is already taken. Please choose another.");throw s}await P(e.id,"student"===o?d:null),a("connect")}catch(t){f(t.message)}finally{n(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[e.jsxs("button",{type:"button",onClick:()=>l("student"),className:"flex flex-col items-center p-4 rounded-xl border transition-all duration-300 group "+("student"===o?"border-indigo-200 bg-indigo-50 text-indigo-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300 hover:bg-slate-50"),children:[e.jsx(G,{className:"w-6 h-6 mb-2 transition-transform duration-300 "+("student"===o?"scale-110":"group-hover:scale-110")}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider",children:"Student"})]}),e.jsxs("button",{type:"button",onClick:()=>l("org"),className:"flex flex-col items-center p-4 rounded-xl border transition-all duration-300 group "+("org"===o?"border-indigo-200 bg-indigo-50 text-indigo-700":"border-slate-200 bg-white text-slate-500 hover:border-slate-300 hover:bg-slate-50"),children:[e.jsx(Ee,{className:"w-6 h-6 mb-2 transition-transform duration-300 "+("org"===o?"scale-110":"group-hover:scale-110")}),e.jsx("span",{className:"text-xs font-medium uppercase tracking-wider",children:"Organization"})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(L,{className:"absolute left-4 top-3.5 w-5 h-5 text-slate-400 transition-colors group-focus-within:text-indigo-600 z-10"}),e.jsx("input",{type:"text",placeholder:"Choose a username",value:u,onChange:e=>h(e.target.value),className:"w-full pl-12 pr-4 py-3.5 bg-white border border-slate-200 rounded-xl text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all font-medium",required:!0})]}),"student"===o&&e.jsxs("div",{className:"relative group z-50",children:[e.jsx(Ee,{className:"absolute left-4 top-3.5 w-5 h-5 text-slate-400 transition-colors group-focus-within:text-indigo-600 z-10"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search University...",value:d,onChange:e=>{m(e.target.value),p(!0)},onFocus:()=>p(!0),className:"w-full pl-12 pr-4 py-3.5 bg-white border border-slate-200 rounded-xl text-slate-900 placeholder:text-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 transition-all",required:!0}),x&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 max-h-60 overflow-y-auto bg-white border border-slate-200 rounded-xl shadow-xl z-50",children:pn.filter(e=>e.toLowerCase().includes(d.toLowerCase())).map(t=>e.jsx("button",{type:"button",onClick:()=>{m(t),p(!1)},className:"w-full text-left px-4 py-2.5 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-700 transition-colors border-b border-slate-100 last:border-0",children:t},t))})]})]}),x&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>p(!1)}),e.jsx("button",{type:"submit",disabled:r,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-4 rounded-xl transition-all shadow-lg shadow-indigo-200 hover:shadow-indigo-300 disabled:opacity-50 flex items-center justify-center gap-3",children:r?e.jsx(M,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:["Next: Find Connections ",e.jsx(U,{className:"w-5 h-5"})]})})]})]})]})}function fn({isOpen:t,onClose:s}){const a=c(),[r,n]=i.useState(null),[o,l]=i.useState(!1),[d,m]=i.useState("");i.useEffect(()=>{ns.auth.getUser().then(({data:{user:e}})=>n(e))},[]);const[u,h]=i.useState(""),[x,p]=i.useState("public"),[g,f]=i.useState(""),[b,v]=i.useState(null),[w,j]=i.useState(null),[y,N]=i.useState(""),[k,C]=i.useState("");if(!t)return null;const S=(e,t)=>e.size>5242880?("icon"===t?"Icon":"Cover")+" image must be less than 5MB":["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(e.type)?null:("icon"===t?"Icon":"Cover")+" must be a valid image (JPEG, PNG, GIF, or WebP)";return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-white rounded-t-3xl sm:rounded-3xl w-full max-w-lg max-h-[80vh] sm:max-h-[85vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom sm:zoom-in-95 duration-200 flex flex-col",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-stone-100 flex justify-between items-center bg-stone-50/50 flex-shrink-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-stone-900 font-display",children:"Create Community"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-stone-100 rounded-full transition-colors text-stone-500",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),r)if(d.trim().length<3)alert("Community name must be at least 3 characters long");else if(g.trim().length<3)alert("Community URL must be at least 3 characters long");else{if(b){const e=S(b,"icon");if(e)return void alert(e)}if(w){const e=S(w,"cover");if(e)return void alert(e)}l(!0);try{const{data:e,error:n}=await ns.from("communities").select("id").eq("slug",g).maybeSingle();if(n)throw new Error("Failed to check community URL availability. Please try again.");if(e)return alert("This community URL identifier is already taken. Please try a different name."),void l(!1);let i="",o="";if(b)try{const e=b.name.split(".").pop(),t=`community-icons/${g}-${Date.now()}.${e}`,{error:s}=await ns.storage.from("community-images").upload(t,b,{cacheControl:"3600",upsert:!1});if(s)throw new Error(`Failed to upload icon: ${s.message}`);const{data:{publicUrl:a}}=ns.storage.from("community-images").getPublicUrl(t);i=a}catch(t){throw new Error(t.message||"Failed to upload icon image")}if(w)try{const e=w.name.split(".").pop(),t=`community-covers/${g}-${Date.now()}.${e}`,{error:s}=await ns.storage.from("community-images").upload(t,w,{cacheControl:"3600",upsert:!1});if(s)throw new Error(`Failed to upload cover: ${s.message}`);const{data:{publicUrl:a}}=ns.storage.from("community-images").getPublicUrl(t);o=a}catch(t){throw new Error(t.message||"Failed to upload cover image")}const{data:c,error:m}=await ns.from("communities").insert({name:d.trim(),slug:g.trim(),description:u.trim()||null,privacy:x,created_by:r.id,icon_url:i||null,cover_image_url:o||null}).select().single();if(m)throw new Error(`Failed to create community: ${m.message}`);if(!c)throw new Error("Community created but no data returned");s(),setTimeout(()=>{a(`/app/communities/${c.slug}`)},150)}catch(n){let e="Failed to create community. Please try again.";n.message&&(e=n.message.includes("storage")?"Failed to upload images. Please check your internet connection and try again.":n.message.includes("permission")?"You do not have permission to create communities. Please contact support.":n.message.includes("network")?"Network error. Please check your internet connection and try again.":n.message),alert(e)}finally{l(!1)}}else alert("You must be logged in to create a community")},className:"p-4 sm:p-6 space-y-4 sm:space-y-5 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-1.5",children:"Community Name"}),e.jsx("input",{type:"text",value:d,onChange:e=>{return t=e.target.value,m(t),void f(t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""));var t},placeholder:"e.g. Abuja Tech Devs",className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl border border-stone-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 transition-all font-medium text-sm sm:text-base",required:!0,minLength:3,maxLength:50})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-stone-500 mb-1.5 uppercase tracking-wide",children:"Community URL"}),e.jsxs("div",{className:"flex items-center px-3 sm:px-4 py-2.5 sm:py-3 bg-stone-50 border border-stone-200 rounded-xl text-stone-500",children:[e.jsx("span",{className:"text-xs sm:text-sm whitespace-nowrap",children:"unilink.app/c/"}),e.jsx("input",{type:"text",value:g,onChange:e=>f(e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")),className:"flex-1 bg-transparent border-none focus:ring-0 p-0 ml-1 text-stone-900 font-bold text-xs sm:text-sm",required:!0})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-stone-700 mb-1.5",children:["Description ",e.jsx("span",{className:"text-stone-400 font-normal",children:"(Optional)"})]}),e.jsx("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"What is this community about?",className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl border border-stone-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 transition-all min-h-[70px] sm:min-h-[80px] resize-none text-sm sm:text-base",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:["Icon ",e.jsx("span",{className:"text-stone-400 font-normal text-xs",children:"(Optional)"})]}),e.jsxs("label",{className:"block cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files?.[0];t&&(v(t),N(URL.createObjectURL(t)))}}),e.jsx("div",{className:"aspect-square rounded-xl border-2 border-dashed border-stone-200 hover:border-indigo-400 transition-colors flex items-center justify-center bg-stone-50 hover:bg-indigo-50/30 overflow-hidden",children:y?e.jsx("img",{src:y,alt:"Icon preview",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center p-2",children:[e.jsx(_,{className:"w-6 h-6 mx-auto text-stone-400 mb-1"}),e.jsx("p",{className:"text-[10px] text-stone-500",children:"Upload"})]})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:["Cover ",e.jsx("span",{className:"text-stone-400 font-normal text-xs",children:"(Optional)"})]}),e.jsxs("label",{className:"block cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files?.[0];t&&(j(t),C(URL.createObjectURL(t)))}}),e.jsx("div",{className:"aspect-square rounded-xl border-2 border-dashed border-stone-200 hover:border-indigo-400 transition-colors flex items-center justify-center bg-stone-50 hover:bg-indigo-50/30 overflow-hidden",children:k?e.jsx("img",{src:k,alt:"Cover preview",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center p-2",children:[e.jsx(_,{className:"w-6 h-6 mx-auto text-stone-400 mb-1"}),e.jsx("p",{className:"text-[10px] text-stone-500",children:"Upload"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:"Privacy"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>p("public"),className:"p-3 sm:p-4 rounded-xl border-2 text-left transition-all "+("public"===x?"border-indigo-600 bg-indigo-50/50 ring-1 ring-indigo-600":"border-stone-100 hover:border-stone-200 bg-white"),children:[e.jsx(_,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-1.5 sm:mb-2 "+("public"===x?"text-indigo-600":"text-stone-400")}),e.jsx("div",{className:"font-bold text-xs sm:text-sm text-stone-900",children:"Public"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-stone-500 mt-0.5 sm:mt-1 leading-tight",children:"Anyone can join"})]}),e.jsxs("button",{type:"button",onClick:()=>p("private"),className:"p-3 sm:p-4 rounded-xl border-2 text-left transition-all "+("private"===x?"border-indigo-600 bg-indigo-50/50 ring-1 ring-indigo-600":"border-stone-100 hover:border-stone-200 bg-white"),children:[e.jsx(ut,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-1.5 sm:mb-2 "+("private"===x?"text-indigo-600":"text-stone-400")}),e.jsx("div",{className:"font-bold text-xs sm:text-sm text-stone-900",children:"Private"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-stone-500 mt-0.5 sm:mt-1 leading-tight",children:"Invite only"})]})]})]}),e.jsx("div",{className:"pt-2 sm:pt-3 sticky bottom-0 bg-white -mx-4 sm:-mx-6 px-4 sm:px-6 pb-4 sm:pb-0",children:e.jsx("button",{type:"submit",disabled:o||!d,className:"w-full py-3 sm:py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-all shadow-lg shadow-indigo-200 hover:shadow-indigo-300 disabled:opacity-50 flex items-center justify-center gap-2 text-sm sm:text-base",children:o?"Creating...":"Create Community"})})]})]})]})}function bn({embed:t=!1}){const[s,a]=i.useState([]),[r,n]=i.useState(!0),[o,l]=i.useState(""),[c,m]=i.useState(!1);i.useEffect(()=>{u()},[]);const u=async()=>{n(!0);try{const{data:e,error:t}=await ns.from("communities").select("*, community_members(count)").order("created_at",{ascending:!1});if(t)throw t;const s=e.map(e=>({...e,members_count:e.community_members?.[0]?.count||0}));a(s||[])}catch(e){}finally{n(!1)}},h=s.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.description?.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:t?"":"max-w-5xl mx-auto",children:[!t&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-stone-900",children:"Communities"}),e.jsx("p",{className:"text-stone-500 mt-1",children:"Discover and join groups based on your interests and campus."})]}),e.jsxs("button",{onClick:()=>m(!0),className:"px-5 py-2.5 bg-stone-900 hover:bg-stone-800 text-white rounded-xl font-bold flex items-center gap-2 transition-colors shadow-lg shadow-stone-200",children:[e.jsx(ae,{className:"w-5 h-5"}),"Create Community"]})]}),t&&e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:()=>m(!0),className:"px-5 py-2.5 bg-stone-900 hover:bg-stone-800 text-white rounded-xl font-bold flex items-center gap-2 transition-colors shadow-lg shadow-stone-200",children:[e.jsx(ae,{className:"w-5 h-5"}),"Create Community"]})}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx(Q,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-stone-400"}),e.jsx("input",{type:"text",placeholder:"Search communities...",value:o,onChange:e=>l(e.target.value),className:"w-full pl-12 pr-4 py-3.5 bg-white border border-stone-200 rounded-2xl focus:outline-none focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 transition-all font-medium"})]}),r?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"h-48 bg-stone-100 rounded-2xl animate-pulse"},t))}):h.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(t=>e.jsxs(d,{to:`/app/communities/${t.slug}`,className:"group bg-white rounded-3xl border border-stone-200 p-6 hover:shadow-xl hover:shadow-stone-200/50 hover:-translate-y-1 transition-all duration-300 flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center text-2xl font-bold shadow-inner "+(t.icon_url?"":"bg-gradient-to-br from-indigo-100 to-violet-100 text-indigo-600"),children:t.icon_url?e.jsx("img",{src:t.icon_url,className:"w-full h-full object-cover rounded-2xl"}):t.name.charAt(0)}),e.jsxs("div",{className:"px-2.5 py-1 rounded-lg bg-stone-50 border border-stone-100 flex items-center gap-1.5 text-xs font-bold text-stone-500 uppercase tracking-wider",children:["public"===t.privacy?e.jsx(_,{className:"w-3 h-3"}):e.jsx(ut,{className:"w-3 h-3"}),t.privacy]})]}),e.jsx("h3",{className:"text-xl font-bold text-stone-900 mb-2 leading-tight group-hover:text-indigo-600 transition-colors",children:t.name}),e.jsx("p",{className:"text-stone-500 text-sm leading-relaxed mb-6 line-clamp-3 flex-1",children:t.description||"No description provided."}),e.jsxs("div",{className:"pt-4 border-t border-stone-100 flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 text-stone-400 text-xs font-semibold",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.members_count||0," Members"]})]}),e.jsx("span",{className:"text-indigo-600 text-sm font-bold opacity-0 group-hover:opacity-100 transform translate-x-2 group-hover:translate-x-0 transition-all duration-300",children:"View Group →"})]})]},t.id))}):e.jsxs("div",{className:"text-center py-20 bg-stone-50 rounded-3xl border border-dashed border-stone-200",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl shadow-sm border border-stone-100 flex items-center justify-center mx-auto mb-4 text-stone-300",children:e.jsx(Q,{className:"w-8 h-8"})}),e.jsx("h3",{className:"text-lg font-bold text-stone-900 mb-1",children:"No communities found"}),e.jsxs("p",{className:"text-stone-500 max-w-md mx-auto",children:["We couldn't find any communities matching \"",o,'". Why not create your own?']}),e.jsx("button",{onClick:()=>{l(""),m(!0)},className:"mt-6 text-indigo-600 font-bold hover:underline",children:"Create new community"})]}),e.jsx(fn,{isOpen:c,onClose:()=>m(!1)})]})}function vn({isOpen:t,onClose:s,community:a,onUpdate:r}){const n=c(),[o,l]=i.useState(!1),[d,m]=i.useState(a.name),[u,h]=i.useState(a.description||""),[x,p]=i.useState(a.privacy),[g,f]=i.useState(null),[b,v]=i.useState(null),[w,j]=i.useState(a.icon_url||""),[y,N]=i.useState(a.cover_image_url||"");if(i.useEffect(()=>{t&&(m(a.name),h(a.description||""),p(a.privacy),j(a.icon_url||""),N(a.cover_image_url||""))},[t,a]),!t)return null;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative bg-white rounded-t-3xl sm:rounded-3xl w-full max-w-lg max-h-[90vh] sm:max-h-[85vh] overflow-hidden shadow-2xl animate-in slide-in-from-bottom sm:zoom-in-95 duration-200 flex flex-col",children:[e.jsxs("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b border-stone-100 flex justify-between items-center bg-stone-50/50 flex-shrink-0",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-stone-900 font-display",children:"Edit Community"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-stone-100 rounded-full transition-colors text-stone-500",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),l(!0);try{let e=a.icon_url||"",t=a.cover_image_url||"";if(g){const t=g.name.split(".").pop(),s=`community-icons/${a.slug}-${Date.now()}.${t}`,{error:r}=await ns.storage.from("community-images").upload(s,g);if(!r){const{data:{publicUrl:t}}=ns.storage.from("community-images").getPublicUrl(s);e=t}}if(b){const e=b.name.split(".").pop(),s=`community-covers/${a.slug}-${Date.now()}.${e}`,{error:r}=await ns.storage.from("community-images").upload(s,b);if(!r){const{data:{publicUrl:e}}=ns.storage.from("community-images").getPublicUrl(s);t=e}}const{error:n}=await ns.from("communities").update({name:d,description:u,privacy:x,icon_url:e||null,cover_image_url:t||null,updated_at:(new Date).toISOString()}).eq("id",a.id);if(n)throw n;r(),s()}catch(t){alert(t.message||"Failed to update community")}finally{l(!1)}},className:"p-4 sm:p-6 space-y-4 sm:space-y-5 overflow-y-auto flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-1.5",children:"Community Name"}),e.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl border border-stone-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 transition-all font-medium text-sm sm:text-base",required:!0,minLength:3,maxLength:50})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-stone-700 mb-1.5",children:["Description ",e.jsx("span",{className:"text-stone-400 font-normal",children:"(Optional)"})]}),e.jsx("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"What is this community about?",className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl border border-stone-200 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100 transition-all min-h-[70px] sm:min-h-[80px] resize-none text-sm sm:text-base",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:"Icon"}),e.jsxs("label",{className:"block cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files?.[0];t&&(f(t),j(URL.createObjectURL(t)))}}),e.jsx("div",{className:"aspect-square rounded-xl border-2 border-dashed border-stone-200 hover:border-indigo-400 transition-colors flex items-center justify-center bg-stone-50 hover:bg-indigo-50/30 overflow-hidden relative group",children:w?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:w,alt:"Icon preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(Qe,{className:"w-6 h-6 text-white"})})]}):e.jsxs("div",{className:"text-center p-2",children:[e.jsx(re,{className:"w-6 h-6 mx-auto text-stone-400 mb-1"}),e.jsx("p",{className:"text-[10px] text-stone-500",children:"Upload Icon"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:"Cover"}),e.jsxs("label",{className:"block cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files?.[0];t&&(v(t),N(URL.createObjectURL(t)))}}),e.jsx("div",{className:"aspect-square rounded-xl border-2 border-dashed border-stone-200 hover:border-indigo-400 transition-colors flex items-center justify-center bg-stone-50 hover:bg-indigo-50/30 overflow-hidden relative group",children:y?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:y,alt:"Cover preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(Qe,{className:"w-6 h-6 text-white"})})]}):e.jsxs("div",{className:"text-center p-2",children:[e.jsx(re,{className:"w-6 h-6 mx-auto text-stone-400 mb-1"}),e.jsx("p",{className:"text-[10px] text-stone-500",children:"Upload Cover"})]})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-stone-700 mb-2",children:"Privacy"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>p("public"),className:"p-3 sm:p-4 rounded-xl border-2 text-left transition-all "+("public"===x?"border-indigo-600 bg-indigo-50/50 ring-1 ring-indigo-600":"border-stone-100 hover:border-stone-200 bg-white"),children:[e.jsx(_,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-1.5 sm:mb-2 "+("public"===x?"text-indigo-600":"text-stone-400")}),e.jsx("div",{className:"font-bold text-xs sm:text-sm text-stone-900",children:"Public"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-stone-500 mt-0.5 sm:mt-1 leading-tight",children:"Anyone can join"})]}),e.jsxs("button",{type:"button",onClick:()=>p("private"),className:"p-3 sm:p-4 rounded-xl border-2 text-left transition-all "+("private"===x?"border-indigo-600 bg-indigo-50/50 ring-1 ring-indigo-600":"border-stone-100 hover:border-stone-200 bg-white"),children:[e.jsx(ut,{className:"w-5 h-5 sm:w-6 sm:h-6 mb-1.5 sm:mb-2 "+("private"===x?"text-indigo-600":"text-stone-400")}),e.jsx("div",{className:"font-bold text-xs sm:text-sm text-stone-900",children:"Private"}),e.jsx("div",{className:"text-[10px] sm:text-xs text-stone-500 mt-0.5 sm:mt-1 leading-tight",children:"Invite only"})]})]})]}),e.jsxs("div",{className:"pt-2 sm:pt-3 sticky bottom-0 bg-white -mx-4 sm:-mx-6 px-4 sm:px-6 pb-4 sm:pb-0 space-y-3",children:[e.jsx("button",{type:"submit",disabled:o||!d,className:"w-full py-3 sm:py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-xl transition-all shadow-lg shadow-indigo-200 hover:shadow-indigo-300 disabled:opacity-50 flex items-center justify-center gap-2 text-sm sm:text-base",children:o?"Updating...":"Save Changes"}),e.jsx("button",{type:"button",onClick:async()=>{if(confirm("Are you strictly sure you want to delete this community? This action CANNOT be undone and will delete all posts and memberships."))if(prompt(`Please type "${a.name}" to confirm deletion:`)===a.name){l(!0);try{const{error:e}=await ns.from("communities").delete().eq("id",a.id);if(e)throw e;alert("Community deleted successfully."),n("/app/communities")}catch(e){alert(e.message||"Failed to delete community")}finally{l(!1)}}else alert("Community name verification failed.")},disabled:o,className:"w-full py-3 sm:py-3.5 bg-red-50 hover:bg-red-100 text-red-600 font-bold rounded-xl transition-all border border-red-100 flex items-center justify-center gap-2 text-sm sm:text-base",children:o?"Processing...":e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-4 h-4"}),"Delete Community"]})})]})]})]})]})}function wn(){const{slug:t}=x(),s=c(),[a,r]=i.useState(null),[n,o]=i.useState(!0),[l,d]=i.useState(!1),[m,u]=i.useState(null),[h,p]=i.useState(!1),{posts:g,loading:f,currentUserId:b,createPost:v,toggleLike:w,toggleRepost:j,toggleComments:y,activeCommentPostId:N,comments:C,loadingComments:S,postComment:z,deleteComment:U,reportPost:P,deletePost:A,votePoll:D,currentUserProfile:L}=hr(a?.id),[M,E]=i.useState(null);i.useEffect(()=>{t&&T()},[t]);const T=async()=>{o(!0);try{const{data:e,error:s}=await ns.from("communities").select("*, community_members(count)").eq("slug",t).single();if(s||!e)throw new Error("Community not found");const a={...e,members_count:e.community_members?.[0]?.count||0};r(a);const{data:{user:n}}=await ns.auth.getUser();if(n){const{data:t}=await ns.from("community_members").select("role").eq("community_id",e.id).eq("user_id",n.id).single();t&&(d(!0),u(t.role))}}catch(e){s("/app/communities")}finally{o(!1)}};return n?e.jsx("div",{className:"p-10 text-center",children:e.jsx("span",{className:"loading loading-spinner text-indigo-600"})}):a?e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-[2.5rem] overflow-hidden border border-stone-100 shadow-xl shadow-stone-200/40 mb-8",children:[e.jsxs("div",{className:"h-48 bg-gradient-to-br from-stone-700 to-stone-900 relative",children:[a.cover_image_url&&e.jsx("img",{src:a.cover_image_url,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/20"})]}),e.jsxs("div",{className:"px-8 pb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-end -mt-12 gap-6 mb-6",children:[e.jsx("div",{className:"w-32 h-32 rounded-3xl bg-white p-1.5 shadow-xl relative z-10",children:e.jsx("div",{className:"w-full h-full rounded-2xl flex items-center justify-center text-4xl font-bold "+(a.icon_url?"":"bg-stone-100 text-stone-400"),children:a.icon_url?e.jsx("img",{src:a.icon_url,className:"w-full h-full object-cover rounded-2xl"}):a.name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-display font-bold text-stone-900 mb-1",children:a.name}),e.jsxs("div",{className:"flex items-center gap-4 text-sm font-medium text-stone-500",children:[e.jsxs("span",{className:"flex items-center gap-1.5",children:["public"===a.privacy?e.jsx(_,{className:"w-4 h-4"}):e.jsx(ut,{className:"w-4 h-4"}),"public"===a.privacy?"Public Group":"Private Group"]}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-stone-300"}),e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"w-4 h-4"}),a.members_count||0," Members"]})]})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsx("button",{onClick:async()=>{if(b&&a)try{l?confirm("Are you sure you want to leave this community?")&&(d(!1),u(null),r(e=>e?{...e,members_count:Math.max(0,(e.members_count||0)-1)}:null),await ns.from("community_members").delete().eq("community_id",a.id).eq("user_id",b)):(d(!0),u("member"),r(e=>e?{...e,members_count:(e.members_count||0)+1}:null),await ns.from("community_members").insert({community_id:a.id,user_id:b}))}catch(e){alert("Failed to update membership")}},className:"flex-1 md:flex-none px-6 py-3 rounded-xl font-bold transition-all "+(l?"bg-stone-100 text-stone-600 hover:bg-red-50 hover:text-red-600 border border-stone-200":"bg-indigo-600 text-white hover:bg-indigo-700 shadow-lg shadow-indigo-200"),children:l?"Joined":"Join Group"}),("admin"===m||"owner"===m)&&e.jsx("button",{onClick:()=>p(!0),className:"p-3 bg-stone-100 hover:bg-stone-200 text-stone-600 rounded-xl transition-colors",title:"Edit Community",children:e.jsx(V,{className:"w-5 h-5"})})]})]}),e.jsx("p",{className:"text-stone-600 leading-relaxed max-w-3xl",children:a.description})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[l?e.jsx(Ha,{user:L,onCreate:v,communityId:a.id}):e.jsx("div",{className:"bg-indigo-50 border border-indigo-100 rounded-2xl p-6 text-center",children:e.jsx("p",{className:"font-bold text-indigo-900",children:"Join this community to start posting!"})}),e.jsx("div",{className:"space-y-6",children:f?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):0===g.length?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-stone-400 text-lg font-medium",children:"No posts yet"}),e.jsx("p",{className:"text-stone-400 text-sm mt-2",children:"Be the first to post in this community!"})]}):g.map(t=>e.jsx(tr,{post:t,currentUserId:b,isActiveCommentSection:N===t.id,isActiveMenu:M===t.id,comments:C[t.id]||[],loadingComments:S,onDelete:()=>A(t.id),onLike:()=>w(t),onRepost:(e,t)=>j(e,t),onToggleComments:()=>y(t.id),onToggleMenu:()=>E(e=>e===t.id?null:t.id),onPostComment:e=>z(t.id,e),onSearchTag:()=>{},onReport:()=>P(t.id),onDeleteComment:U,onVotePoll:D,isInCommunityFeed:!0},t.id))})]}),e.jsx("div",{className:"lg:col-span-4 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-stone-100 shadow-sm",children:[e.jsx("h3",{className:"font-bold text-stone-900 mb-4",children:"About"}),e.jsxs("div",{className:"space-y-4 text-sm font-medium text-stone-500",children:[e.jsxs("div",{className:"flex justify-between border-b border-stone-50 pb-3",children:[e.jsx("span",{children:"Created"}),e.jsx("span",{className:"text-stone-900",children:new Date(a.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between border-b border-stone-50 pb-3",children:[e.jsx("span",{children:"Privacy"}),e.jsx("span",{className:"text-stone-900 capitalise",children:a.privacy})]})]})]})})]}),a&&e.jsx(vn,{isOpen:h,onClose:()=>p(!1),community:a,onUpdate:()=>{T()}})]}):null}const jn={School:"School",Skill:"Skill",Tech:"Tech",Business:"Business",Creative:"Creative",Language:"Language",Health:"Health",Other:"Other"},yn=["Beginner","Intermediate","Advanced"];function Nn(){const[t,s]=i.useState("All"),[a,r]=i.useState(""),[n,o]=i.useState(!1),{courses:l,loading:d,createCourse:c,toggleLike:m,toggleEnrollment:u}=function(e,t){const[s,a]=i.useState([]),[r,n]=i.useState(!0),[o,l]=i.useState(null);i.useEffect(()=>{ns.auth.getUser().then(({data:e})=>{l(e.user?.id||null)})},[]);const d=i.useCallback(async()=>{try{n(!0);let s=ns.from("courses").select("\n                    *,\n                    profiles:author_id (\n                        id,\n                        name,\n                        avatar_url,\n                        university,\n                        is_verified\n                    )\n                ").order("created_at",{ascending:!1});e&&(s=s.eq("category",e)),t&&(s=s.or(`title.ilike.%${t}%,description.ilike.%${t}%`));const{data:r,error:i}=await s;if(i)throw i;if(o&&r){const e=r.map(e=>e.id),{data:t}=await ns.from("course_likes").select("course_id").in("course_id",e).eq("user_id",o),{data:s}=await ns.from("course_enrollments").select("course_id").in("course_id",e).eq("user_id",o),n=new Set(t?.map(e=>e.course_id)||[]),i=new Set(s?.map(e=>e.course_id)||[]),l=r.map(e=>({...e,user_has_liked:n.has(e.id),user_has_enrolled:i.has(e.id)}));a(l)}else a(r||[])}catch(s){}finally{n(!1)}},[e,t,o]);return i.useEffect(()=>{d()},[d]),{courses:s,loading:r,currentUserId:o,createCourse:async e=>{try{const t=Wa(e.youtube_url);if(!t)throw new Error("Invalid YouTube URL");const{data:{user:s}}=await ns.auth.getUser();if(!s)throw new Error("Not authenticated");const{data:r,error:n}=await ns.from("courses").insert({title:e.title,description:e.description||null,youtube_url:e.youtube_url,video_id:t,category:e.category,level:e.level,tags:e.tags||null,author_id:s.id,thumbnail_url:Ka(t,"hq")}).select("\n                    *,\n                    profiles:author_id (\n                        id,\n                        name,\n                        avatar_url,\n                        university,\n                        is_verified\n                    )\n                ").single();if(n)throw n;return a(e=>[r,...e]),r}catch(t){throw t}},deleteCourse:async e=>{try{const{error:t}=await ns.from("courses").delete().eq("id",e);if(t)throw t;a(t=>t.filter(t=>t.id!==e))}catch(t){throw t}},toggleLike:async e=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const r=s.find(t=>t.id===e);if(!r)return;r.user_has_liked?(await ns.from("course_likes").delete().eq("course_id",e).eq("user_id",t.id),a(t=>t.map(t=>t.id===e?{...t,user_has_liked:!1,likes_count:t.likes_count-1}:t))):(await ns.from("course_likes").insert({course_id:e,user_id:t.id}),a(t=>t.map(t=>t.id===e?{...t,user_has_liked:!0,likes_count:t.likes_count+1}:t)))}catch(t){}},toggleEnrollment:async e=>{try{const{data:{user:t}}=await ns.auth.getUser();if(!t)return;const r=s.find(t=>t.id===e);if(!r)return;r.user_has_enrolled?(await ns.from("course_enrollments").delete().eq("course_id",e).eq("user_id",t.id),a(t=>t.map(t=>t.id===e?{...t,user_has_enrolled:!1,enrollments_count:t.enrollments_count-1}:t))):(await ns.from("course_enrollments").insert({course_id:e,user_id:t.id}),a(t=>t.map(t=>t.id===e?{...t,user_has_enrolled:!0,enrollments_count:t.enrollments_count+1}:t)))}catch(t){}},incrementViews:async e=>{try{await ns.rpc("increment_course_views",{course_id:e}),a(t=>t.map(t=>t.id===e?{...t,views_count:t.views_count+1}:t))}catch(t){}},refetch:d}}("All"===t?void 0:t,a),h=a?l.filter(e=>e.title.toLowerCase().includes(a.toLowerCase())||e.description?.toLowerCase().includes(a.toLowerCase())||e.tags?.some(e=>e.toLowerCase().includes(a.toLowerCase()))):l;return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"max-w-7xl mx-auto pb-20",children:[e.jsx("div",{className:"sticky top-0 z-30 bg-white/95 dark:bg-zinc-950/95 backdrop-blur-sm border-b border-stone-200/80 dark:border-zinc-800 mb-6",children:e.jsxs("div",{className:"px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ht,{className:"w-6 h-6 text-emerald-600"}),e.jsx("h1",{className:"text-2xl font-bold text-stone-900 dark:text-zinc-100",children:"Courses"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Course"})]})]}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400 dark:text-zinc-600"}),e.jsx("input",{type:"text",placeholder:"Search courses...",value:a,onChange:e=>r(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-stone-100/80 dark:bg-zinc-900/80 border border-stone-200/50 dark:border-zinc-800/50 rounded-lg text-sm text-stone-900 dark:text-zinc-100 placeholder:text-stone-500 dark:placeholder:text-zinc-600 focus:ring-1 focus:ring-emerald-500/50 focus:border-emerald-500/50 transition-all"})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 no-scrollbar",children:[e.jsx("button",{onClick:()=>s("All"),className:"px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-all "+("All"===t?"bg-emerald-600 text-white":"bg-stone-100 dark:bg-zinc-900 text-stone-700 dark:text-zinc-300 hover:bg-stone-200 dark:hover:bg-zinc-800"),children:"All"}),Object.keys(jn).map(a=>e.jsx("button",{onClick:()=>s(a),className:"px-4 py-1.5 rounded-full text-sm font-medium whitespace-nowrap transition-all "+(t===a?"bg-emerald-600 text-white":"bg-stone-100 dark:bg-zinc-900 text-stone-700 dark:text-zinc-300 hover:bg-stone-200 dark:hover:bg-zinc-800"),children:a},a))]})]})}),0===h.length?e.jsxs("div",{className:"text-center py-16 px-4",children:[e.jsx(ht,{className:"w-16 h-16 text-stone-300 dark:text-zinc-700 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-stone-900 dark:text-zinc-100 mb-2",children:a?"No courses found":"No courses yet"}),e.jsx("p",{className:"text-stone-500 dark:text-zinc-500 mb-6",children:a?"Try a different search term":"Be the first to share a course!"}),!a&&e.jsxs("button",{onClick:()=>o(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(ae,{className:"w-5 h-5"}),"Add Course"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 px-4",children:h.map(t=>e.jsxs("article",{className:"bg-white dark:bg-zinc-900 border border-stone-200/80 dark:border-zinc-800 hover:border-stone-300 dark:hover:border-zinc-700 transition-all group",children:[e.jsxs("div",{className:"relative aspect-video bg-black overflow-hidden",children:[t.thumbnail_url&&e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),e.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/80 backdrop-blur-sm rounded text-xs text-white font-medium",children:t.category})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("img",{src:t.profiles?.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(t.profiles?.name||"User")}`,alt:t.profiles?.name,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-stone-700 dark:text-zinc-300",children:t.profiles?.name})]}),e.jsx("h3",{className:"font-semibold text-[15px] text-stone-900 dark:text-zinc-100 mb-2 line-clamp-2 leading-tight",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400 mb-3 line-clamp-2 leading-relaxed",children:t.description}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:t.tags.slice(0,3).map((t,s)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-stone-100 dark:bg-zinc-800 text-xs text-stone-600 dark:text-zinc-400 rounded",children:[e.jsx(xt,{className:"w-3 h-3"}),t]},s))}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-stone-500 dark:text-zinc-500 mb-3 pt-3 border-t border-stone-100 dark:border-zinc-800",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-3.5 h-3.5"}),t.enrollments_count]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),t.likes_count]}),e.jsx("span",{className:"px-2 py-0.5 bg-stone-100 dark:bg-zinc-800 rounded text-[11px] font-medium",children:t.level})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(t.id),className:"flex-1 py-2 rounded-lg font-medium text-sm transition-colors "+(t.user_has_enrolled?"bg-emerald-100 dark:bg-emerald-950/30 text-emerald-700 dark:text-emerald-500":"bg-emerald-600 hover:bg-emerald-700 text-white"),children:t.user_has_enrolled?"Enrolled":"Enroll"}),e.jsx("button",{onClick:()=>m(t.id),className:"p-2 rounded-lg transition-colors "+(t.user_has_liked?"bg-red-50 dark:bg-red-950/30 text-red-500":"bg-stone-100 dark:bg-zinc-800 text-stone-600 dark:text-zinc-400 hover:bg-stone-200 dark:hover:bg-zinc-700"),children:e.jsx(pe,{className:"w-5 h-5 "+(t.user_has_liked?"fill-current":"")})})]})]})]},t.id))}),n&&e.jsx(kn,{onClose:()=>o(!1),onCreate:async e=>{try{await c(e),o(!1)}catch(t){alert("Failed to create course. Please try again.")}}}),e.jsx("style",{children:"\n                .no-scrollbar::-webkit-scrollbar {\n                    display: none;\n                }\n                .no-scrollbar {\n                    -ms-overflow-style: none;\n                    scrollbar-width: none;\n                }\n            "})]})}function kn({onClose:t,onCreate:s}){const[a,r]=i.useState(""),[n,o]=i.useState(""),[l,d]=i.useState(""),[c,m]=i.useState("School"),[u,h]=i.useState("Beginner"),[x,p]=i.useState(""),[g,f]=i.useState(""),[b,v]=i.useState(!1),w=Wa(l),j=w?Ka(w):null;return e.jsx(Jr,{isOpen:!0,onClose:t,title:"Add New Course",size:"2xl",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),null!==Wa(l)){v(!0);try{const e=x.split(",").map(e=>e.trim()).filter(e=>e.length>0);await s({title:a,description:n||void 0,youtube_url:l,category:c,level:u,tags:e.length>0?e:void 0})}finally{v(!1)}}else f("Please enter a valid YouTube URL")},className:"p-4 sm:p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"YouTube URL *"}),e.jsx("input",{type:"text",required:!0,value:l,onChange:e=>{d(e.target.value),f("")},placeholder:"https://www.youtube.com/watch?v=...",className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 placeholder:text-stone-400 dark:placeholder:text-zinc-600 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all"}),g&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 dark:text-red-500 flex items-center gap-1",children:[e.jsx(pt,{className:"w-4 h-4"}),g]}),j&&!g&&e.jsx("img",{src:j,alt:"Video thumbnail",className:"mt-3 w-full aspect-video object-cover rounded-lg border border-stone-200 dark:border-zinc-800"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"Course Title *"}),e.jsx("input",{type:"text",required:!0,value:a,onChange:e=>r(e.target.value),placeholder:"e.g., Introduction to React Hooks",className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 placeholder:text-stone-400 dark:placeholder:text-zinc-600 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"Description"}),e.jsx("textarea",{value:n,onChange:e=>o(e.target.value),placeholder:"Brief description of what students will learn...",rows:3,className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 placeholder:text-stone-400 dark:placeholder:text-zinc-600 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"Category *"}),e.jsx("select",{value:c,onChange:e=>m(e.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all",children:Object.keys(jn).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"Level *"}),e.jsx("select",{value:u,onChange:e=>h(e.target.value),className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all",children:yn.map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-stone-700 dark:text-zinc-300 mb-2",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:x,onChange:e=>p(e.target.value),placeholder:"react, javascript, hooks, frontend",className:"w-full px-4 py-2.5 bg-white dark:bg-zinc-950 border border-stone-200 dark:border-zinc-800 rounded-lg text-stone-900 dark:text-zinc-100 placeholder:text-stone-400 dark:placeholder:text-zinc-600 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 bg-stone-100 dark:bg-zinc-800 hover:bg-stone-200 dark:hover:bg-zinc-700 text-stone-700 dark:text-zinc-300 font-medium rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b||!a||!l,className:"flex-1 px-4 py-2.5 bg-emerald-600 hover:bg-emerald-700 disabled:bg-stone-300 dark:disabled:bg-zinc-700 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"w-4 h-4"}),"Create Course"]})})]})]})})}const _n=[{points:10,title:"Create a Post",description:"Share your thoughts"},{points:2,title:"Receive a Like",description:"On your posts"},{points:5,title:"Comment",description:"Engage in discussions"},{points:15,title:"Make a Connection",description:"Both users earn points"},{points:110,title:"Complete Your Profile",description:"One-time bonus for adding avatar, headline, about, skills, and experience",span:!0}];function Cn(){const[t,s]=i.useState([]),[a,r]=i.useState(null),[n,o]=i.useState(!0),[l,c]=i.useState(null);i.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const{data:{user:e}}=await ns.auth.getUser();c(e?.id||null);const{data:t,error:a}=await ns.rpc("get_leaderboard",{p_limit:100,p_offset:0});if(a)throw a;if(s(t||[]),e?.id){const{data:t,error:s}=await ns.rpc("get_user_rank",{p_user_id:e.id});!s&&t&&t.length>0&&r(t[0])}}catch(e){}finally{o(!1)}},u=t=>1===t?e.jsx(Y,{className:"w-6 h-6 text-yellow-500"}):2===t?e.jsx(gt,{className:"w-6 h-6 text-gray-400"}):3===t?e.jsx(gt,{className:"w-6 h-6 text-amber-600"}):e.jsxs("span",{className:"text-lg font-bold text-stone-500 dark:text-zinc-500",children:["#",t]});return n?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#FAFAFA] dark:bg-zinc-950",children:e.jsx(M,{className:"w-8 h-8 animate-spin text-emerald-600"})}):e.jsxs("div",{className:"min-h-screen bg-[#FAFAFA] dark:bg-zinc-950",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-12 px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Y,{className:"w-10 h-10"}),e.jsx("h1",{className:"text-4xl font-bold",children:"Leaderboard"})]}),e.jsx("p",{className:"text-emerald-50 text-lg",children:"Top 100 most active students on UniLink"}),a&&e.jsx("div",{className:"mt-6 bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-50 text-sm font-medium mb-1",children:"Your Rank"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-4xl font-bold",children:["#",a.rank]}),e.jsxs("div",{className:"text-left",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[a.points," pts"]}),e.jsxs("p",{className:"text-emerald-100 text-sm",children:["out of ",a.total_users.toLocaleString()," students"]})]})]})]}),e.jsx(P,{className:"w-12 h-12 text-emerald-200"})]})})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl border border-stone-200 dark:border-zinc-800 overflow-hidden",children:[t.map((s,a)=>{return e.jsxs(d,{to:`/app/profile/${s.username||s.user_id}`,className:`flex items-center gap-4 p-5 transition-all hover:bg-stone-50 dark:hover:bg-zinc-800 ${a!==t.length-1?"border-b border-stone-200 dark:border-zinc-800":""} ${s.user_id===l?"bg-emerald-50 dark:bg-emerald-950/20":""}`,children:[e.jsx("div",{className:"flex items-center justify-center w-16 h-16 rounded-xl "+(r=s.rank,1===r?"bg-gradient-to-r from-yellow-400 to-yellow-600 text-white":2===r?"bg-gradient-to-r from-gray-300 to-gray-500 text-white":3===r?"bg-gradient-to-r from-amber-500 to-amber-700 text-white":r<=10?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400":"bg-stone-100 dark:bg-zinc-800 text-stone-700 dark:text-zinc-300"),children:u(s.rank)}),e.jsx("div",{className:"w-14 h-14 rounded-full overflow-hidden bg-gradient-to-br from-stone-100 to-stone-200 dark:from-zinc-800 dark:to-zinc-700 flex-shrink-0",children:e.jsx("img",{src:s.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.name)}&background=random`,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-stone-900 dark:text-zinc-100 truncate",children:s.name}),s.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-yellow-500 fill-yellow-50 flex-shrink-0"}),s.is_verified&&!s.gold_verified&&e.jsx(ee,{className:"w-4 h-4 text-blue-500 fill-blue-50 dark:fill-blue-950 flex-shrink-0"})]}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400 truncate",children:s.headline||s.university||"Student"})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-500"}),e.jsx("span",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-500",children:s.points.toLocaleString()})]}),e.jsx("p",{className:"text-xs text-stone-500 dark:text-zinc-500 mt-1",children:"points"})]})]},s.user_id);var r}),0===t.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"w-16 h-16 text-stone-300 dark:text-zinc-700 mx-auto mb-4"}),e.jsx("p",{className:"text-stone-500 dark:text-zinc-500",children:"No leaderboard data available yet"})]})]}),e.jsxs("div",{className:"mt-8 bg-white dark:bg-zinc-900 rounded-2xl border border-stone-200 dark:border-zinc-800 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-stone-900 dark:text-zinc-100 mb-4 flex items-center gap-2",children:[e.jsx(at,{className:"w-6 h-6 text-emerald-600"}),"How to Earn Points"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_n.map((t,s)=>e.jsxs("div",{className:"flex items-start gap-3 "+(t.span?"md:col-span-2":""),children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center flex-shrink-0",children:e.jsxs("span",{className:"text-emerald-600 dark:text-emerald-500 font-bold",children:["+",t.points]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-stone-900 dark:text-zinc-100",children:t.title}),e.jsx("p",{className:"text-sm text-stone-600 dark:text-zinc-400",children:t.description})]})]},s))})]})]})]})}var Sn={};!function e(t,s,a,r){var n=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),i="function"==typeof Path2D&&"function"==typeof DOMMatrix;function o(){}function l(e){var a=s.exports.Promise,r=void 0!==a?a:t.Promise;return"function"==typeof r?new r(e):(e(o,o),null)}var d,c,m,u,h,x,p=function(e,t){return{transform:function(s){if(e)return s;if(t.has(s))return t.get(s);var a=new OffscreenCanvas(s.width,s.height);return a.getContext("2d").drawImage(s,0,0),t.set(s,a),a},clear:function(){t.clear()}}}(function(){if(!t.OffscreenCanvas)return!1;try{var e=new OffscreenCanvas(1,1),s=e.getContext("2d");s.fillRect(0,0,1,1);var a=e.transferToImageBitmap();s.createPattern(a,"no-repeat")}catch(r){return!1}return!0}(),new Map),g=(m=Math.floor(1e3/60),u={},h=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(d=function(e){var t=Math.random();return u[t]=requestAnimationFrame(function s(a){h===a||h+m-1<a?(h=a,delete u[t],e()):u[t]=requestAnimationFrame(s)}),t},c=function(e){u[e]&&cancelAnimationFrame(u[e])}):(d=function(e){return setTimeout(e,m)},c=function(e){return clearTimeout(e)}),{frame:d,cancel:c}),f=function(){var t,s,r={};return function(){if(t)return t;if(!a&&n){var i=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{t=new Worker(URL.createObjectURL(new Blob([i])))}catch(o){return"undefined"!=typeof console&&console.warn,null}!function(e){function t(t,s){e.postMessage({options:t||{},callback:s})}e.init=function(t){var s=t.transferControlToOffscreen();e.postMessage({canvas:s},[s])},e.fire=function(a,n,i){if(s)return t(a,null),s;var o=Math.random().toString(36).slice(2);return s=l(function(n){function l(t){t.data.callback===o&&(delete r[o],e.removeEventListener("message",l),s=null,p.clear(),i(),n())}e.addEventListener("message",l),t(a,o),r[o]=l.bind(null,{data:{callback:o}})})},e.reset=function(){for(var t in e.postMessage({reset:!0}),r)r[t](),delete r[t]}}(t)}return t}}(),b={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(e,t,s){return function(e,t){return t?t(e):e}(e&&null!=e[t]?e[t]:b[t],s)}function w(e){return e<0?0:Math.floor(e)}function j(e,t){return Math.floor(Math.random()*(t-e))+e}function y(e){return parseInt(e,16)}function N(e){return e.map(k)}function k(e){var t=String(e).replace(/[^0-9a-f]/gi,"");return t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),{r:y(t.substring(0,2)),g:y(t.substring(2,4)),b:y(t.substring(4,6))}}function _(e){e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight}function C(e){var t=e.getBoundingClientRect();e.width=t.width,e.height=t.height}function S(e){var t=e.angle*(Math.PI/180),s=e.spread*(Math.PI/180);return{x:e.x,y:e.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*e.startVelocity+Math.random()*e.startVelocity,angle2D:-t+(.5*s-Math.random()*s),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:e.color,shape:e.shape,tick:0,totalTicks:e.ticks,decay:e.decay,drift:e.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*e.gravity,ovalScalar:.6,scalar:e.scalar,flat:e.flat}}function z(e,t){t.x+=Math.cos(t.angle2D)*t.velocity+t.drift,t.y+=Math.sin(t.angle2D)*t.velocity+t.gravity,t.velocity*=t.decay,t.flat?(t.wobble=0,t.wobbleX=t.x+10*t.scalar,t.wobbleY=t.y+10*t.scalar,t.tiltSin=0,t.tiltCos=0,t.random=1):(t.wobble+=t.wobbleSpeed,t.wobbleX=t.x+10*t.scalar*Math.cos(t.wobble),t.wobbleY=t.y+10*t.scalar*Math.sin(t.wobble),t.tiltAngle+=.1,t.tiltSin=Math.sin(t.tiltAngle),t.tiltCos=Math.cos(t.tiltAngle),t.random=Math.random()+2);var s=t.tick++/t.totalTicks,a=t.x+t.random*t.tiltCos,r=t.y+t.random*t.tiltSin,n=t.wobbleX+t.random*t.tiltCos,o=t.wobbleY+t.random*t.tiltSin;if(e.fillStyle="rgba("+t.color.r+", "+t.color.g+", "+t.color.b+", "+(1-s)+")",e.beginPath(),i&&"path"===t.shape.type&&"string"==typeof t.shape.path&&Array.isArray(t.shape.matrix))e.fill(function(e,t,s,a,r,n,i){var o=new Path2D(e),l=new Path2D;l.addPath(o,new DOMMatrix(t));var d=new Path2D;return d.addPath(l,new DOMMatrix([Math.cos(i)*r,Math.sin(i)*r,-Math.sin(i)*n,Math.cos(i)*n,s,a])),d}(t.shape.path,t.shape.matrix,t.x,t.y,.1*Math.abs(n-a),.1*Math.abs(o-r),Math.PI/10*t.wobble));else if("bitmap"===t.shape.type){var l=Math.PI/10*t.wobble,d=.1*Math.abs(n-a),c=.1*Math.abs(o-r),m=t.shape.bitmap.width*t.scalar,u=t.shape.bitmap.height*t.scalar,h=new DOMMatrix([Math.cos(l)*d,Math.sin(l)*d,-Math.sin(l)*c,Math.cos(l)*c,t.x,t.y]);h.multiplySelf(new DOMMatrix(t.shape.matrix));var x=e.createPattern(p.transform(t.shape.bitmap),"no-repeat");x.setTransform(h),e.globalAlpha=1-s,e.fillStyle=x,e.fillRect(t.x-m/2,t.y-u/2,m,u),e.globalAlpha=1}else if("circle"===t.shape)e.ellipse?e.ellipse(t.x,t.y,Math.abs(n-a)*t.ovalScalar,Math.abs(o-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI):function(e,t,s,a,r,n,i,o,l){e.save(),e.translate(t,s),e.rotate(n),e.scale(a,r),e.arc(0,0,1,i,o,l),e.restore()}(e,t.x,t.y,Math.abs(n-a)*t.ovalScalar,Math.abs(o-r)*t.ovalScalar,Math.PI/10*t.wobble,0,2*Math.PI);else if("star"===t.shape)for(var g=Math.PI/2*3,f=4*t.scalar,b=8*t.scalar,v=t.x,w=t.y,j=5,y=Math.PI/j;j--;)v=t.x+Math.cos(g)*b,w=t.y+Math.sin(g)*b,e.lineTo(v,w),g+=y,v=t.x+Math.cos(g)*f,w=t.y+Math.sin(g)*f,e.lineTo(v,w),g+=y;else e.moveTo(Math.floor(t.x),Math.floor(t.y)),e.lineTo(Math.floor(t.wobbleX),Math.floor(r)),e.lineTo(Math.floor(n),Math.floor(o)),e.lineTo(Math.floor(a),Math.floor(t.wobbleY));return e.closePath(),e.fill(),t.tick<t.totalTicks}function U(e,s){var i,o=!e,d=!!v(s||{},"resize"),c=!1,m=v(s,"disableForReducedMotion",Boolean),u=n&&!!v(s||{},"useWorker")?f():null,h=o?_:C,x=!(!e||!u)&&!!e.__confetti_initialized,b="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function y(t,s,n){for(var o=v(t,"particleCount",w),d=v(t,"angle",Number),c=v(t,"spread",Number),m=v(t,"startVelocity",Number),u=v(t,"decay",Number),x=v(t,"gravity",Number),f=v(t,"drift",Number),b=v(t,"colors",N),y=v(t,"ticks",Number),k=v(t,"shapes"),_=v(t,"scalar"),C=!!v(t,"flat"),U=function(e){var t=v(e,"origin",Object);return t.x=v(t,"x",Number),t.y=v(t,"y",Number),t}(t),P=o,A=[],D=e.width*U.x,L=e.height*U.y;P--;)A.push(S({x:D,y:L,angle:d,spread:c,startVelocity:m,color:b[P%b.length],shape:k[j(0,k.length)],ticks:y,decay:u,gravity:x,drift:f,scalar:_,flat:C}));return i?i.addFettis(A):(i=function(e,t,s,n,i){var o,d,c=t.slice(),m=e.getContext("2d"),u=l(function(t){function l(){o=d=null,m.clearRect(0,0,n.width,n.height),p.clear(),i(),t()}o=g.frame(function t(){!a||n.width===r.width&&n.height===r.height||(n.width=e.width=r.width,n.height=e.height=r.height),n.width||n.height||(s(e),n.width=e.width,n.height=e.height),m.clearRect(0,0,n.width,n.height),(c=c.filter(function(e){return z(m,e)})).length?o=g.frame(t):l()}),d=l});return{addFettis:function(e){return c=c.concat(e),u},canvas:e,promise:u,reset:function(){o&&g.cancel(o),d&&d()}}}(e,A,h,s,n),i.promise)}function k(s){var a=m||v(s,"disableForReducedMotion",Boolean),r=v(s,"zIndex",Number);if(a&&b)return l(function(e){e()});o&&i?e=i.canvas:o&&!e&&(e=function(e){var t=document.createElement("canvas");return t.style.position="fixed",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=e,t}(r),document.body.appendChild(e)),d&&!x&&h(e);var n={width:e.width,height:e.height};function p(){if(u){var t={getBoundingClientRect:function(){if(!o)return e.getBoundingClientRect()}};return h(t),void u.postMessage({resize:{width:t.width,height:t.height}})}n.width=n.height=null}function g(){i=null,d&&(c=!1,t.removeEventListener("resize",p)),o&&e&&(document.body.contains(e)&&document.body.removeChild(e),e=null,x=!1)}return u&&!x&&u.init(e),x=!0,u&&(e.__confetti_initialized=!0),d&&!c&&(c=!0,t.addEventListener("resize",p,!1)),u?u.fire(s,n,g):y(s,n,g)}return k.reset=function(){u&&u.reset(),i&&i.reset()},k}function P(){return x||(x=U(null,{useWorker:!0,resize:!0})),x}s.exports=function(){return P().apply(this,arguments)},s.exports.reset=function(){P().reset()},s.exports.create=U,s.exports.shapeFromPath=function(e){if(!i)throw new Error("path confetti are not supported in this browser");var t,s;"string"==typeof e?t=e:(t=e.path,s=e.matrix);var a=new Path2D(t),r=document.createElement("canvas").getContext("2d");if(!s){for(var n,o,l=1e3,d=l,c=l,m=0,u=0,h=0;h<l;h+=2)for(var x=0;x<l;x+=2)r.isPointInPath(a,h,x,"nonzero")&&(d=Math.min(d,h),c=Math.min(c,x),m=Math.max(m,h),u=Math.max(u,x));n=m-d,o=u-c;var p=Math.min(10/n,10/o);s=[p,0,0,p,-Math.round(n/2+d)*p,-Math.round(o/2+c)*p]}return{type:"path",path:t,matrix:s}},s.exports.shapeFromText=function(e){var t,s=1,a="#000000",r='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';"string"==typeof e?t=e:(t=e.text,s="scalar"in e?e.scalar:s,r="fontFamily"in e?e.fontFamily:r,a="color"in e?e.color:a);var n=10*s,i=n+"px "+r,o=new OffscreenCanvas(n,n),l=o.getContext("2d");l.font=i;var d=l.measureText(t),c=Math.ceil(d.actualBoundingBoxRight+d.actualBoundingBoxLeft),m=Math.ceil(d.actualBoundingBoxAscent+d.actualBoundingBoxDescent),u=d.actualBoundingBoxLeft+2,h=d.actualBoundingBoxAscent+2;c+=4,m+=4,(l=(o=new OffscreenCanvas(c,m)).getContext("2d")).font=i,l.fillStyle=a,l.fillText(t,u,h);var x=1/s;return{type:"bitmap",bitmap:o.transferToImageBitmap(),matrix:[x,0,0,x,-c*x/2,-m*x/2]}}}(function(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:this||{}}(),Sn,!1);const zn=Sn.exports;Sn.exports.create;const Un=[{bg:"bg-emerald-500",light:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-300",bar:"bg-emerald-500"},{bg:"bg-sky-500",light:"bg-sky-100 dark:bg-sky-900/30",text:"text-sky-700 dark:text-sky-300",bar:"bg-sky-500"},{bg:"bg-violet-500",light:"bg-violet-100 dark:bg-violet-900/30",text:"text-violet-700 dark:text-violet-300",bar:"bg-violet-500"},{bg:"bg-orange-500",light:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-300",bar:"bg-orange-500"},{bg:"bg-pink-500",light:"bg-pink-100 dark:bg-pink-900/30",text:"text-pink-700 dark:text-pink-300",bar:"bg-pink-500"},{bg:"bg-amber-500",light:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",bar:"bg-amber-500"}],Pn=["🥇","🥈","🥉"],An=["bg-yellow-50 border-yellow-300 dark:bg-yellow-900/20 dark:border-yellow-600","bg-stone-50 border-stone-300 dark:bg-stone-800/40 dark:border-stone-500","bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-600"];function Dn(){const[t,s]=i.useState([]),[a,r]=i.useState(0),[n,o]=i.useState({}),[l,d]=i.useState({}),[c,m]=i.useState(!0),[u,h]=i.useState(!1),[x,p]=i.useState(null),g=t[a]??null;i.useEffect(()=>{ns.auth.getUser().then(({data:e})=>p(e.user?.id??null))},[]);const f=i.useCallback(async()=>{const{data:{user:e}}=await ns.auth.getUser(),{data:t}=await ns.from("polls").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(!t||0===t.length)return s([]),void m(!1);if(s(t),e){const{data:s}=await ns.from("poll_votes").select("poll_id, option_id").eq("user_id",e.id).in("poll_id",t.map(e=>e.id));if(s){const e={};s.forEach(t=>{e[t.poll_id]=t.option_id}),o(e),await Promise.all(s.map(async e=>{const{data:t}=await ns.rpc("get_poll_results",{p_poll_id:e.poll_id});t&&d(s=>({...s,[e.poll_id]:t}))}))}}m(!1)},[]);i.useEffect(()=>{f();const e=ns.channel("poll_votes_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"poll_votes"},e=>{const t=e.new?.poll_id;t&&ns.rpc("get_poll_results",{p_poll_id:t}).then(({data:e})=>{e&&d(s=>({...s,[t]:e}))})}).subscribe();return()=>{ns.removeChannel(e)}},[f]);if(c)return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx("div",{className:"w-12 h-12 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin"})});if(!g)return e.jsxs("div",{className:"max-w-2xl mx-auto text-center py-24 space-y-4",children:[e.jsx("div",{className:"text-6xl",children:"⚡"}),e.jsx("h2",{className:"text-2xl font-bold text-stone-900 dark:text-white",children:"No Active Challenges"}),e.jsx("p",{className:"text-stone-500 dark:text-zinc-400",children:"Check back soon — admins drop new challenges regularly!"})]});const b=n[g.id],v=l[g.id],w=!!b;return e.jsxs("div",{className:"max-w-3xl mx-auto space-y-6 pb-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-emerald-500 to-teal-600 text-white rounded-2xl shadow-lg shadow-emerald-200 dark:shadow-emerald-900/30",children:e.jsx(H,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-stone-900 dark:text-white font-display",children:"Campus Challenge"}),e.jsx("p",{className:"text-stone-500 dark:text-zinc-400 text-sm",children:"Vote · Compare · See your university rank"})]}),t.length>1&&e.jsx("div",{className:"ml-auto flex items-center gap-1.5 text-sm text-stone-500 dark:text-zinc-400",children:t.map((t,s)=>e.jsx("button",{onClick:()=>r(s),className:"w-2.5 h-2.5 rounded-full transition-all "+(s===a?"bg-emerald-500 scale-125":"bg-stone-300 dark:bg-zinc-600 hover:bg-stone-400")},s))})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-xl shadow-stone-100 dark:shadow-zinc-900/50 overflow-hidden",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-stone-100 dark:border-zinc-800",children:[g.description&&e.jsx("p",{className:"text-sm text-stone-500 dark:text-zinc-400 mb-2",children:g.description}),e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-stone-900 dark:text-white leading-snug",children:g.question}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx(k,{className:"w-3.5 h-3.5 text-stone-400"}),e.jsxs("span",{className:"text-xs text-stone-400",children:[v?.total??0," vote",1!==(v?.total??0)?"s":""," · ",w?"You voted":"Cast your vote"]})]})]}),e.jsxs("div",{className:"p-6 space-y-3",children:[g.options.map((t,s)=>{const a=Un[s%Un.length],r=v?.by_option?.[t.id]??0,i=v&&v.total>0?Math.round(r/v.total*100):0,l=b===t.id,c=w&&v&&Object.entries(v.by_option).sort((e,t)=>t[1]-e[1])[0]?.[0]===t.id;return e.jsx("button",{onClick:()=>!w&&(async e=>{if(!g||!x||n[g.id]||u)return;h(!0);const{data:t}=await ns.from("profiles").select("university").eq("id",x).single(),{error:s}=await ns.from("poll_votes").insert({poll_id:g.id,user_id:x,option_id:e,university:t?.university??null});if(!s){o(t=>({...t,[g.id]:e}));const{data:t}=await ns.rpc("get_poll_results",{p_poll_id:g.id});t&&d(e=>({...e,[g.id]:t})),zn({particleCount:120,spread:80,origin:{y:.6},colors:["#10b981","#3b82f6","#8b5cf6","#f59e0b"]})}h(!1)})(t.id),disabled:w||u,className:"w-full text-left rounded-2xl border-2 transition-all duration-200 overflow-hidden "+(w?l?`${a.light} border-current ${a.text} cursor-default`:"bg-stone-50 dark:bg-zinc-800/60 border-stone-200 dark:border-zinc-700 cursor-default opacity-80":`bg-stone-50 dark:bg-zinc-800 border-stone-200 dark:border-zinc-700 hover:border-current hover:${a.light} hover:${a.text} active:scale-[0.98]`),children:e.jsxs("div",{className:"relative p-4",children:[w&&e.jsx("div",{className:`absolute inset-0 ${a.bar} opacity-10 transition-all duration-700`,style:{width:`${i}%`}}),e.jsxs("div",{className:"relative flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:t.emoji}),e.jsx("span",{className:`font-semibold text-base ${w?l?a.text:"text-stone-700 dark:text-zinc-200":"text-stone-800 dark:text-white"}`,children:t.text}),l&&e.jsx(N,{className:`w-4 h-4 ${a.text}`}),c&&!l&&e.jsx("span",{className:"text-xs font-bold text-stone-500",children:"📈 Leading"})]}),w&&e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx("span",{className:"text-sm text-stone-500 dark:text-zinc-400",children:r}),e.jsxs("span",{className:`text-sm font-bold ${l?a.text:"text-stone-600 dark:text-zinc-300"}`,children:[i,"%"]})]})]})]})},t.id)}),!w&&e.jsx("p",{className:"text-center text-xs text-stone-400 dark:text-zinc-500 pt-2",children:"Tap an option to cast your vote — results revealed after voting ✨"})]}),t.length>1&&e.jsxs("div",{className:"px-6 pb-5 flex justify-between",children:[e.jsx("button",{onClick:()=>r(e=>Math.max(0,e-1)),disabled:0===a,className:"text-sm text-stone-400 hover:text-stone-700 dark:hover:text-zinc-200 disabled:opacity-30 transition-colors",children:"← Previous"}),e.jsxs("button",{onClick:()=>r(e=>Math.min(t.length-1,e+1)),disabled:a===t.length-1,className:"text-sm text-stone-400 hover:text-stone-700 dark:hover:text-zinc-200 disabled:opacity-30 transition-colors flex items-center gap-1",children:["Next ",e.jsx(fe,{className:"w-3.5 h-3.5"})]})]})]}),w&&v&&(v.top_universities?.length??0)>0&&e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-[2rem] border border-stone-200 dark:border-zinc-700 shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"p-5 pb-3 border-b border-stone-100 dark:border-zinc-800 flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-yellow-500"}),e.jsx("h3",{className:"font-bold text-stone-900 dark:text-white",children:"University Leaderboard"}),e.jsx("span",{className:"ml-auto text-xs text-stone-400",children:"Most engaged campuses"})]}),e.jsx("div",{className:"divide-y divide-stone-100 dark:divide-zinc-800",children:v.top_universities.map((t,s)=>{const a=v.top_universities[0]?.votes??1,r=Math.round(t.votes/a*100),n=s<3;return e.jsxs("div",{className:"px-5 py-3.5 flex items-center gap-4 "+(n?An[s]+" border-l-4":""),children:[e.jsx("span",{className:"text-xl w-8 text-center flex-shrink-0",children:s<3?Pn[s]:e.jsxs("span",{className:"text-sm font-bold text-stone-400",children:["#",s+1]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-stone-900 dark:text-white text-sm truncate",children:t.university}),e.jsx("div",{className:"mt-1 h-1.5 bg-stone-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700 "+(0===s?"bg-yellow-400":1===s?"bg-stone-400":2===s?"bg-orange-400":"bg-emerald-500"),style:{width:`${r}%`}})})]}),e.jsxs("span",{className:"text-sm font-bold text-stone-700 dark:text-zinc-200 flex-shrink-0",children:[t.votes," ",e.jsx("span",{className:"text-xs font-normal text-stone-400",children:"votes"})]})]},t.university)})}),0===(v.top_universities?.length??0)&&e.jsx("div",{className:"p-6 text-center text-stone-400 text-sm",children:"🏫 University data appears once more students vote!"})]}),w&&!v?.top_universities?.length&&e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-2xl p-4 text-center space-y-1",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-800 dark:text-amber-200",children:"📍 No university leaderboard yet"}),e.jsx("p",{className:"text-xs text-amber-600 dark:text-amber-400",children:"Add your university in Profile → Edit to help your campus rank!"})]})]})}function Ln(){const{updateAvailable:t,isUpdating:s,applyUpdate:a,dismissUpdate:r}=function(){const[e,t]=i.useState(!1),[s,a]=i.useState(!1),[r,n]=i.useState(null);return i.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(e=>{n(e),setInterval(()=>{e.update()},6e4),e.addEventListener("updatefound",()=>{const s=e.installing;s&&s.addEventListener("statechange",()=>{"installed"===s.state&&navigator.serviceWorker.controller&&t(!0)})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))},[]),{updateAvailable:e,isUpdating:s,applyUpdate:async()=>{if(r&&r.waiting){a(!0);try{r.waiting.postMessage({type:"SKIP_WAITING"})}catch(e){a(!1)}}},dismissUpdate:()=>{t(!1)}}}();return t?e.jsx("div",{className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-4 md:w-96 z-[9999] animate-in slide-in-from-bottom-5 duration-300",children:e.jsx("div",{className:"bg-gradient-to-r from-emerald-500 to-emerald-600 rounded-2xl shadow-2xl p-4 text-white",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl",children:e.jsx(I,{className:"w-5 h-5 "+(s?"animate-spin":"")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-sm mb-1",children:"Update Available!"}),e.jsx("p",{className:"text-xs text-white/90 mb-3",children:"A new version of UniLink is ready. Refresh to get the latest features and fixes."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:a,disabled:s,className:"flex-1 bg-white text-emerald-600 font-semibold text-sm py-2 px-4 rounded-xl hover:bg-white/90 transition-colors disabled:opacity-50",children:s?"Updating...":"Update Now"}),e.jsx("button",{onClick:r,disabled:s,className:"p-2 hover:bg-white/10 rounded-xl transition-colors disabled:opacity-50",children:e.jsx(D,{className:"w-5 h-5"})})]})]})]})})}):null}function Mn(){const[t,s]=i.useState(null),[a,r]=i.useState(!0),{setDarkMode:n}=ba();return i.useEffect(()=>{const e=localStorage.getItem("darkMode"),t=null!==e?"true"===e:window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle("dark",t),null===e&&n(t)},[n]),i.useEffect(()=>{ns.auth.getSession().then(({data:{session:e}})=>{s(e),r(!1)});const{data:{subscription:e}}=ns.auth.onAuthStateChange((e,t)=>{if(s(t),t){const e=new URL(window.location.href);let t=!1;if(e.hash&&(e.hash.includes("access_token")||e.hash.includes("refresh_token"))&&(t=!0),(e.searchParams.has("code")||e.searchParams.has("access_token"))&&(t=!0),t){const t=`${e.origin}${e.pathname}`;window.history.replaceState(null,"",t)}}});return()=>e.unsubscribe()},[]),a?e.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-stone-50 dark:bg-zinc-950 text-emerald-600",children:e.jsx(M,{className:"w-8 h-8 animate-spin"})}):e.jsx(Zs,{children:e.jsxs(g,{children:[e.jsx(Ln,{}),e.jsx(oa,{title:"Home",description:"Join the largest network of Nigerian university students. Collaborate, share resources, and grow your career."}),e.jsxs(f,{children:[e.jsx(b,{path:"/",element:t?e.jsx(v,{to:"/app",replace:!0}):e.jsx(la,{})}),e.jsx(b,{path:"/about",element:e.jsx(da,{})}),e.jsx(b,{path:"/onboarding",element:t?e.jsx(gn,{}):e.jsx(v,{to:"/",replace:!0})}),e.jsxs(b,{path:"/app",element:t?e.jsx(Oa,{}):e.jsx(v,{to:"/",replace:!0}),children:[e.jsx(b,{index:!0,element:e.jsx(br,{})}),e.jsx(b,{path:"post/:postId",element:e.jsx(jr,{})}),e.jsx(b,{path:"communities",element:e.jsx(bn,{})}),e.jsx(b,{path:"communities/:slug",element:e.jsx(wn,{})}),e.jsx(b,{path:"network",element:e.jsx(qa,{})}),e.jsx(b,{path:"messages",element:e.jsx(Cr,{})}),e.jsx(b,{path:"jobs",element:e.jsx(Sr,{})}),e.jsx(b,{path:"talent",element:e.jsx(zr,{})}),e.jsx(b,{path:"learn",element:e.jsx(Nn,{})}),e.jsx(b,{path:"leaderboard",element:e.jsx(Cn,{})}),e.jsx(b,{path:"challenge",element:e.jsx(Dn,{})}),e.jsx(b,{path:"notifications",element:e.jsx(Hr,{})}),e.jsx(b,{path:"profile",element:e.jsx(Br,{})}),e.jsx(b,{path:"profile/:userId",element:e.jsx(Wr,{})}),e.jsx(b,{path:"settings",element:e.jsx(Gr,{})}),e.jsx(b,{path:"admin",element:e.jsx(mn,{})}),e.jsx(b,{path:"*",element:e.jsx(un,{})})]}),e.jsx(b,{path:"/legal/:type",element:e.jsx(Yr,{})}),e.jsx(b,{path:"*",element:e.jsx(un,{})})]})]})})}const En=new class{#j;#g;#u;#y;#N;#k;#_;#C;constructor(e={}){this.#j=e.queryCache||new ss,this.#g=e.mutationCache||new es,this.#u=e.defaultOptions||{},this.#y=new Map,this.#N=new Map,this.#k=0}mount(){this.#k++,1===this.#k&&(this.#_=Ot.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#j.onFocus())}),this.#C=$t.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#j.onOnline())}))}unmount(){this.#k--,0===this.#k&&(this.#_?.(),this.#_=void 0,this.#C?.(),this.#C=void 0)}isFetching(e){return this.#j.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#g.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#j.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),s=this.#j.build(this,t),a=s.state.data;return void 0===a?this.fetchQuery(e):(e.revalidateIfStale&&s.isStaleByTime(yt(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return this.#j.findAll(e).map(({queryKey:e,state:t})=>[e,t.data])}setQueryData(e,t,s){const a=this.defaultQueryOptions({queryKey:e}),r=this.#j.get(a.queryHash),n=r?.state.data,i=function(e,t){return"function"==typeof e?e(t):e}(t,n);if(void 0!==i)return this.#j.build(this,a).setData(i,{...s,manual:!0})}setQueriesData(e,t,s){return Ft.batch(()=>this.#j.findAll(e).map(({queryKey:e})=>[e,this.setQueryData(e,t,s)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#j.get(t.queryHash)?.state}removeQueries(e){const t=this.#j;Ft.batch(()=>{t.findAll(e).forEach(e=>{t.remove(e)})})}resetQueries(e,t){const s=this.#j;return Ft.batch(()=>(s.findAll(e).forEach(e=>{e.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const s={revert:!0,...t},a=Ft.batch(()=>this.#j.findAll(e).map(e=>e.cancel(s)));return Promise.all(a).then(jt).catch(jt)}invalidateQueries(e,t={}){return Ft.batch(()=>(this.#j.findAll(e).forEach(e=>{e.invalidate()}),"none"===e?.refetchType?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},a=Ft.batch(()=>this.#j.findAll(e).filter(e=>!e.isDisabled()&&!e.isStatic()).map(e=>{let t=e.fetch(void 0,s);return s.throwOnError||(t=t.catch(jt)),"paused"===e.state.fetchStatus?Promise.resolve():t}));return Promise.all(a).then(jt)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const s=this.#j.build(this,t);return s.isStaleByTime(yt(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(jt).catch(jt)}fetchInfiniteQuery(e){return e.behavior=Qt(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(jt).catch(jt)}ensureInfiniteQueryData(e){return e.behavior=Qt(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return $t.isOnline()?this.#g.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#j}getMutationCache(){return this.#g}getDefaultOptions(){return this.#u}setDefaultOptions(e){this.#u=e}setQueryDefaults(e,t){this.#y.set(Ct(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#y.values()],s={};return t.forEach(t=>{St(e,t.queryKey)&&Object.assign(s,t.defaultOptions)}),s}setMutationDefaults(e,t){this.#N.set(Ct(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#N.values()],s={};return t.forEach(t=>{St(e,t.mutationKey)&&Object.assign(s,t.defaultOptions)}),s}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#u.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=_t(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Tt&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#u.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#j.clear(),this.#g.clear()}};n.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(ua,{children:e.jsx(rs,{client:En,children:e.jsx(Mn,{})})})}));
